Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};(function(){var b=Date,a=b.prototype,d=b.CultureInfo,g=function(j,h){if(!h){h=2}return("000"+j).slice(h*-1)};a.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};a.setTimeToNow=function(){var h=new Date();this.setHours(h.getHours());this.setMinutes(h.getMinutes());this.setSeconds(h.getSeconds());this.setMilliseconds(h.getMilliseconds());return this};b.today=function(){return new Date().clearTime()};b.compare=function(j,h){if(isNaN(j)||isNaN(h)){throw new Error(j+" - "+h)}else{if(j instanceof Date&&h instanceof Date){return(j<h)?-1:(j>h)?1:0}else{throw new TypeError(j+" - "+h)}}};b.equals=function(j,h){return(j.compareTo(h)===0)};b.getDayNumberFromName=function(j){var q=d.dayNames,h=d.abbreviatedDayNames,p=d.shortestDayNames,l=j.toLowerCase();for(var k=0;k<q.length;k++){if(q[k].toLowerCase()==l||h[k].toLowerCase()==l||p[k].toLowerCase()==l){return k}}return -1};b.getMonthNumberFromName=function(j){var o=d.monthNames,h=d.abbreviatedMonthNames,l=j.toLowerCase();for(var k=0;k<o.length;k++){if(o[k].toLowerCase()==l||h[k].toLowerCase()==l){return k}}return -1};b.isLeapYear=function(h){return((h%4===0&&h%100!==0)||h%400===0)};b.getDaysInMonth=function(h,j){return[31,(b.isLeapYear(h)?29:28),31,30,31,30,31,31,30,31,30,31][j]};b.getTimezoneAbbreviation=function(l){var k=d.timezones,j;for(var h=0;h<k.length;h++){if(k[h].offset===l){return k[h].name}}return null};b.getTimezoneOffset=function(h){var l=d.timezones,k;for(var j=0;j<l.length;j++){if(l[j].name===h.toUpperCase()){return l[j].offset}}return null};a.clone=function(){return new Date(this.getTime())};a.compareTo=function(h){return Date.compare(this,h)};a.equals=function(h){return Date.equals(this,h||new Date())};a.between=function(j,h){return this.getTime()>=j.getTime()&&this.getTime()<=h.getTime()};a.isAfter=function(h){return this.compareTo(h||new Date())===1};a.isBefore=function(h){return(this.compareTo(h||new Date())===-1)};a.isToday=function(){return this.isSameDay(new Date())};a.isSameDay=function(h){return this.clone().clearTime().equals(h.clone().clearTime())};a.addMilliseconds=function(h){this.setMilliseconds(this.getMilliseconds()+h);return this};a.addSeconds=function(h){return this.addMilliseconds(h*1000)};a.addMinutes=function(h){return this.addMilliseconds(h*60000)};a.addHours=function(h){return this.addMilliseconds(h*3600000)};a.addDays=function(h){this.setDate(this.getDate()+h);return this};a.addWeeks=function(h){return this.addDays(h*7)};a.addMonths=function(h){var j=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+h);this.setDate(Math.min(j,b.getDaysInMonth(this.getFullYear(),this.getMonth())));return this};a.addYears=function(h){return this.addMonths(h*12)};a.add=function(j){if(typeof j=="number"){this._orient=j;return this}var h=j;if(h.milliseconds){this.addMilliseconds(h.milliseconds)}if(h.seconds){this.addSeconds(h.seconds)}if(h.minutes){this.addMinutes(h.minutes)}if(h.hours){this.addHours(h.hours)}if(h.weeks){this.addWeeks(h.weeks)}if(h.months){this.addMonths(h.months)}if(h.years){this.addYears(h.years)}if(h.days){this.addDays(h.days)}return this};var e,f,c;a.getWeek=function(){var q,p,o,m,l,k,j,h,u,t;e=(!e)?this.getFullYear():e;f=(!f)?this.getMonth()+1:f;c=(!c)?this.getDate():c;if(f<=2){q=e-1;p=(q/4|0)-(q/100|0)+(q/400|0);o=((q-1)/4|0)-((q-1)/100|0)+((q-1)/400|0);u=p-o;l=0;k=c-1+(31*(f-1))}else{q=e;p=(q/4|0)-(q/100|0)+(q/400|0);o=((q-1)/4|0)-((q-1)/100|0)+((q-1)/400|0);u=p-o;l=u+1;k=c+((153*(f-3)+2)/5)+58+u}j=(q+p)%7;m=(k+j-l)%7;h=(k+3-m)|0;if(h<0){t=53-((j-u)/5|0)}else{if(h>364+u){t=1}else{t=(h/7|0)+1}}e=f=c=null;return t};a.getISOWeek=function(){e=this.getUTCFullYear();f=this.getUTCMonth()+1;c=this.getUTCDate();return g(this.getWeek())};a.setWeek=function(h){return this.moveToDayOfWeek(1).addWeeks(h-this.getWeek())};b._validate=function(l,k,h,j){if(typeof l=="undefined"){return false}else{if(typeof l!="number"){throw new TypeError(l+" is not a Number.")}else{if(l<k||l>h){throw new RangeError(l+" is not a valid value for "+j+".")}}}return true};b.validateMillisecond=function(h){return b._validate(h,0,999,"millisecond")};b.validateSecond=function(h){return b._validate(h,0,59,"second")};b.validateMinute=function(h){return b._validate(h,0,59,"minute")};b.validateHour=function(h){return b._validate(h,0,23,"hour")};b.validateDay=function(j,h,k){return b._validate(j,1,b.getDaysInMonth(h,k),"day")};b.validateMonth=function(h){return b._validate(h,0,11,"month")};b.validateYear=function(h){return b._validate(h,0,9999,"year")};a.set=function(h){if(b.validateMillisecond(h.millisecond)){this.addMilliseconds(h.millisecond-this.getMilliseconds())}if(b.validateSecond(h.second)){this.addSeconds(h.second-this.getSeconds())}if(b.validateMinute(h.minute)){this.addMinutes(h.minute-this.getMinutes())}if(b.validateHour(h.hour)){this.addHours(h.hour-this.getHours())}if(b.validateMonth(h.month)){this.addMonths(h.month-this.getMonth())}if(b.validateYear(h.year)){this.addYears(h.year-this.getFullYear())}if(b.validateDay(h.day,this.getFullYear(),this.getMonth())){this.addDays(h.day-this.getDate())}if(h.timezone){this.setTimezone(h.timezone)}if(h.timezoneOffset){this.setTimezoneOffset(h.timezoneOffset)}if(h.week&&b._validate(h.week,0,53,"week")){this.setWeek(h.week)}return this};a.moveToFirstDayOfMonth=function(){return this.set({day:1})};a.moveToLastDayOfMonth=function(){return this.set({day:b.getDaysInMonth(this.getFullYear(),this.getMonth())})};a.moveToNthOccurrence=function(j,k){var h=0;if(k>0){h=k-1}else{if(k===-1){this.moveToLastDayOfMonth();if(this.getDay()!==j){this.moveToDayOfWeek(j,-1)}return this}}return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(j,+1).addWeeks(h)};a.moveToDayOfWeek=function(h,j){var k=(h-this.getDay()+7*(j||+1))%7;return this.addDays((k===0)?k+=7*(j||+1):k)};a.moveToMonth=function(k,h){var j=(k-this.getMonth()+12*(h||+1))%12;return this.addMonths((j===0)?j+=12*(h||+1):j)};a.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1};a.getTimezone=function(){return b.getTimezoneAbbreviation(this.getUTCOffset())};a.setTimezoneOffset=function(k){var h=this.getTimezoneOffset(),j=Number(k)*-6/10;return this.addMinutes(j-h)};a.setTimezone=function(h){return this.setTimezoneOffset(b.getTimezoneOffset(h))};a.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset())};a.isDaylightSavingTime=function(){return(this.hasDaylightSavingTime()&&new Date().getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset())};a.getUTCOffset=function(){var j=this.getTimezoneOffset()*-10/6,h;if(j<0){h=(j-10000).toString();return h.charAt(0)+h.substr(2)}else{h=(j+10000).toString();return"+"+h.substr(1)}};a.getElapsed=function(h){return(h||new Date())-this};if(!a.toISOString){a.toISOString=function(){function h(j){return j<10?"0"+j:j}return'"'+this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+'Z"'}}a._toString=a.toString;a.toString=function(k){var h=this;if(k&&k.length==1){var l=d.formatPatterns;h.t=h.toString;switch(k){case"d":return h.t(l.shortDate);case"D":return h.t(l.longDate);case"F":return h.t(l.fullDateTime);case"m":return h.t(l.monthDay);case"r":return h.t(l.rfc1123);case"s":return h.t(l.sortableDateTime);case"t":return h.t(l.shortTime);case"T":return h.t(l.longTime);case"u":return h.t(l.universalSortableDateTime);case"y":return h.t(l.yearMonth)}}var j=function(m){switch(m*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return k?k.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(n){if(n.charAt(0)==="\\"){return n.replace("\\","")}h.h=h.getHours;switch(n){case"hh":return g(h.h()<13?(h.h()===0?12:h.h()):(h.h()-12));case"h":return h.h()<13?(h.h()===0?12:h.h()):(h.h()-12);case"HH":return g(h.h());case"H":return h.h();case"mm":return g(h.getMinutes());case"m":return h.getMinutes();case"ss":return g(h.getSeconds());case"s":return h.getSeconds();case"yyyy":return g(h.getFullYear(),4);case"yy":return g(h.getFullYear());case"dddd":return d.dayNames[h.getDay()];case"ddd":return d.abbreviatedDayNames[h.getDay()];case"dd":return g(h.getDate());case"d":return h.getDate();case"MMMM":return d.monthNames[h.getMonth()];case"MMM":return d.abbreviatedMonthNames[h.getMonth()];case"MM":return g((h.getMonth()+1));case"M":return h.getMonth()+1;case"t":return h.h()<12?d.amDesignator.substring(0,1):d.pmDesignator.substring(0,1);case"tt":return h.h()<12?d.amDesignator:d.pmDesignator;case"S":return j(h.getDate());default:return n}}):this._toString()}}());(function(){var v=Date,g=v.prototype,w=v.CultureInfo,o=Number.prototype;g._orient=+1;g._nth=null;g._is=false;g._same=false;g._isSecond=false;o._dateElement="day";g.next=function(){this._orient=+1;return this};v.next=function(){return v.today().next()};g.last=g.prev=g.previous=function(){this._orient=-1;return this};v.last=v.prev=v.previous=function(){return v.today().last()};g.is=function(){this._is=true;return this};g.same=function(){this._same=true;this._isSecond=false;return this};g.today=function(){return this.same().day()};g.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun())}return false};g.at=function(j){return(typeof j==="string")?v.parse(this.toString("d")+" "+j):this.set(j)};o.fromNow=o.after=function(j){var k={};k[this._dateElement]=this;return((!j)?new Date():j.clone()).add(k)};o.ago=o.before=function(j){var k={};k[this._dateElement]=this*-1;return((!j)?new Date():j.clone()).add(k)};var e=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),h=("january february march april may june july august september october november december").split(/\s/),n=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),p=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),b=("final first second third fourth fifth").split(/\s/),y;g.toObject=function(){var k={};for(var j=0;j<n.length;j++){k[n[j].toLowerCase()]=this["get"+p[j]]()}return k};v.fromObject=function(j){j.week=null;return Date.today().set(j)};var x=function(j){return function(){if(this._is){this._is=false;return this.getDay()==j}if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1)}this._isSecond=false;var l=this._nth;this._nth=null;var k=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(j,l);if(this>k){throw new RangeError(v.getDayName(j)+" does not occur "+l+" times in the month of "+v.getMonthName(k.getMonth())+" "+k.getFullYear()+".")}return this}return this.moveToDayOfWeek(j,this._orient)}};var f=function(j){return function(){var l=v.today(),k=j-l.getDay();if(j===0&&w.firstDayOfWeek===1&&l.getDay()!==0){k=k+7}return l.addDays(k)}};for(var u=0;u<e.length;u++){v[e[u].toUpperCase()]=v[e[u].toUpperCase().substring(0,3)]=u;v[e[u]]=v[e[u].substring(0,3)]=f(u);g[e[u]]=g[e[u].substring(0,3)]=x(u)}var z=function(j){return function(){if(this._is){this._is=false;return this.getMonth()===j}return this.moveToMonth(j,this._orient)}};var m=function(j){return function(){return v.today().set({month:j,day:1})}};for(var t=0;t<h.length;t++){v[h[t].toUpperCase()]=v[h[t].toUpperCase().substring(0,3)]=t;v[h[t]]=v[h[t].substring(0,3)]=m(t);g[h[t]]=g[h[t].substring(0,3)]=z(t)}var c=function(k){return function(){if(this._isSecond){this._isSecond=false;return this}if(this._same){this._same=this._is=false;var C=this.toObject(),B=(arguments[0]||new Date()).toObject(),A="",l=k.toLowerCase();for(var j=(n.length-1);j>-1;j--){A=n[j].toLowerCase();if(C[A]!=B[A]){return false}if(l==A){break}}return true}if(k.substring(k.length-1)!="s"){k+="s"}return this["add"+k](this._orient)}};var d=function(j){return function(){this._dateElement=j;return this}};for(var s=0;s<n.length;s++){y=n[s].toLowerCase();g[y]=g[y+"s"]=c(n[s]);o[y]=o[y+"s"]=d(y)}g._ss=c("Second");var a=function(j){return function(k){if(this._same){return this._ss(arguments[0])}if(k||k===0){return this.moveToNthOccurrence(k,j)}this._nth=j;if(j===2&&(k===undefined||k===null)){this._isSecond=true;return this.addSeconds(this._orient)}return this}};for(var q=0;q<b.length;q++){g[b[q]]=(q===0)?a(-1):a(q)}}());(function(){Date.Parsing={Exception:function(j){this.message="Parse error at '"+j.substring(0,10)+" ...'"}};var a=Date.Parsing;var c=a.Operators={rtoken:function(j){return function(k){var l=k.match(j);if(l){return([l[0],k.substring(l[0].length)])}else{throw new a.Exception(k)}}},token:function(j){return function(k){return c.rtoken(new RegExp("^s*"+k+"s*"))(k)}},stoken:function(j){return c.rtoken(new RegExp("^"+j))},until:function(j){return function(k){var l=[],n=null;while(k.length){try{n=j.call(this,k)}catch(m){l.push(n[0]);k=n[1];continue}break}return[l,k]}},many:function(j){return function(k){var n=[],l=null;while(k.length){try{l=j.call(this,k)}catch(m){return[n,k]}n.push(l[0]);k=l[1]}return[n,k]}},optional:function(j){return function(k){var l=null;try{l=j.call(this,k)}catch(m){return[null,k]}return[l[0],l[1]]}},not:function(j){return function(k){try{j.call(this,k)}catch(l){return[null,k]}throw new a.Exception(k)}},ignore:function(j){return j?function(k){var l=null;l=j.call(this,k);return[null,l[1]]}:null},product:function(){var k=arguments[0],l=Array.prototype.slice.call(arguments,1),m=[];for(var j=0;j<k.length;j++){m.push(c.each(k[j],l))}return m},cache:function(l){var j={},k=null;return function(m){try{k=j[m]=(j[m]||l.call(this,m))}catch(n){k=j[m]=n}if(k instanceof a.Exception){throw k}else{return k}}},any:function(){var j=arguments;return function(l){var m=null;for(var k=0;k<j.length;k++){if(j[k]==null){continue}try{m=(j[k].call(this,l))}catch(n){m=null}if(m){return m}}throw new a.Exception(l)}},each:function(){var j=arguments;return function(l){var o=[],m=null;for(var k=0;k<j.length;k++){if(j[k]==null){continue}try{m=(j[k].call(this,l))}catch(n){throw new a.Exception(l)}o.push(m[0]);l=m[1]}return[o,l]}},all:function(){var k=arguments,j=j;return j.each(j.optional(k))},sequence:function(j,k,l){k=k||c.rtoken(/^\s*/);l=l||null;if(j.length==1){return j[0]}return function(p){var t=null,u=null;var w=[];for(var o=0;o<j.length;o++){try{t=j[o].call(this,p)}catch(v){break}w.push(t[0]);try{u=k.call(this,t[1])}catch(n){u=null;break}p=u[1]}if(!t){throw new a.Exception(p)}if(u){throw new a.Exception(u[1])}if(l){try{t=l.call(this,t[1])}catch(m){throw new a.Exception(t[1])}}return[w,(t?t[1]:p)]}},between:function(k,l,j){j=j||k;var m=c.each(c.ignore(k),l,c.ignore(j));return function(n){var o=m.call(this,n);return[[o[0][0],r[0][2]],o[1]]}},list:function(j,k,l){k=k||c.rtoken(/^\s*/);l=l||null;return(j instanceof Array?c.each(c.product(j.slice(0,-1),c.ignore(k)),j.slice(-1),c.ignore(l)):c.each(c.many(c.each(j,c.ignore(k))),px,c.ignore(l)))},set:function(j,k,l){k=k||c.rtoken(/^\s*/);l=l||null;return function(C){var m=null,o=null,n=null,t=null,u=[[],C],B=false;for(var w=0;w<j.length;w++){n=null;o=null;m=null;B=(j.length==1);try{m=j[w].call(this,C)}catch(z){continue}t=[[m[0]],m[1]];if(m[1].length>0&&!B){try{n=k.call(this,m[1])}catch(A){B=true}}else{B=true}if(!B&&n[1].length===0){B=true}if(!B){var x=[];for(var v=0;v<j.length;v++){if(w!=v){x.push(j[v])}}o=c.set(x,k).call(this,n[1]);if(o[0].length>0){t[0]=t[0].concat(o[0]);t[1]=o[1]}}if(t[1].length<u[1].length){u=t}if(u[1].length===0){break}}if(u[0].length===0){return u}if(l){try{n=l.call(this,u[1])}catch(y){throw new a.Exception(u[1])}u[1]=n[1]}return u}},forward:function(j,k){return function(l){return j[k].call(this,l)}},replace:function(k,j){return function(l){var m=k.call(this,l);return[j,m[1]]}},process:function(k,j){return function(l){var m=k.call(this,l);return[j.call(this,m[0]),m[1]]}},min:function(j,k){return function(l){var m=k.call(this,l);if(m[0].length<j){throw new a.Exception(l)}return m}}};var h=function(j){return function(){var k=null,n=[];if(arguments.length>1){k=Array.prototype.slice.call(arguments)}else{if(arguments[0] instanceof Array){k=arguments[0]}}if(k){for(var m=0,l=k.shift();m<l.length;m++){k.unshift(l[m]);n.push(j.apply(null,k));k.shift();return n}}else{return j.apply(null,arguments)}}};var g="optional not ignore cache".split(/\s/);for(var d=0;d<g.length;d++){c[g[d]]=h(c[g[d]])}var f=function(j){return function(){if(arguments[0] instanceof Array){return j.apply(null,arguments[0])}else{return j.apply(null,arguments)}}};var e="each any all".split(/\s/);for(var b=0;b<e.length;b++){c[e[b]]=f(c[e[b]])}}());(function(){var e=Date,m=e.prototype,f=e.CultureInfo;var h=function(n){var o=[];for(var g=0;g<n.length;g++){if(n[g] instanceof Array){o=o.concat(h(n[g]))}else{if(n[g]){o.push(n[g])}}}return o};e.Grammar={};e.Translator={hour:function(g){return function(){this.hour=Number(g)}},minute:function(g){return function(){this.minute=Number(g)}},second:function(g){return function(){this.second=Number(g)}},meridian:function(g){return function(){this.meridian=g.slice(0,1).toLowerCase()}},timezone:function(g){return function(){var o=g.replace(/[^\d\+\-]/g,"");if(o.length){this.timezoneOffset=Number(o)}else{this.timezone=g.toLowerCase()}}},day:function(g){var n=g[0];return function(){this.day=Number(n.match(/\d+/)[0])}},month:function(g){return function(){this.month=(g.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(g)/4:Number(g)-1}},year:function(g){return function(){var o=Number(g);this.year=((g.length>2)?o:(o+(((o+2000)<f.twoDigitYearMax)?2000:1900)))}},rday:function(g){return function(){switch(g){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break}}},finishExact:function(g){g=(g instanceof Array)?g:[g];for(var o=0;o<g.length;o++){if(g[o]){g[o].call(this)}}var n=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=n.getDate()}if(!this.year){this.year=n.getFullYear()}if(!this.month&&this.month!==0){this.month=n.getMonth()}if(!this.day){this.day=1}if(!this.hour){this.hour=0}if(!this.minute){this.minute=0}if(!this.second){this.second=0}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.day>e.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.")}var p=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){p.set({timezone:this.timezone})}else{if(this.timezoneOffset){p.set({timezoneOffset:this.timezoneOffset})}}return p},finish:function(g){g=(g instanceof Array)?h(g):[g];if(g.length===0){return null}for(var s=0;s<g.length;s++){if(typeof g[s]=="function"){g[s].call(this)}}var o=e.today();if(this.now&&!this.unit&&!this.operator){return new Date()}else{if(this.now){o=new Date()}}var t=!!(this.days&&this.days!==null||this.orient||this.operator);var u,q,p;p=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){o.setTimeToNow()}if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;t=true}}if(!t&&this.weekday&&!this.day&&!this.days){var n=Date[this.weekday]();this.day=n.getDate();if(!this.month){this.month=n.getMonth()}this.year=n.getFullYear()}if(t&&this.weekday&&this.unit!="month"){this.unit="day";u=(e.getDayNumberFromName(this.weekday)-o.getDay());q=7;this.days=u?((u+(p*q))%q):(p*q)}if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null}if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1}if(this.month&&!this.day&&this.value){o.set({day:this.value*1});if(!t){this.day=this.value*1}}if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;t=true}if(t&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";u=(this.month-o.getMonth());q=12;this.months=u?((u+(p*q))%q):(p*q);this.month=null}if(!this.unit){this.unit="day"}if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*p}else{if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1}this[this.unit+"s"]=this.value*p}}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.weekday&&!this.day&&!this.days){var n=Date[this.weekday]();this.day=n.getDate();if(n.getMonth()!==o.getMonth()){this.month=n.getMonth()}}if((this.month||this.month===0)&&!this.day){this.day=1}if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value)}if(t&&this.timezone&&this.day&&this.days){this.day=this.days}return(t)?o.add(this):o.set(this)}};var j=e.Parsing.Operators,d=e.Grammar,l=e.Translator,b;d.datePartDelimiter=j.rtoken(/^([\s\-\.\,\/\x27]+)/);d.timePartDelimiter=j.stoken(":");d.whiteSpace=j.rtoken(/^\s*/);d.generalDelimiter=j.rtoken(/^(([\s\,]|at|@|on)+)/);var a={};d.ctoken=function(q){var p=a[q];if(!p){var s=f.regexPatterns;var o=q.split(/\s+/),n=[];for(var g=0;g<o.length;g++){n.push(j.replace(j.rtoken(s[o[g]]),o[g]))}p=a[q]=j.any.apply(null,n)}return p};d.ctoken2=function(g){return j.rtoken(f.regexPatterns[g])};d.h=j.cache(j.process(j.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),l.hour));d.hh=j.cache(j.process(j.rtoken(/^(0[0-9]|1[0-2])/),l.hour));d.H=j.cache(j.process(j.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),l.hour));d.HH=j.cache(j.process(j.rtoken(/^([0-1][0-9]|2[0-3])/),l.hour));d.m=j.cache(j.process(j.rtoken(/^([0-5][0-9]|[0-9])/),l.minute));d.mm=j.cache(j.process(j.rtoken(/^[0-5][0-9]/),l.minute));d.s=j.cache(j.process(j.rtoken(/^([0-5][0-9]|[0-9])/),l.second));d.ss=j.cache(j.process(j.rtoken(/^[0-5][0-9]/),l.second));d.hms=j.cache(j.sequence([d.H,d.m,d.s],d.timePartDelimiter));d.t=j.cache(j.process(d.ctoken2("shortMeridian"),l.meridian));d.tt=j.cache(j.process(d.ctoken2("longMeridian"),l.meridian));d.z=j.cache(j.process(j.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),l.timezone));d.zz=j.cache(j.process(j.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),l.timezone));d.zzz=j.cache(j.process(d.ctoken2("timezone"),l.timezone));d.timeSuffix=j.each(j.ignore(d.whiteSpace),j.set([d.tt,d.zzz]));d.time=j.each(j.optional(j.ignore(j.stoken("T"))),d.hms,d.timeSuffix);d.d=j.cache(j.process(j.each(j.rtoken(/^([0-2]\d|3[0-1]|\d)/),j.optional(d.ctoken2("ordinalSuffix"))),l.day));d.dd=j.cache(j.process(j.each(j.rtoken(/^([0-2]\d|3[0-1])/),j.optional(d.ctoken2("ordinalSuffix"))),l.day));d.ddd=d.dddd=j.cache(j.process(d.ctoken("sun mon tue wed thu fri sat"),function(g){return function(){this.weekday=g}}));d.M=j.cache(j.process(j.rtoken(/^(1[0-2]|0\d|\d)/),l.month));d.MM=j.cache(j.process(j.rtoken(/^(1[0-2]|0\d)/),l.month));d.MMM=d.MMMM=j.cache(j.process(d.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),l.month));d.y=j.cache(j.process(j.rtoken(/^(\d\d?)/),l.year));d.yy=j.cache(j.process(j.rtoken(/^(\d\d)/),l.year));d.yyy=j.cache(j.process(j.rtoken(/^(\d\d?\d?\d?)/),l.year));d.yyyy=j.cache(j.process(j.rtoken(/^(\d\d\d\d)/),l.year));b=function(){return j.each(j.any.apply(null,arguments),j.not(d.ctoken2("timeContext")))};d.day=b(d.d,d.dd);d.month=b(d.M,d.MMM);d.year=b(d.yyyy,d.yy);d.orientation=j.process(d.ctoken("past future"),function(g){return function(){this.orient=g}});d.operator=j.process(d.ctoken("add subtract"),function(g){return function(){this.operator=g}});d.rday=j.process(d.ctoken("yesterday tomorrow today now"),l.rday);d.unit=j.process(d.ctoken("second minute hour day week month year"),function(g){return function(){this.unit=g}});d.value=j.process(j.rtoken(/^\d\d?(st|nd|rd|th)?/),function(g){return function(){this.value=g.replace(/\D/g,"")}});d.expression=j.set([d.rday,d.operator,d.value,d.unit,d.orientation,d.ddd,d.MMM]);b=function(){return j.set(arguments,d.datePartDelimiter)};d.mdy=b(d.ddd,d.month,d.day,d.year);d.ymd=b(d.ddd,d.year,d.month,d.day);d.dmy=b(d.ddd,d.day,d.month,d.year);d.date=function(g){return((d[f.dateElementOrder]||d.mdy).call(this,g))};d.format=j.process(j.many(j.any(j.process(j.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(g){if(d[g]){return d[g]}else{throw e.Parsing.Exception(g)}}),j.process(j.rtoken(/^[^dMyhHmstz]+/),function(g){return j.ignore(j.stoken(g))}))),function(g){return j.process(j.each.apply(null,g),l.finishExact)});var k={};var c=function(g){return k[g]=(k[g]||d.format(g)[0])};d.formats=function(n){if(n instanceof Array){var o=[];for(var g=0;g<n.length;g++){o.push(c(n[g]))}return j.any.apply(null,o)}else{return c(n)}};d._formats=d.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]);d._start=j.process(j.set([d.date,d.time,d.expression],d.generalDelimiter,d.whiteSpace),l.finish);d.start=function(g){try{var n=d._formats.call({},g);if(n[1].length===0){return n}}catch(o){}return d._start.call({},g)};e._parse=e.parse;e.parse=function(g){var n=null;if(!g){return null}if(g instanceof Date){return g}try{n=e.Grammar.start.call({},g.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1").replace(/\.\d{3}Z?/,""))}catch(o){return null}return((n[1].length===0)?n[0]:null)};e.getParseFunction=function(n){var g=e.Grammar.formats(n);return function(o){var p=null;try{p=g.call({},o)}catch(q){return null}return((p[1].length===0)?p[0]:null)}};e.parseExact=function(g,n){return e.getParseFunction(n)(g)}}());(function(){var c=Date,b=c.prototype,d=c.CultureInfo,a=[],e=function(g,f){if(!f){f=2}return("000"+g).slice(f*-1)};c.normalizeFormat=function(g){a=[];var f=new Date().$format(g);return a.join("")};c.strftime=function(g,f){return new Date(f*1000).$format(g)};c.strtotime=function(f){var g=c.parse(f);g.addMinutes(g.getTimezoneOffset()*-1);return Math.round(c.UTC(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate(),g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds(),g.getUTCMilliseconds())/1000)};b.$format=function(h){var f=this,j,g=function(k){a.push(k);return f.toString(k)};return h?h.replace(/(%|\\)?.|%%/g,function(k){if(k.charAt(0)==="\\"||k.substring(0,2)==="%%"){return k.replace("\\","").replace("%%","%")}switch(k){case"d":case"%d":return g("dd");case"D":case"%a":return g("ddd");case"j":case"%e":return g("d");case"l":case"%A":return g("dddd");case"N":case"%u":return f.getDay()+1;case"S":return g("S");case"w":case"%w":return f.getDay();case"z":return f.getOrdinalNumber();case"%j":return e(f.getOrdinalNumber(),3);case"%U":var o=f.clone().set({month:0,day:1}).addDays(-1).moveToDayOfWeek(0),n=f.clone().addDays(1).moveToDayOfWeek(0,-1);return(n<o)?"00":e((n.getOrdinalNumber()-o.getOrdinalNumber())/7+1);case"W":case"%V":return f.getISOWeek();case"%W":return e(f.getWeek());case"F":case"%B":return g("MMMM");case"m":case"%m":return g("MM");case"M":case"%b":case"%h":return g("MMM");case"n":return g("M");case"t":return c.getDaysInMonth(f.getFullYear(),f.getMonth());case"L":return(c.isLeapYear(f.getFullYear()))?1:0;case"o":case"%G":return f.setWeek(f.getISOWeek()).toString("yyyy");case"%g":return f.$format("%G").slice(-2);case"Y":case"%Y":return g("yyyy");case"y":case"%y":return g("yy");case"a":case"%p":return g("tt").toLowerCase();case"A":return g("tt").toUpperCase();case"g":case"%I":return g("h");case"G":return g("H");case"h":return g("hh");case"H":case"%H":return g("HH");case"i":case"%M":return g("mm");case"s":case"%S":return g("ss");case"u":return e(f.getMilliseconds(),3);case"I":return(f.isDaylightSavingTime())?1:0;case"O":return f.getUTCOffset();case"P":j=f.getUTCOffset();return j.substring(0,j.length-2)+":"+j.substring(j.length-2);case"e":case"T":case"%z":case"%Z":return f.getTimezone();case"Z":return f.getTimezoneOffset()*-60;case"B":var l=new Date();return Math.floor(((l.getHours()*3600)+(l.getMinutes()*60)+l.getSeconds()+(l.getTimezoneOffset()+60)*60)/86.4);case"c":return f.toISOString().replace(/\"/g,"");case"U":return c.strtotime("now");case"%c":return g("d")+" "+g("t");case"%C":return Math.floor(f.getFullYear()/100+1);case"%D":return g("MM/dd/yy");case"%n":return"\\n";case"%t":return"\\t";case"%r":return g("hh:mm tt");case"%R":return g("H:mm");case"%T":return g("H:mm:ss");case"%x":return g("d");case"%X":return g("t");default:a.push(k);return k}}):this._toString()};if(!b.format){b.format=b.$format}}());(function(d){d.fn.jqm=function(f){var e={overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:o,ajaxText:"",target:o,modal:o,toTop:o,onShow:o,onHide:o,onLoad:o};return this.each(function(){if(this._jqm){return n[this._jqm].c=d.extend({},n[this._jqm].c,f)}p++;this._jqm=p;n[p]={c:d.extend(e,d.jqm.params,f),a:o,w:d(this).addClass("jqmID"+p),s:p};if(e.trigger){d(this).jqmAddTrigger(e.trigger)}})};d.fn.jqmAddClose=function(f){return l(this,f,"jqmHide")};d.fn.jqmAddTrigger=function(f){return l(this,f,"jqmShow")};d.fn.jqmShow=function(e){return this.each(function(){e=e||window.event;d.jqm.open(this._jqm,e)})};d.fn.jqmHide=function(e){return this.each(function(){e=e||window.event;d.jqm.close(this._jqm,e)})};d.jqm={hash:{},open:function(C,B){var q=n[C],v=q.c,m="."+v.closeClass,w=(parseInt(q.w.css("z-index"))),w=(w>0)?w:3000,f=d("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":w-1,opacity:v.overlay/100});if(q.a){return o}q.t=B;q.a=true;q.w.css("z-index",w);if(v.modal){if(!a[0]){k("bind")}a.push(C)}else{if(v.overlay>0){q.w.jqmAddClose(f)}else{f=o}}q.o=(f)?f.addClass(v.overlayClass).prependTo("body"):o;if(c){d("html,body").css({height:"100%",width:"100%"});if(f){f=f.css({position:"absolute"})[0];for(var x in {Top:1,Left:1}){f.style.setExpression(x.toLowerCase(),"(_=(document.documentElement.scroll"+x+" || document.body.scroll"+x+"))+'px'")}}}if(v.ajax){var e=v.target||q.w,A=v.ajax,e=(typeof e=="string")?d(e,q.w):d(e),A=(A.substr(0,1)=="@")?d(B).attr(A.substring(1)):A;e.html(v.ajaxText).load(A,function(){if(v.onLoad){v.onLoad.call(this,q)}if(m){q.w.jqmAddClose(d(m,q.w))}j(q)})}else{if(m){q.w.jqmAddClose(d(m,q.w))}}if(v.toTop&&q.o){q.w.before('<span id="jqmP'+q.w[0]._jqm+'"></span>').insertAfter(q.o)}(v.onShow)?v.onShow(q):q.w.show();j(q);return o},close:function(f){var e=n[f];if(!e.a){return o}e.a=o;if(a[0]){a.pop();if(!a[0]){k("unbind")}}if(e.c.toTop&&e.o){d("#jqmP"+e.w[0]._jqm).after(e.w).remove()}if(e.c.onHide){e.c.onHide(e)}else{e.w.hide();if(e.o){e.o.remove()}}return o},params:{}};var p=0,n=d.jqm.hash,a=[],c=d.browser.msie&&(d.browser.version=="6.0"),o=false,g=d('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0}),j=function(e){if(c){if(e.o){e.o.html('<p style="width:100%;height:100%"/>').prepend(g)}else{if(!d("iframe.jqm",e.w)[0]){e.w.prepend(g)}}}h(e)},h=function(f){try{d(":input:visible",f.w)[0].focus()}catch(e){}},k=function(e){d()[e]("keypress",b)[e]("keydown",b)[e]("mousedown",b)},b=function(q){var f=n[a[a.length-1]],m=(!d(q.target).parents(".jqmID"+f.s)[0]);if(m){h(f)}return !m},l=function(e,f,m){return e.each(function(){var q=this._jqm;d(f).each(function(){if(!this[m]){this[m]=[];d(this).click(function(){for(var t in {jqmShow:1,jqmHide:1}){for(var u in this[t]){if(n[this[t][u]]){n[this[t][u]].w[t](this)}}}return o})}this[m].push(q)})})}})(jQuery);jQuery.bt={version:"0.9.5-rc1"};(function($){var incrId=0;jQuery.fn.bt=function(content,options){var contentSelect=false;if(typeof content!="string"){options=content;if(options.content){content=options.content}else{contentSelect=true;content=false}}if(jQuery.fn.hoverIntent&&jQuery.bt.defaults.trigger=="hover"){jQuery.bt.defaults.trigger="hoverIntent"}return this.each(function(index){var opts=jQuery.extend(false,jQuery.bt.defaults,jQuery.bt.options,options);this._opts=opts;this._internalId="btId"+incrId++;opts.spikeLength=numb(opts.spikeLength);opts.spikeGirth=numb(opts.spikeGirth);opts.overlap=numb(opts.overlap);var ajaxTimeout=false;this.btOn=function(){if(_.isFunction(opts.onShowCallback)&&!opts.onShowCallback()){return}if(typeof $(this).data("bt-box")=="object"){this.btOff()}opts.preBuild.apply(this);$(jQuery.bt.vars.closeWhenOpenStack).btOff();$(this).addClass("bt-active "+opts.activeClass);if(contentSelect&&opts.ajaxPath==null){if(opts.killTitle){$(this).attr("title",$(this).attr("bt-xTitle"))}content=$.isFunction(opts.contentSelector)?opts.contentSelector.apply(this):eval(opts.contentSelector);if(opts.killTitle){$(this).attr("title","")}}if(opts.ajaxPath!=null&&content==false){if(typeof opts.ajaxPath=="object"){var url=eval(opts.ajaxPath[0]);url+=opts.ajaxPath[1]?" "+opts.ajaxPath[1]:""}else{var url=opts.ajaxPath}var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off)}var cacheData=opts.ajaxCache?$(document.body).data("btCache-"+url.replace(/\./g,"")):null;if(typeof cacheData=="string"){content=selector?$("<div/>").append(cacheData.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):cacheData}else{var target=this;var ajaxOpts=jQuery.extend(false,{type:opts.ajaxType,data:opts.ajaxData,cache:opts.ajaxCache,url:url,complete:function(XMLHttpRequest,textStatus){if(textStatus=="success"||textStatus=="notmodified"){if(opts.ajaxCache){$(document.body).data("btCache-"+url.replace(/\./g,""),XMLHttpRequest.responseText)}ajaxTimeout=false;content=selector?$("<div/>").append(XMLHttpRequest.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):XMLHttpRequest.responseText}else{if(textStatus=="timeout"){ajaxTimeout=true}content=opts.ajaxError.replace(/%error/g,XMLHttpRequest.statusText)}if($(target).hasClass("bt-active")){target.btOn()}}},opts.ajaxOpts);jQuery.ajax(ajaxOpts);content=opts.ajaxLoading}}var shadowMarginX=0;var shadowMarginY=0;var shadowShiftX=0;var shadowShiftY=0;if(opts.shadow&&!shadowSupport()){opts.shadow=false;jQuery.extend(opts,opts.noShadowOpts)}if(opts.shadow){if(opts.shadowBlur>Math.abs(opts.shadowOffsetX)){shadowMarginX=opts.shadowBlur*2}else{shadowMarginX=opts.shadowBlur+Math.abs(opts.shadowOffsetX)}shadowShiftX=(opts.shadowBlur-opts.shadowOffsetX)>0?opts.shadowBlur-opts.shadowOffsetX:0;if(opts.shadowBlur>Math.abs(opts.shadowOffsetY)){shadowMarginY=opts.shadowBlur*2}else{shadowMarginY=opts.shadowBlur+Math.abs(opts.shadowOffsetY)}shadowShiftY=(opts.shadowBlur-opts.shadowOffsetY)>0?opts.shadowBlur-opts.shadowOffsetY:0}if(opts.offsetParent){var offsetParent=$(opts.offsetParent);var offsetParentPos=offsetParent.offset();var pos=$(this).offset();var top=numb(pos.top)-numb(offsetParentPos.top)+numb($(this).css("margin-top"))-shadowShiftY;var left=numb(pos.left)-numb(offsetParentPos.left)+numb($(this).css("margin-left"))-shadowShiftX;if(offsetParent[0].tagName.toLowerCase()!="body"){top+=offsetParent.scrollTop();left+=offsetParent.scrollLeft()}}else{var offsetParent=$(this).offsetParent();var pos=$(this).btPosition();var top=numb(pos.top)+numb($(this).css("margin-top"))-shadowShiftY;var left=numb(pos.left)+numb($(this).css("margin-left"))-shadowShiftX}var width=$(this).btOuterWidth();var height=$(this).btOuterHeight();if(typeof content=="object"){var original=content;var clone=$(original).clone(true).show();var origClones=$(original).data("bt-clones")||[];origClones.push(clone);$(original).data("bt-clones",origClones);$(clone).data("bt-orig",original);$(this).data("bt-content-orig",{original:original,clone:clone});content=clone}if(typeof content=="null"||content==""){return}var $text=$('<div class="bt-content"></div>').append(content).css({padding:opts.padding,position:"absolute",width:(opts.shrinkToFit?"auto":opts.width),zIndex:opts.textzIndex,left:shadowShiftX,top:shadowShiftY}).css(opts.cssStyles);var $box=$('<div class="bt-wrapper"></div>').append($text).addClass(opts.cssClass).css({position:"absolute",width:opts.width,zIndex:opts.wrapperzIndex,visibility:"hidden"}).appendTo(offsetParent);if(jQuery.fn.bgiframe){$text.bgiframe();$box.bgiframe()}$(this).data("bt-box",$box);var scrollTop=numb($(document).scrollTop());var scrollLeft=numb($(document).scrollLeft());var docWidth=numb($(window).width());var docHeight=numb($(window).height());var winRight=scrollLeft+docWidth;var winBottom=scrollTop+docHeight;var space=new Object();var thisOffset=$(this).offset();space.top=thisOffset.top-scrollTop;space.bottom=docHeight-((thisOffset.top+height)-scrollTop);space.left=thisOffset.left-scrollLeft;space.right=docWidth-((thisOffset.left+width)-scrollLeft);var textOutHeight=numb($text.outerHeight());var textOutWidth=numb($text.btOuterWidth());if(opts.positions.constructor==String){opts.positions=opts.positions.replace(/ /,"").split(",")}var position,splitPosition,basePosition,subPosition;if(opts.positions[0]=="most"){position="top";for(var pig in space){if(!space.hasOwnProperty(pig)){continue}position=space[pig]>space[position]?pig:position}basePosition=position}else{for(var x in opts.positions){if(!opts.positions.hasOwnProperty(x)){continue}position=opts.positions[x];splitPosition=position.split("-");basePosition=splitPosition[0];subPosition=splitPosition[1];if((basePosition=="left"||basePosition=="right")&&space[basePosition]>textOutWidth+opts.spikeLength){break}else{if((basePosition=="top"||basePosition=="bottom")&&space[basePosition]>textOutHeight+opts.spikeLength){break}}}}var horiz=left+((width-textOutWidth)*0.5);if(subPosition==="left"){horiz=left-textOutWidth/2}else{if(subPosition==="right"){horiz=left+((width-textOutWidth/2))}}var vert=top+((height-textOutHeight)*0.5);var points=new Array();var textTop,textLeft,textRight,textBottom,textTopSpace,textBottomSpace,textLeftSpace,textRightSpace,crossPoint,textCenter,spikePoint;switch(basePosition){case"explicit":var explicitPos=opts.explicitPosition;$text.css("margin-bottom",opts.spikeLength+"px");horiz=left+explicitPos[0]-textOutWidth/2;$box.css({top:(explicitPos[1]+top-$text.outerHeight(true))+opts.overlap,left:horiz});textRightSpace=(winRight-opts.windowMargin)-($text.offset().left+$text.btOuterWidth(true));var xShift=shadowShiftX;if(textRightSpace<0){$box.css("left",(numb($box.css("left"))+textRightSpace)+"px");xShift-=textRightSpace}textLeftSpace=($text.offset().left+numb($text.css("margin-left")))-(scrollLeft+opts.windowMargin);if(textLeftSpace<0){$box.css("left",(numb($box.css("left"))-textLeftSpace)+"px");xShift+=textLeftSpace}textTop=$text.btPosition().top+numb($text.css("margin-top"));textLeft=$text.btPosition().left+numb($text.css("margin-left"));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={y:textBottom+opts.spikeLength,x:((textRight-textLeft)*0.5)+xShift,type:"spike"};crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textBottom);crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x;crossPoint.x=crossPoint.x>(textRight-opts.spikeGirth/2)-opts.cornerRadius?(textRight-opts.spikeGirth/2)-opts.CornerRadius:crossPoint.x;points[points.length]={x:crossPoint.x-(opts.spikeGirth/2),y:textBottom,type:"join"};points[points.length]={x:textLeft,y:textBottom,type:"corner"};points[points.length]={x:textLeft,y:textTop,type:"corner"};points[points.length]={x:textRight,y:textTop,type:"corner"};points[points.length]={x:textRight,y:textBottom,type:"corner"};points[points.length]={x:crossPoint.x+(opts.spikeGirth/2),y:textBottom,type:"join"};points[points.length]=spikePoint;break;case"top":$text.css("margin-bottom",opts.spikeLength+"px");$box.css({top:(top-$text.outerHeight(true))+opts.overlap,left:horiz});textRightSpace=(winRight-opts.windowMargin)-($text.offset().left+$text.btOuterWidth(true));var xShift=shadowShiftX;if(textRightSpace<0){$box.css("left",(numb($box.css("left"))+textRightSpace)+"px");xShift-=textRightSpace}textLeftSpace=($text.offset().left+numb($text.css("margin-left")))-(scrollLeft+opts.windowMargin);if(textLeftSpace<0){$box.css("left",(numb($box.css("left"))-textLeftSpace)+"px");xShift+=textLeftSpace}textTop=$text.btPosition().top+numb($text.css("margin-top"));textLeft=$text.btPosition().left+numb($text.css("margin-left"));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={y:textBottom+opts.spikeLength,x:((textRight-textLeft)*0.5)+xShift,type:"spike"};crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textBottom);crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x;crossPoint.x=crossPoint.x>(textRight-opts.spikeGirth/2)-opts.cornerRadius?(textRight-opts.spikeGirth/2)-opts.CornerRadius:crossPoint.x;points[points.length]={x:crossPoint.x-(opts.spikeGirth/2),y:textBottom,type:"join"};points[points.length]={x:textLeft,y:textBottom,type:"corner"};points[points.length]={x:textLeft,y:textTop,type:"corner"};points[points.length]={x:textRight,y:textTop,type:"corner"};points[points.length]={x:textRight,y:textBottom,type:"corner"};points[points.length]={x:crossPoint.x+(opts.spikeGirth/2),y:textBottom,type:"join"};points[points.length]=spikePoint;break;case"left":$text.css("margin-right",opts.spikeLength+"px");$box.css({top:vert+"px",left:((left-$text.btOuterWidth(true))+opts.overlap)+"px"});textBottomSpace=(winBottom-opts.windowMargin)-($text.offset().top+$text.outerHeight(true));var yShift=shadowShiftY;if(textBottomSpace<0){$box.css("top",(numb($box.css("top"))+textBottomSpace)+"px");yShift-=textBottomSpace}textTopSpace=($text.offset().top+numb($text.css("margin-top")))-(scrollTop+opts.windowMargin);if(textTopSpace<0){$box.css("top",(numb($box.css("top"))-textTopSpace)+"px");yShift+=textTopSpace}textTop=$text.btPosition().top+numb($text.css("margin-top"));textLeft=$text.btPosition().left+numb($text.css("margin-left"));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={x:textRight+opts.spikeLength,y:((textBottom-textTop)*0.5)+yShift,type:"spike"};crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textRight);crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y;crossPoint.y=crossPoint.y>(textBottom-opts.spikeGirth/2)-opts.cornerRadius?(textBottom-opts.spikeGirth/2)-opts.cornerRadius:crossPoint.y;points[points.length]={x:textRight,y:crossPoint.y+opts.spikeGirth/2,type:"join"};points[points.length]={x:textRight,y:textBottom,type:"corner"};points[points.length]={x:textLeft,y:textBottom,type:"corner"};points[points.length]={x:textLeft,y:textTop,type:"corner"};points[points.length]={x:textRight,y:textTop,type:"corner"};points[points.length]={x:textRight,y:crossPoint.y-opts.spikeGirth/2,type:"join"};points[points.length]=spikePoint;break;case"bottom":$text.css("margin-top",opts.spikeLength+"px");$box.css({top:(top+height)-opts.overlap,left:horiz});textRightSpace=(winRight-opts.windowMargin)-($text.offset().left+$text.btOuterWidth(true));var xShift=shadowShiftX;if(textRightSpace<0){$box.css("left",(numb($box.css("left"))+textRightSpace)+"px");xShift-=textRightSpace}textLeftSpace=($text.offset().left+numb($text.css("margin-left")))-(scrollLeft+opts.windowMargin);if(textLeftSpace<0){$box.css("left",(numb($box.css("left"))-textLeftSpace)+"px");xShift+=textLeftSpace}textTop=$text.btPosition().top+numb($text.css("margin-top"));textLeft=$text.btPosition().left+numb($text.css("margin-left"));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={x:((textRight-textLeft)*0.5)+xShift,y:shadowShiftY,type:"spike"};crossPoint=findIntersectX(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textTop);crossPoint.x=crossPoint.x<textLeft+opts.spikeGirth/2+opts.cornerRadius?textLeft+opts.spikeGirth/2+opts.cornerRadius:crossPoint.x;crossPoint.x=crossPoint.x>(textRight-opts.spikeGirth/2)-opts.cornerRadius?(textRight-opts.spikeGirth/2)-opts.cornerRadius:crossPoint.x;points[points.length]={x:crossPoint.x+opts.spikeGirth/2,y:textTop,type:"join"};points[points.length]={x:textRight,y:textTop,type:"corner"};points[points.length]={x:textRight,y:textBottom,type:"corner"};points[points.length]={x:textLeft,y:textBottom,type:"corner"};points[points.length]={x:textLeft,y:textTop,type:"corner"};points[points.length]={x:crossPoint.x-(opts.spikeGirth/2),y:textTop,type:"join"};points[points.length]=spikePoint;break;case"right":$text.css("margin-left",(opts.spikeLength+"px"));$box.css({top:vert+"px",left:((left+width)-opts.overlap)+"px"});textBottomSpace=(winBottom-opts.windowMargin)-($text.offset().top+$text.outerHeight(true));var yShift=shadowShiftY;if(textBottomSpace<0){$box.css("top",(numb($box.css("top"))+textBottomSpace)+"px");yShift-=textBottomSpace}textTopSpace=($text.offset().top+numb($text.css("margin-top")))-(scrollTop+opts.windowMargin);if(textTopSpace<0){$box.css("top",(numb($box.css("top"))-textTopSpace)+"px");yShift+=textTopSpace}textTop=$text.btPosition().top+numb($text.css("margin-top"));textLeft=$text.btPosition().left+numb($text.css("margin-left"));textRight=textLeft+$text.btOuterWidth();textBottom=textTop+$text.outerHeight();textCenter={x:textLeft+($text.btOuterWidth()*opts.centerPointX),y:textTop+($text.outerHeight()*opts.centerPointY)};points[points.length]=spikePoint={x:shadowShiftX,y:((textBottom-textTop)*0.5)+yShift,type:"spike"};crossPoint=findIntersectY(spikePoint.x,spikePoint.y,textCenter.x,textCenter.y,textLeft);crossPoint.y=crossPoint.y<textTop+opts.spikeGirth/2+opts.cornerRadius?textTop+opts.spikeGirth/2+opts.cornerRadius:crossPoint.y;crossPoint.y=crossPoint.y>(textBottom-opts.spikeGirth/2)-opts.cornerRadius?(textBottom-opts.spikeGirth/2)-opts.cornerRadius:crossPoint.y;points[points.length]={x:textLeft,y:crossPoint.y-opts.spikeGirth/2,type:"join"};points[points.length]={x:textLeft,y:textTop,type:"corner"};points[points.length]={x:textRight,y:textTop,type:"corner"};points[points.length]={x:textRight,y:textBottom,type:"corner"};points[points.length]={x:textLeft,y:textBottom,type:"corner"};points[points.length]={x:textLeft,y:crossPoint.y+opts.spikeGirth/2,type:"join"};points[points.length]=spikePoint;break}var canvas=document.createElement("canvas");$(canvas).attr("width",(numb($text.btOuterWidth(true))+opts.strokeWidth*2+shadowMarginX)).attr("height",(numb($text.outerHeight(true))+opts.strokeWidth*2+shadowMarginY)).appendTo($box).css({position:"absolute",zIndex:opts.boxzIndex});if(typeof G_vmlCanvasManager!="undefined"){canvas=G_vmlCanvasManager.initElement(canvas)}if(opts.cornerRadius>0){var newPoints=new Array();var newPoint;for(var i=0;i<points.length;i++){if(points[i].type=="corner"){newPoint=betweenPoint(points[i],points[(i-1)%points.length],opts.cornerRadius);newPoint.type="arcStart";newPoints[newPoints.length]=newPoint;newPoints[newPoints.length]=points[i];newPoint=betweenPoint(points[i],points[(i+1)%points.length],opts.cornerRadius);newPoint.type="arcEnd";newPoints[newPoints.length]=newPoint}else{newPoints[newPoints.length]=points[i]}}points=newPoints}var ctx=canvas.getContext("2d");if(opts.shadow&&opts.shadowOverlap!==true){var shadowOverlap=numb(opts.shadowOverlap);switch(position){case"top":if(opts.shadowOffsetX+opts.shadowBlur-shadowOverlap>0){$box.css("top",(numb($box.css("top"))-(opts.shadowOffsetX+opts.shadowBlur-shadowOverlap)))}break;case"right":if(shadowShiftX-shadowOverlap>0){$box.css("left",(numb($box.css("left"))+shadowShiftX-shadowOverlap))}break;case"bottom":if(shadowShiftY-shadowOverlap>0){$box.css("top",(numb($box.css("top"))+shadowShiftY-shadowOverlap))}break;case"left":if(opts.shadowOffsetY+opts.shadowBlur-shadowOverlap>0){$box.css("left",(numb($box.css("left"))-(opts.shadowOffsetY+opts.shadowBlur-shadowOverlap)))}break}}drawIt.call(ctx,points,opts.strokeWidth);ctx.fillStyle=opts.fill;if(opts.shadow){ctx.shadowOffsetX=opts.shadowOffsetX;ctx.shadowOffsetY=opts.shadowOffsetY;ctx.shadowBlur=opts.shadowBlur;ctx.shadowColor=opts.shadowColor}ctx.closePath();ctx.fill();if(opts.strokeWidth>0){ctx.shadowColor="rgba(0, 0, 0, 0)";ctx.lineWidth=opts.strokeWidth;ctx.strokeStyle=opts.strokeStyle;ctx.beginPath();drawIt.call(ctx,points,opts.strokeWidth);ctx.closePath();ctx.stroke()}opts.preShow.apply(this,[$box[0]]);$box.css({display:"none",visibility:"visible"});opts.showTip.apply(this,[$box[0]]);if(opts.overlay){var overlay=$('<div class="bt-overlay"></div>').css({position:"absolute",backgroundColor:"blue",top:top,left:left,width:width,height:height,opacity:".2"}).appendTo(offsetParent);$(this).data("overlay",overlay)}if((opts.ajaxPath!=null&&opts.ajaxCache==false)||ajaxTimeout){content=false}if(opts.clickAnywhereToClose){jQuery.bt.vars.clickAnywhereStack.push(this);$(document).mousedown(jQuery.bt.docClick)}if(opts.closeWhenOthersOpen){jQuery.bt.vars.closeWhenOpenStack.push(this)}if(_.isFunction(opts.postShow)){opts.postShow.apply(this,[$box[0]])}};this.btOff=function(){var box=$(this).data("bt-box");opts.preHide.apply(this,[box]);var i=this;i.btCleanup=function(){var box=$(i).data("bt-box");var contentOrig=$(i).data("bt-content-orig");var overlay=$(i).data("bt-overlay");if(!$.isBlank(box)&&typeof box=="object"){$(box).remove();$(i).removeData("bt-box")}if(!$.isBlank(contentOrig)&&typeof contentOrig=="object"){var clones=$(contentOrig.original).data("bt-clones");$(contentOrig).data("bt-clones",arrayRemove(clones,contentOrig.clone))}if(!$.isBlank(overlay)&&typeof overlay=="object"){$(overlay).remove();$(i).removeData("bt-overlay")}jQuery.bt.vars.clickAnywhereStack=arrayRemove(jQuery.bt.vars.clickAnywhereStack,i);jQuery.bt.vars.closeWhenOpenStack=arrayRemove(jQuery.bt.vars.closeWhenOpenStack,i);$(i).removeClass("bt-active "+opts.activeClass);opts.postHide.apply(i)};opts.hideTip.apply(this,[box,i.btCleanup])};var refresh=this.btRefresh=function(){this.btOff();this.btOn()};this.btDestroy=function(){$(this).unbind("."+this._internalId)};if(opts.killTitle){$(this).find("[title]").andSelf().each(function(){if(!$(this).attr("bt-xTitle")){$(this).attr("bt-xTitle",$(this).attr("title"));$(this).attr("title","")}})}if(typeof opts.trigger=="string"){opts.trigger=[opts.trigger]}if(opts.trigger[0]=="hoverIntent"){var hoverOpts=jQuery.extend(opts.hoverIntentOpts,{over:function(){this.btOn()},out:function(){this.btOff()}});$(this).hoverIntent(hoverOpts)}else{if(opts.trigger[0]=="hover"){var isHover=false;$(this).bind("mouseenter."+this._internalId,function(){if(!isHover){isHover=true;this.btOn()}}).bind("mouseleave."+this._internalId,function(){isHover=false;this.btOff()})}else{if(opts.trigger[0]=="now"){if($(this).hasClass("bt-active")){this.btOff()}else{this.btOn()}}else{if(opts.trigger[0]=="none"){}else{if(opts.trigger.length>1&&opts.trigger[0]!=opts.trigger[1]){$(this).bind(opts.trigger[0]+"."+this._internalId,function(){this.btOn()}).bind(opts.trigger[1]+"."+this._internalId,function(){this.btOff()})}else{$(this).bind(opts.trigger[0]+"."+this._internalId,function(){if($(this).hasClass("bt-active")){this.btOff()}else{this.btOn()}})}}}}}});function drawIt(points,strokeWidth){this.moveTo(points[0].x,points[0].y);for(i=1;i<points.length;i++){if(points[i-1].type=="arcStart"){this.quadraticCurveTo(round5(points[i].x,strokeWidth),round5(points[i].y,strokeWidth),round5(points[(i+1)%points.length].x,strokeWidth),round5(points[(i+1)%points.length].y,strokeWidth));i++}else{this.lineTo(round5(points[i].x,strokeWidth),round5(points[i].y,strokeWidth))}}}function round5(num,strokeWidth){var ret;strokeWidth=numb(strokeWidth);if(strokeWidth%2){ret=num}else{ret=Math.round(num-0.5)+0.5}return ret}function numb(num){return parseInt(num)||0}function arrayRemove(arr,elem){var x,newArr=new Array();for(x in arr){if(arr[x]!=elem){newArr.push(arr[x])}}return newArr}function canvasSupport(){var canvas_compatible=false;try{canvas_compatible=!!(document.createElement("canvas").getContext("2d"))}catch(e){canvas_compatible=!!(document.createElement("canvas").getContext)}return canvas_compatible}function shadowSupport(){try{var userAgent=navigator.userAgent.toLowerCase();if(/webkit/.test(userAgent)){return true}else{if(/gecko|mozilla/.test(userAgent)&&parseFloat(userAgent.match(/firefox\/(\d+(?:\.\d+)+)/)[1])>=3.1){return true}}}catch(err){}return false}function betweenPoint(point1,point2,dist){var y,x;if(point1.x==point2.x){y=point1.y<point2.y?point1.y+dist:point1.y-dist;return{x:point1.x,y:y}}else{if(point1.y==point2.y){x=point1.x<point2.x?point1.x+dist:point1.x-dist;return{x:x,y:point1.y}}}}function centerPoint(arcStart,corner,arcEnd){var x=corner.x==arcStart.x?arcEnd.x:arcStart.x;var y=corner.y==arcStart.y?arcEnd.y:arcStart.y;var startAngle,endAngle;if(arcStart.x<arcEnd.x){if(arcStart.y>arcEnd.y){startAngle=(Math.PI/180)*180;endAngle=(Math.PI/180)*90}else{startAngle=(Math.PI/180)*90;endAngle=0}}else{if(arcStart.y>arcEnd.y){startAngle=(Math.PI/180)*270;endAngle=(Math.PI/180)*180}else{startAngle=0;endAngle=(Math.PI/180)*270}}return{x:x,y:y,type:"center",startAngle:startAngle,endAngle:endAngle}}function findIntersect(r1x1,r1y1,r1x2,r1y2,r2x1,r2y1,r2x2,r2y2){if(r2x1==r2x2){return findIntersectY(r1x1,r1y1,r1x2,r1y2,r2x1)}if(r2y1==r2y2){return findIntersectX(r1x1,r1y1,r1x2,r1y2,r2y1)}var r1m=(r1y1-r1y2)/(r1x1-r1x2);var r1b=r1y1-(r1m*r1x1);var r2m=(r2y1-r2y2)/(r2x1-r2x2);var r2b=r2y1-(r2m*r2x1);var x=(r2b-r1b)/(r1m-r2m);var y=r1m*x+r1b;return{x:x,y:y}}function findIntersectY(r1x1,r1y1,r1x2,r1y2,x){if(r1y1==r1y2){return{x:x,y:r1y1}}var r1m=(r1y1-r1y2)/(r1x1-r1x2);var r1b=r1y1-(r1m*r1x1);var y=r1m*x+r1b;return{x:x,y:y}}function findIntersectX(r1x1,r1y1,r1x2,r1y2,y){if(r1x1==r1x2){return{x:r1x1,y:y}}var r1m=(r1y1-r1y2)/(r1x1-r1x2);var r1b=r1y1-(r1m*r1x1);var x=(y-r1b)/r1m;return{x:x,y:y}}};jQuery.fn.btPosition=function(){function num(elem,prop){return elem[0]&&parseInt(jQuery.curCSS(elem[0],prop,true),10)||0}var left=0,top=0,results;if(this[0]){var offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=/^body|html$/i.test(offsetParent[0].tagName)?{top:0,left:0}:offsetParent.offset();offset.top-=num(this,"marginTop");offset.left-=num(this,"marginLeft");parentOffset.top+=num(offsetParent,"borderTopWidth");parentOffset.left+=num(offsetParent,"borderLeftWidth");results={top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}}return results};jQuery.fn.btOuterWidth=function(margin){function num(elem,prop){return elem[0]&&parseInt(jQuery.curCSS(elem[0],prop,true),10)||0}if(window.SVGElement&&this[0] instanceof SVGElement){return this[0].getBoundingClientRect().width}else{return this["innerWidth"]()+num(this,"borderLeftWidth")+num(this,"borderRightWidth")+(margin?num(this,"marginLeft")+num(this,"marginRight"):0)}};jQuery.fn.btOuterHeight=function(){if(window.SVGElement&&this[0] instanceof SVGElement){return this[0].getBoundingClientRect().height}else{return this.outerHeight()}};jQuery.fn.btOn=function(){return this.each(function(index){if(jQuery.isFunction(this.btOn)){this.btOn()}})};jQuery.fn.btOff=function(){return this.each(function(index){if(jQuery.isFunction(this.btOff)){this.btOff()}})};jQuery.fn.btDestroy=function(){return this.each(function(index){if(jQuery.isFunction(this.btDestroy)){this.btDestroy()}})};jQuery.bt.vars={clickAnywhereStack:[],closeWhenOpenStack:[]};jQuery.bt.docClick=function(e){if(!e){var e=window.event}if(!$(e.target).parents().andSelf().filter(".bt-wrapper, .bt-active").length&&jQuery.bt.vars.clickAnywhereStack.length){$(jQuery.bt.vars.clickAnywhereStack).btOff();$(document).unbind("click",jQuery.bt.docClick)}};jQuery.bt.defaults={trigger:"hover",clickAnywhereToClose:true,closeWhenOthersOpen:false,shrinkToFit:false,width:"200px",padding:"10px",spikeGirth:10,spikeLength:15,overlap:0,overlay:false,killTitle:true,textzIndex:9999,boxzIndex:9998,wrapperzIndex:9997,offsetParent:null,positions:["most"],fill:"rgb(255, 255, 102)",windowMargin:10,strokeWidth:1,strokeStyle:"#000",cornerRadius:5,centerPointX:0.5,centerPointY:0.5,shadow:false,shadowOffsetX:2,shadowOffsetY:2,shadowBlur:3,shadowColor:"#000",shadowOverlap:false,noShadowOpts:{strokeStyle:"#999"},cssClass:"",cssStyles:{},activeClass:"bt-active",content:null,contentSelector:"$(this).attr('title')",ajaxPath:null,ajaxError:"<strong>ERROR:</strong> <em>%error</em>",ajaxLoading:"<blink>Loading...</blink>",ajaxData:{},ajaxType:"GET",ajaxCache:true,ajaxOpts:{},preBuild:function(){},preShow:function(box){},showTip:function(box){$(box).show()},postShow:function(box){},preHide:function(box){},hideTip:function(box,callback){$(box).hide();callback()},postHide:function(){},hoverIntentOpts:{interval:300,timeout:500}};jQuery.bt.options={}})(jQuery);var jaaulde=window.jaaulde||{};jaaulde.utils=jaaulde.utils||{};jaaulde.utils.cookies=(function(){var d=[];var b={hoursToLive:null,path:"/",domain:null,secure:false};var g=function(h){var j;if(typeof h!=="object"||h===null){j=b}else{j={hoursToLive:(typeof h.hoursToLive==="number"&&h.hoursToLive!==0?h.hoursToLive:b.hoursToLive),path:(typeof h.path==="string"&&h.path!==""?h.path:b.path),domain:(typeof h.domain==="string"&&h.domain!==""?h.domain:b.domain),secure:(typeof h.secure==="boolean"&&h.secure?h.secure:b.secure)}}return j};var a=function(h){var j=new Date();j.setTime(j.getTime()+(h*60*60*1000));return j.toGMTString()};var f=function(h){h=g(h);return((typeof h.hoursToLive==="number"?"; expires="+a(h.hoursToLive):"")+"; path="+h.path+(typeof h.domain==="string"?"; domain="+h.domain:"")+(h.secure===true?"; secure":""))};var e=function(){d={};var m,j,l,h=document.cookie.split(";");for(var k=0;k<h.length;k=k+1){m=h[k].split("=");j=m[0].replace(/^\s*/,"").replace(/\s*$/,"");l=decodeURIComponent(m[1]);d[j]=l}return d};var c=function(){};c.prototype.get=function(k){var h;e();if(typeof k==="string"){h=(typeof d[k]!=="undefined")?d[k]:null}else{if(typeof k==="object"&&k!==null){h={};for(var j in k){if(typeof d[k[j]]!=="undefined"){h[k[j]]=d[k[j]]}else{h[k[j]]=null}}}else{h=d}}return h};c.prototype.filter=function(h){var j={};e();if(typeof h==="string"){h=new RegExp(h)}for(var k in d){if(k.match(h)){j[k]=d[k]}}return j};c.prototype.set=function(l,j,h){if(typeof j==="undefined"||j===null){if(typeof h!=="object"||h===null){h={}}j="";h.hoursToLive=-8760}var k=f(h);document.cookie=l+"="+encodeURIComponent(j)+k};c.prototype.del=function(l,k){var h={};if(typeof k!=="object"||k===null){k={}}if(typeof l==="boolean"&&l===true){h=this.get()}else{if(typeof l==="string"){h[l]=true}}for(var j in h){if(typeof j==="string"&&j!==""){this.set(j,null,k)}}};c.prototype.test=function(){var j=false,h="cT",k="data";this.set(h,k);if(this.get(h)===k){this.del(h);j=true}return j};c.prototype.setOptions=function(h){if(typeof h!=="object"){h=null}b=g(h)};return new c()})();(function(){if(window.jQuery){(function(b){b.cookies=jaaulde.utils.cookies;var a={cookify:function(c){return this.each(function(){var g,e=false,d=false,f="",k="",j=["name","id"],l,h;for(g in j){if(!isNaN(g)){f=b(this).attr(j[g]);if(typeof f==="string"&&f!==""){e=true;break}}}if(e){l=this.nodeName.toLowerCase();if(l!=="input"&&l!=="textarea"&&l!=="select"&&l!=="img"){k=b(this).html();d=true}else{h=b(this).attr("type");if(typeof h==="string"&&h!==""){h=h.toLowerCase()}if(h!=="radio"&&h!=="checkbox"){k=b(this).val();d=true}}if(d){if(typeof k!=="string"||k===""){k=null}b.cookies.set(f,k,c)}}})},cookieFill:function(){return this.each(function(){var e,c=false,d="",h,g=["name","id"],f=0,j;for(e in g){if(!isNaN(e)){d=b(this).attr(g[e]);if(typeof d==="string"&&d!==""){c=true;break}}}if(c){h=b.cookies.get(d);if(h!==null){j=this.nodeName.toLowerCase();if(j==="input"||j==="textarea"||j==="select"){b(this).val(h)}else{b(this).html(h)}}}f=0})},cookieBind:function(c){return this.each(function(){b(this).cookieFill().change(function(){b(this).cookify(c)})})}};b.each(a,function(c){b.fn[c]=this})})(window.jQuery)}})();(function(a){a.fn.example=function(e,c){var d=a.isFunction(e);var b=a.extend({},c,{example:e});return this.each(function(){var h=a(this);if(a.metadata){var j=a.extend({},a.fn.example.defaults,h.metadata(),b)}else{var j=a.extend({},a.fn.example.defaults,b)}if(!a.fn.example.boundClassNames[j.className]){a(window).unload(function(){a("."+j.className).val("")});a("form").submit(function(){a(this).find("."+j.className).val("")});a.fn.example.boundClassNames[j.className]=true}if(!h.attr("value")&&(d||h.val()==j.example)){h.val("")}var f=null;try{f=document.activeElement}catch(g){}if(h.val()==""&&this!=f){h.addClass(j.className);h.val(d?j.example.call(this):j.example)}h.focus(function(){if(a(this).is("."+j.className)){a(this).val("");a(this).removeClass(j.className)}});h.change(function(){if(a(this).is("."+j.className)){a(this).removeClass(j.className)}});h.blur(function(){if(a(this).val()==""||a(this).is("."+j.className)){a(this).addClass(j.className);a(this).val(d?j.example.call(this):j.example)}})})};a.fn.example.defaults={className:"example"};a.fn.example.boundClassNames=[]})(jQuery);if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(b){var a=function(c){return parseInt(c,10)||0};b.each(["min","max"],function(c,d){b.fn[d+"Size"]=function(e){var f,g;if(e){if(e.width){this.css(d+"-width",e.width)}if(e.height){this.css(d+"-height",e.height)}return this}else{f=this.css(d+"-width");g=this.css(d+"-height");return{width:(d==="max"&&(f===undefined||f==="none"||a(f)===-1)&&Number.MAX_VALUE)||a(f),height:(d==="max"&&(g===undefined||g==="none"||a(g)===-1)&&Number.MAX_VALUE)||a(g)}}}});b.fn.isVisible=function(){return this.css("visibility")!=="hidden"&&this.css("display")!=="none"};b.each(["border","margin","padding"],function(c,d){b.fn[d]=function(e){if(e){if(e.top){this.css(d+"-top"+(d==="border"?"-width":""),e.top)}if(e.bottom){this.css(d+"-bottom"+(d==="border"?"-width":""),e.bottom)}if(e.left){this.css(d+"-left"+(d==="border"?"-width":""),e.left)}if(e.right){this.css(d+"-right"+(d==="border"?"-width":""),e.right)}return this}else{return{top:a(this.css(d+"-top"+(d==="border"?"-width":""))),bottom:a(this.css(d+"-bottom"+(d==="border"?"-width":""))),left:a(this.css(d+"-left"+(d==="border"?"-width":""))),right:a(this.css(d+"-right"+(d==="border"?"-width":"")))}}}})})(jQuery);(function(d){d.Tache={Data:[],InProcessData:[],Delete:function(g){c(g)},DeleteAll:function(){e()},Get:function(g){f(g)},SetTimeout:function(g){a(g)},Timeout:600};function b(h){var g=h.url;g+=((typeof h.data=="string")?h.data:h.data?d.param(h.data).split("&").sort().join("&"):"");g+=((typeof h.dataType=="string")?h.dataType:"");g+=((typeof h.type=="string")?h.type:"");return g}function c(j){if(typeof j.url!="string"){alert("No AJAX URL passed");return}var h=b(j);var k=new Date();for(var g=d.Tache.Data.length;g>0;g--){if((((k.valueOf()-d.Tache.Data[g-1].dtAge.valueOf())/1000)>d.Tache.Timeout)||(d.Tache.Data[g-1].sIdentifier==h)){d.Tache.Data.splice(g-1,1)}}for(var g=d.Tache.InProcessData.length;g>0;g--){if((((k.valueOf()-d.Tache.InProcessData[g-1].dtAge.valueOf())/1000)>d.Tache.Timeout)||(d.Tache.InProcessData[g-1].sIdentifier==h)){d.Tache.InProcessData.splice(g-1,1)}}}function e(){d.Tache.Data=[];d.Tache.InProcessData=[]}function f(m){if(typeof m.url!="string"){alert("No AJAX URL passed");return}var l=b(m);var n=new Date();for(var j=d.Tache.Data.length;j>0;j--){if(((n.valueOf()-d.Tache.Data[j-1].dtAge.valueOf())/1000)>d.Tache.Timeout){d.Tache.Data.splice(j-1,1)}else{if(d.Tache.Data[j-1].sIdentifier==l){var k=d.Tache.Data[j-1];if(k.hasOwnProperty("oData")){m.success(k.oData)}else{if(k.hasOwnProperty("oErrorReq")){m.error(k.oErrorReq)}}return}}}for(var j=d.Tache.InProcessData.length;j>0;j--){if(((n.valueOf()-d.Tache.InProcessData[j-1].dtAge.valueOf())/1000)>d.Tache.Timeout){d.Tache.InProcessData.splice(j-1,1)}else{if(d.Tache.InProcessData[j-1].sIdentifier==l){d.Tache.InProcessData[j-1].oReqs.push(m);return}}}var h=m.success;d.Tache.InProcessData.push({sIdentifier:l,dtAge:new Date(),oReqs:[m]});m.success=function(s,t,u){if(u.status==200){d.Tache.Data.push({sIdentifier:l,oData:s,dtAge:new Date()})}m.success=h;for(var q=0;q<d.Tache.InProcessData.length;q++){if(d.Tache.InProcessData[q].sIdentifier==l){var o=d.Tache.InProcessData.splice(q,1)[0];for(var p=0;p<o.oReqs.length;p++){o.oReqs[p].success.apply(this,arguments)}}}};var g=m.error;m.error=function(s){if(s.status<500){d.Tache.Data.push({sIdentifier:l,oErrorReq:s,dtAge:new Date()})}m.error=g;for(var q=0;q<d.Tache.InProcessData.length;q++){if(d.Tache.InProcessData[q].sIdentifier==l){var o=d.Tache.InProcessData.splice(q,1)[0];for(var p=0;p<o.oReqs.length;p++){if(o.oReqs[p].error instanceof Function){o.oReqs[p].error.apply(this,arguments)}}}}};d.ajax(m)}function a(g){d.Tache.Timeout=g}})(jQuery);(function(a){a.uniform={options:{selectClass:"selector",radioClass:"radio",checkboxClass:"checker",fileClass:"uploader",filenameClass:"filename",fileBtnClass:"action",globalClass:"uniform",fileDefaultText:"No file selected",fileBtnText:"Choose File",checkedClass:"checked",focusClass:"focus",disabledClass:"disabled",activeClass:"active",hoverClass:"hover",useID:true,idPrefix:"uniform",resetSelector:false},elements:[]};if(a.browser.msie&&a.browser.version<7){a.selectOpacity=false}else{a.selectOpacity=true}a.fn.uniform=function(c){c=a.extend(a.uniform.options,c);var f=this;if(c.resetSelector!=false){a(c.resetSelector).mouseup(function(){function k(){a.uniform.update(f)}setTimeout(k,10)})}function b(m){var n='<div><div class="container"><div><span></span></div></div></div>';m.css("opacity",0);m.after(n);n=m.next();n.append(m);var k=n.find("span");n.addClass(c.selectClass).addClass(c.globalClass);if(c.useID){n.attr("id",c.idPrefix+"-"+m.attr("id"))}var l=m.find(":selected:first");if(l.length===0){l=m.find("option:first")}k.text(l.text());m.change(function(){k.text(m.find(":selected").text())}).focus(function(){n.addClass(c.focusClass)}).blur(function(){n.removeClass(c.focusClass)}).bind("mousedown.uniform touchbegin.uniform",function(){n.addClass(c.activeClass)}).bind("mouseup.uniform touchend.uniform",function(){n.removeClass(c.activeClass)}).bind("click.uniform",function(){n.removeClass(c.activeClass)}).hover(function(){n.addClass(c.hoverClass)},function(){n.removeClass(c.hoverClass)}).keypress(function(){k.text(m.find(":selected").text())});if(a(m).attr("disabled")){n.addClass(c.disabledClass)}j(m)}function d(l){var m="<div><span></span></div>";l.after(m);m=l.next();var k=m.children();k.append(l);if(c.useID){m.attr("id",c.idPrefix+"-"+l.attr("id"))}m.addClass(c.checkboxClass).addClass(c.globalClass);a(l).css("opacity",0).focus(function(){m.addClass(c.focusClass)}).blur(function(){m.removeClass(c.focusClass)}).click(function(){if(!a(l).attr("checked")){k.removeClass(c.checkedClass)}else{k.addClass(c.checkedClass)}}).mousedown(function(){m.addClass(c.activeClass)}).mouseup(function(){m.removeClass(c.activeClass)}).hover(function(){m.addClass(c.hoverClass)},function(){m.removeClass(c.hoverClass)});if(a(l).attr("checked")){k.addClass(c.checkedClass)}if(a(l).attr("disabled")){m.addClass(c.disabledClass)}e(a(l),m);j(l)}function g(l){var m="<div><span></span></div>";l.after(m);m=l.next();var k=m.children();k.append(l);if(c.useID){m.attr("id",c.idPrefix+"-"+l.attr("id"))}m.addClass(c.radioClass).addClass(c.globalClass);a(l).css("opacity",0).focus(function(){m.addClass(c.focusClass)}).blur(function(){m.removeClass(c.focusClass)}).click(function(){if(!a(l).attr("checked")){k.removeClass(c.checkedClass)}else{a("."+c.radioClass+" span."+c.checkedClass+":has([name='"+a(l).attr("name")+"'])").removeClass(c.checkedClass);k.addClass(c.checkedClass)}}).mousedown(function(){if(!a(l).is(":disabled")){m.addClass(c.activeClass)}}).mouseup(function(){m.removeClass(c.activeClass)}).hover(function(){m.addClass(c.hoverClass)},function(){m.removeClass(c.hoverClass)});if(a(l).attr("checked")){k.addClass(c.checkedClass)}if(a(l).attr("disabled")){m.addClass(c.disabledClass)}e(a(l),m);j(l)}function h(p){var n=a(p);var q=a("<div />"),o=a("<span>"+a.htmlEscape(c.fileDefaultText)+"</span>"),l=a("<span>"+a.htmlEscape(c.fileBtnText)+"</span>");q.addClass(c.fileClass).addClass(c.globalClass);o.addClass(c.filenameClass);l.addClass(c.fileBtnClass);if(c.useID){q.attr("id",c.idPrefix+"-"+n.attr("id"))}n.wrap(q);n.after(l);n.after(o);q=n.closest("div");o=n.siblings("."+c.filenameClass);l=n.siblings("."+c.fileBtnClass);if(!n.attr("size")){var k=q.width();n.attr("size",k/10)}var m=function(){var s=n.val();if(s===""){s=c.fileDefaultText}else{s=s.split(/[\/\\]+/);s=s[(s.length-1)];o.text(s)}};m();n.css("opacity",0).focus(function(){q.addClass(c.focusClass)}).blur(function(){q.removeClass(c.focusClass)}).mousedown(function(){if(!a(p).is(":disabled")){q.addClass(c.activeClass)}}).mouseup(function(){q.removeClass(c.activeClass)}).hover(function(){q.addClass(c.hoverClass)},function(){q.removeClass(c.hoverClass)});if(a.browser.msie){n.click(function(){setTimeout(m,0)})}else{n.change(m)}if(n.attr("disabled")){q.addClass(c.disabledClass)}j(p)}function j(k){k=a(k).get();if(k.length>1){a.each(k,function(l,m){a.uniform.elements.push(m)})}else{a.uniform.elements.push(k)}}a.uniform.update=function(k){if(k==undefined){k=a(a.uniform.elements)}k=a(k);k.each(function(){var n=a(this);if(n.parents("body").length<1){return}var m;var p;if(n.is("select")){m=n.siblings("div").find("span");p=n.parent("div");p.removeClass(c.hoverClass+" "+c.focusClass+" "+c.activeClass);m.html(a.htmlEscape(n.find(":selected").text()));if(n.is(":disabled")){p.addClass(c.disabledClass)}else{p.removeClass(c.disabledClass)}}else{if(n.is(":checkbox")){m=n.closest("span");p=n.closest("div");p.removeClass(c.hoverClass+" "+c.focusClass+" "+c.activeClass);m.removeClass(c.checkedClass);if(n.is(":checked")){m.addClass(c.checkedClass)}if(n.is(":disabled")){p.addClass(c.disabledClass)}else{p.removeClass(c.disabledClass)}}else{if(n.is(":radio")){m=n.closest("span");p=n.closest("div");p.removeClass(c.hoverClass+" "+c.focusClass+" "+c.activeClass);m.removeClass(c.checkedClass);if(n.is(":checked")){m.addClass(c.checkedClass)}if(n.is(":disabled")){p.addClass(c.disabledClass)}else{p.removeClass(c.disabledClass)}}else{if(n.is(":file")){p=n.parent("div");var o=n.siblings(c.filenameClass);var l=n.siblings(c.fileBtnClass);p.removeClass(c.hoverClass+" "+c.focusClass+" "+c.activeClass);o.text(n.val());if(n.is(":disabled")){p.addClass(c.disabledClass)}else{p.removeClass(c.disabledClass)}}}}}})};function e(k,l){var m=k.attr("id");if(!a.isBlank(m)){l.parent().delegate('label[for="'+m+'"]',"mouseover",function(){l.addClass("focus")});l.parent().delegate('label[for="'+m+'"]',"mouseout",function(){l.removeClass("focus")})}}return this.each(function(){if(a.selectOpacity){var k=a(this);if(k.data("jquery.uniformed")===true){return}if(k.is("select")){if(k.attr("multiple")!=true){b(k)}}else{if(k.is(":checkbox")){d(k)}else{if(k.is(":radio")){g(k)}else{if(k.is(":file")){h(k)}}}}k.data("jquery.uniformed",true)}})}})(jQuery);(function(a){a.extend(a.fn,{validate:function(b){if(!this.length){b&&b.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var c=a.data(this[0],"validator");if(c){return c}c=new a.validator(b,this[0]);a.data(this[0],"validator",c);if(c.settings.onsubmit){this.find("input, button").filter(".cancel").click(function(){c.cancelSubmit=true});if(c.settings.submitHandler){this.find("input, button").filter(":submit").click(function(){c.submitButton=this})}this.submit(function(d){if(c.settings.debug){d.preventDefault()}function e(){if(c.settings.submitHandler){if(c.submitButton){var f=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(c.submitButton.value).appendTo(c.currentForm)}c.settings.submitHandler.call(c,c.currentForm);if(c.submitButton){f.remove()}return false}return true}if(c.cancelSubmit){c.cancelSubmit=false;return e()}if(c.form()){if(c.pendingRequest){c.formSubmitted=true;return false}return e()}else{c.focusInvalid();return false}})}return c},valid:function(){if(this.length===0){return true}else{if(a(this[0]).is("form")){return this.validate().form()}else{var c=true;var b=a(this[0].form).validate();this.each(function(){c&=b.element(this)});return c}}},removeAttrs:function(d){var b={},c=this;a.each(d.split(/\s/),function(e,f){b[f]=c.attr(f);c.removeAttr(f)});return b},rules:function(e,b){var g=this[0];if(e){var d=a.data(g.form,"validator").settings;var j=d.rules;var k=a.validator.staticRules(g);switch(e){case"add":a.extend(k,a.validator.normalizeRule(b));j[g.name]=k;if(b.messages){d.messages[g.name]=a.extend(d.messages[g.name],b.messages)}break;case"remove":if(!b){delete j[g.name];return k}var h={};a.each(b.split(/\s/),function(l,m){h[m]=k[m];delete k[m]});return h}}var f=a.validator.normalizeRules(a.extend({},a.validator.metadataRules(g),a.validator.classRules(g),a.validator.attributeRules(g),a.validator.staticRules(g)),g);if(f.required){var c=f.required;delete f.required;f=a.extend({required:c},f)}return f}});a.extend(a.expr[":"],{blank:function(b){return !a.trim(""+b.value)},filled:function(b){return !!a.trim(""+b.value)},unchecked:function(b){return !b.checked}});a.validator=function(b,c){this.settings=a.extend(true,{},a.validator.defaults,b);this.currentForm=c;this.init()};a.validator.format=function(b,c){if(arguments.length==1){return function(){var d=a.makeArray(arguments);d.unshift(b);return a.validator.format.apply(this,d)}}if(arguments.length>2&&c.constructor!=Array){c=a.makeArray(arguments).slice(1)}if(c.constructor!=Array){c=[c]}a.each(c,function(d,e){b=b.replace(new RegExp("\\{"+d+"\\}","g"),e)});return b};a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:true,ignore:[],ignoreTitle:false,onfocusin:function(b){this.lastActive=b;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,b,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(b)).hide()}},onfocusout:function(b){if(!this.checkable(b)&&(b.name in this.submitted||!this.optional(b))){this.element(b)}},onkeyup:function(b){if(b.name in this.submitted||b==this.lastElement){this.element(b)}},onclick:function(b){if(b.name in this.submitted){this.element(b)}else{if(b.parentNode.name in this.submitted){this.element(b.parentNode)}}},highlight:function(d,b,c){if(d.type==="radio"){this.findByName(d.name).addClass(b).removeClass(c)}else{a(d).addClass(b).removeClass(c)}},unhighlight:function(d,b,c){if(d.type==="radio"){this.findByName(d.name).removeClass(b).addClass(c)}else{a(d).removeClass(b).addClass(c)}}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=a(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm);this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var b=(this.groups={});a.each(this.settings.groups,function(e,f){a.each(f.split(/\s/),function(h,g){b[g]=e})});var d=this.settings.rules;a.each(d,function(e,f){d[e]=a.validator.normalizeRule(f)});function c(g){var f=a.data(this[0].form,"validator"),e="on"+g.type.replace(/^validate/,"");f.settings[e]&&f.settings[e].call(f,this[0])}a(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin focusout keyup",c).validateDelegate(":radio, :checkbox, select, option","click",c);if(this.settings.invalidHandler){a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)}},form:function(){this.checkForm();a.extend(this.submitted,this.errorMap);this.invalid=a.extend({},this.errorMap);if(!this.valid()){a(this.currentForm).triggerHandler("invalid-form",[this])}this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var b=0,c=(this.currentElements=this.elements());c[b];b++){this.check(c[b])}return this.valid()},element:function(c){c=this.clean(c);this.lastElement=c;this.prepareElement(c);this.currentElements=a(c);var b=this.check(c);if(b){delete this.invalid[c.name]}else{this.invalid[c.name]=true}if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers)}this.showErrors();return b},showErrors:function(c){if(c){a.extend(this.errorMap,c);this.errorList=[];for(var b in c){this.errorList.push({message:c[b],element:this.findByName(b)[0]})}this.successList=a.grep(this.successList,function(d){return !(d.name in c)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){if(a.fn.resetForm){a(this.currentForm).resetForm()}this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(d){var c=0;for(var b in d){c++}return c},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid){try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}}},findLastActive:function(){var b=this.lastActive;return b&&a.grep(this.errorList,function(c){return c.element.name==b.name}).length==1&&b},elements:function(){var c=this,b={};return a(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&c.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in b||!c.objectLength(a(this).rules())){return false}b[this.name]=true;return true})},clean:function(b){return a(b)[0]},errors:function(){return a(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=a([]);this.toHide=a([]);this.currentElements=a([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(b){this.reset();this.toHide=this.errorsFor(b)},check:function(c){c=this.clean(c);if(this.checkable(c)){c=this.findByName(c.name).not(this.settings.ignore)[0]}var h=a(c).rules();var d=false;for(var j in h){var g={method:j,parameters:h[j]};try{var b=a.validator.methods[j].call(this,c.value.replace(/\r/g,""),c,g.parameters);if(b=="dependency-mismatch"){d=true;continue}d=false;if(b=="pending"){this.toHide=this.toHide.not(this.errorsFor(c));return}if(!b){this.formatAndAdd(c,g);return false}}catch(f){this.settings.debug&&window.console&&console.log("exception occured when checking element "+c.id+", check the '"+g.method+"' method",f);throw f}}if(d){return}if(this.objectLength(h)){this.successList.push(c)}return true},customMetaMessage:function(b,d){if(!a.metadata){return}var c=this.settings.meta?a(b).metadata()[this.settings.meta]:a(b).metadata();return c&&c.messages&&c.messages[d]},customMessage:function(c,d){var b=this.settings.messages[c];return b&&(b.constructor==String?b:b[d])},findDefined:function(){for(var b=0;b<arguments.length;b++){if(arguments[b]!==undefined){return arguments[b]}}return undefined},defaultMessage:function(b,c){return this.findDefined(this.customMessage(b.name,c),this.customMetaMessage(b,c),!this.settings.ignoreTitle&&b.title||undefined,a.validator.messages[c],"<strong>Warning: No message defined for "+b.name+"</strong>")},formatAndAdd:function(c,e){var d=this.defaultMessage(c,e.method),b=/\$?\{(\d+)\}/g;if(typeof d=="function"){d=d.call(this,e.parameters,c)}else{if(b.test(d)){d=jQuery.format(d.replace(b,"{$1}"),e.parameters)}}this.errorList.push({message:d,element:c});this.errorMap[c.name]=d;this.submitted[c.name]=d},addWrapper:function(b){if(this.settings.wrapper){b=b.add(b.parent(this.settings.wrapper))}return b},defaultShowErrors:function(){for(var c=0;this.errorList[c];c++){var b=this.errorList[c];this.settings.highlight&&this.settings.highlight.call(this,b.element,this.settings.errorClass,this.settings.validClass);this.showLabel(b.element,b.message)}if(this.errorList.length){this.toShow=this.toShow.add(this.containers)}if(this.settings.success){for(var c=0;this.successList[c];c++){this.showLabel(this.successList[c])}}if(this.settings.unhighlight){for(var c=0,d=this.validElements();d[c];c++){this.settings.unhighlight.call(this,d[c],this.settings.errorClass,this.settings.validClass)}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(c,d){var b=this.errorsFor(c);if(b.length){b.removeClass().addClass(this.settings.errorClass);b.attr("generated")&&b.html(d)}else{b=a("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(c),generated:true}).addClass(this.settings.errorClass).html(d||"");if(this.settings.wrapper){b=b.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()}if(!this.labelContainer.append(b).length){this.settings.errorPlacement?this.settings.errorPlacement(b,a(c)):b.insertAfter(c)}}if(!d&&this.settings.success){b.text("");typeof this.settings.success=="string"?b.addClass(this.settings.success):this.settings.success(b)}this.toShow=this.toShow.add(b)},errorsFor:function(c){var b=this.idOrName(c);return this.errors().filter(function(){return a(this).attr("for")==b})},idOrName:function(b){return this.groups[b.name]||(this.checkable(b)?b.name:b.id||b.name)},checkable:function(b){return/radio|checkbox/i.test(b.type)},findByName:function(b){var c=this.currentForm;return a(document.getElementsByName(b)).map(function(d,e){return e.form==c&&e.name==b&&e||null})},getLength:function(c,b){switch(b.nodeName.toLowerCase()){case"select":return a("option:selected",b).length;case"input":if(this.checkable(b)){return this.findByName(b.name).filter(":checked").length}}return c.length},depend:function(c,b){return this.dependTypes[typeof c]?this.dependTypes[typeof c](c,b):true},dependTypes:{"boolean":function(c,b){return c},string:function(c,b){return !!a(c,b.form).length},"function":function(c,b){return c(b)}},optional:function(b){return !a.validator.methods.required.call(this,a.trim(b.value),b)&&"dependency-mismatch"},startRequest:function(b){if(!this.pending[b.name]){this.pendingRequest++;this.pending[b.name]=true}},stopRequest:function(b,c){this.pendingRequest--;if(this.pendingRequest<0){this.pendingRequest=0}delete this.pending[b.name];if(c&&this.pendingRequest==0&&this.formSubmitted&&this.form()){a(this.currentForm).submit();this.formSubmitted=false}else{if(!c&&this.pendingRequest==0&&this.formSubmitted){a(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}}},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:true,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(b,c){b.constructor==String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(c){var d={};var b=a(c).attr("class");b&&a.each(b.split(" "),function(){if(this in a.validator.classRuleSettings){a.extend(d,a.validator.classRuleSettings[this])}});return d},attributeRules:function(c){var e={};var b=a(c);for(var f in a.validator.methods){var d=b.attr(f);if(d){e[f]=d}}if(e.maxlength&&/-1|2147483647|524288/.test(e.maxlength)){delete e.maxlength}return e},metadataRules:function(b){if(!a.metadata){return{}}var c=a.data(b.form,"validator").settings.meta;return c?a(b).metadata()[c]:a(b).metadata()},staticRules:function(c){var d={};var b=a.data(c.form,"validator");if(b.settings.rules){d=a.validator.normalizeRule(b.settings.rules[c.name])||{}}return d},normalizeRules:function(c,b){a.each(c,function(f,e){if(e===false){delete c[f];return}if(e.param||e.depends){var d=true;switch(typeof e.depends){case"string":d=!!a(e.depends,b.form).length;break;case"function":d=e.depends.call(b,b);break}if(d){c[f]=e.param!==undefined?e.param:true}else{delete c[f]}}});a.each(c,function(d,e){c[d]=a.isFunction(e)?e(b):e});a.each(["minlength","maxlength","min","max"],function(){if(c[this]){c[this]=Number(c[this])}});a.each(["rangelength","range"],function(){if(c[this]){c[this]=[Number(c[this][0]),Number(c[this][1])]}});if(a.validator.autoCreateRanges){if(c.min&&c.max){c.range=[c.min,c.max];delete c.min;delete c.max}if(c.minlength&&c.maxlength){c.rangelength=[c.minlength,c.maxlength];delete c.minlength;delete c.maxlength}}if(c.messages){delete c.messages}return c},normalizeRule:function(c){if(typeof c=="string"){var b={};a.each(c.split(/\s/),function(){b[this]=true});c=b}return c},addMethod:function(b,d,c){a.validator.methods[b]=d;a.validator.messages[b]=c!=undefined?c:a.validator.messages[b];if(d.length<3){a.validator.addClassRules(b,a.validator.normalizeRule(b))}},methods:{required:function(c,b,e){if(!this.depend(e,b)){return"dependency-mismatch"}switch(b.nodeName.toLowerCase()){case"select":var d=a(b).val();return d&&d.length>0;case"input":if(this.checkable(b)){return this.getLength(c,b)>0}default:return a.trim(c).length>0}},remote:function(f,c,g){if(this.optional(c)){return"dependency-mismatch"}var d=this.previousValue(c);if(!this.settings.messages[c.name]){this.settings.messages[c.name]={}}d.originalMessage=this.settings.messages[c.name].remote;this.settings.messages[c.name].remote=d.message;g=typeof g=="string"&&{url:g}||g;if(this.pending[c.name]){return"pending"}if(d.old===f){return d.valid}d.old=f;var b=this;this.startRequest(c);var e={};e[c.name]=f;a.ajax(a.extend(true,{url:g,mode:"abort",port:"validate"+c.name,dataType:"json",data:e,success:function(j){b.settings.messages[c.name].remote=d.originalMessage;var l=j===true;if(l){var h=b.formSubmitted;b.prepareElement(c);b.formSubmitted=h;b.successList.push(c);b.showErrors()}else{var m={};var k=j||b.defaultMessage(c,"remote");m[c.name]=d.message=a.isFunction(k)?k(f):k;b.showErrors(m)}d.valid=l;b.stopRequest(c,l)}},g));return"pending"},minlength:function(c,b,d){return this.optional(b)||this.getLength(a.trim(c),b)>=d},maxlength:function(c,b,d){return this.optional(b)||this.getLength(a.trim(c),b)<=d},rangelength:function(d,b,e){var c=this.getLength(a.trim(d),b);return this.optional(b)||(c>=e[0]&&c<=e[1])},min:function(c,b,d){return this.optional(b)||c>=d},max:function(c,b,d){return this.optional(b)||c<=d},range:function(c,b,d){return this.optional(b)||(c>=d[0]&&c<=d[1])},email:function(c,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(c)},url:function(c,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(c)},date:function(c,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(c))},dateISO:function(c,b){return this.optional(b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(c)},number:function(c,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(c)},digits:function(c,b){return this.optional(b)||/^\d+$/.test(c)},creditcard:function(f,c){if(this.optional(c)){return"dependency-mismatch"}if(/[^0-9-]+/.test(f)){return false}var g=0,e=0,b=false;f=f.replace(/\D/g,"");for(var h=f.length-1;h>=0;h--){var d=f.charAt(h);var e=parseInt(d,10);if(b){if((e*=2)>9){e-=9}}g+=e;b=!b}return(g%10)==0},accept:function(c,b,d){d=typeof d=="string"?d.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(b)||c.match(new RegExp(".("+d+")$","i"))},equalTo:function(c,b,e){var d=a(e).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(b).valid()});return c==d.val()}}});a.format=a.validator.format})(jQuery);(function(c){var a={};if(c.ajaxPrefilter){c.ajaxPrefilter(function(f,e,g){var d=f.port;if(f.mode=="abort"){if(a[d]){a[d].abort()}a[d]=g}})}else{var b=c.ajax;c.ajax=function(e){var f=("mode" in e?e:c.ajaxSettings).mode,d=("port" in e?e:c.ajaxSettings).port;if(f=="abort"){if(a[d]){a[d].abort()}return(a[d]=b.apply(this,arguments))}return b.apply(this,arguments)}}})(jQuery);(function(a){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener){a.each({focus:"focusin",blur:"focusout"},function(c,b){a.event.special[b]={setup:function(){this.addEventListener(c,d,true)},teardown:function(){this.removeEventListener(c,d,true)},handler:function(f){arguments[0]=a.event.fix(f);arguments[0].type=b;return a.event.handle.apply(this,arguments)}};function d(f){f=a.event.fix(f);f.type=b;return a.event.handle.call(this,f)}})}a.extend(a.fn,{validateDelegate:function(d,c,b){return this.bind(c,function(e){var f=a(e.target);if(f.is(d)){return b.apply(f,arguments)}})}})})(jQuery);
/*!
	PURE Unobtrusive Rendering Engine for HTML

	Licensed under the MIT licenses.
	More information at: http://www.opensource.org

	Copyright (c) 2010 Michael Cvilic - BeeBole.com

	Thanks to Rog Peppe for the functional JS jump
	revision: 2.45
*/
var $p,pure=$p=function(){var b=arguments[0],a=false;if(typeof b==="string"){a=arguments[1]||false}return $p.core(b,a)};$p.core=function(w,g,v){var v=j(),f=[];switch(typeof w){case"string":f=v.find(g||document,w);if(f.length===0){x('The template "'+w+'" was not found')}break;case"undefined":x("The template root is undefined, check your selector");break;default:f=[w]}for(var y=0,p=f.length;y<p;y++){v[y]=f[y]}v.length=p;var o="_s"+Math.floor(Math.random()*1000000)+"_",d="_a"+Math.floor(Math.random()*1000000)+"_",c=/^(\+)?([^\@\+]+)?\@?([^\+]+)?(\+)?$/,q={IMG:"src",INPUT:"value"},n=Array.isArray?function(F){return Array.isArray(F)}:function(F){return Object.prototype.toString.call(F)==="[object Array]"};return v;function x(F){if(typeof console!=="undefined"){console.log(F)}else{alert(F)}throw ("pure error: "+F)}function j(){var F=$p.plugins,G=function(){};G.prototype=F;G.prototype.compile=F.compile||l;G.prototype.render=F.render||D;G.prototype.autoRender=F.autoRender||e;G.prototype.find=F.find||u;G.prototype._compiler=s;G.prototype._error=x;return new G()}function k(F){return F.outerHTML||(function(I){var H=document.createElement("div"),G;H.appendChild(I.cloneNode(true));G=H.innerHTML;H=null;return G})(F)}function a(F,G){return function(H){return F(""+G.call(H.context,H))}}function u(G,F){if(typeof G==="string"){F=G;G=false}if(typeof document.querySelectorAll!=="undefined"){return(G||document).querySelectorAll(F)}else{x("You can test PURE standalone with: iPhone, FF3.5+, Safari4+ and IE8+\n\nTo run PURE on your browser, you need a JS library/framework with a CSS selector engine")}}function b(G,F){return function(H){var L=[G[0]],O=G.length,I,N,K,M;for(var J=1;J<O;J++){I=F[J](H);N=G[J];if(I===""){K=L[L.length-1];if((M=K.search(/[\w]+=\"?$/))>-1){L[L.length-1]=K.substring(0,M);N=N.substr(1)}}L[L.length]=I;L[L.length]=N}return L.join("")}}function m(G){var F=G.match(/^(\w+)\s*<-\s*(\S+)?$/);if(F===null){x('bad loop spec: "'+G+'"')}if(F[1]==="item"){x('"item<-..." is a reserved word for the current running iteration.\n\nPlease choose another name for your loop.')}if(!F[2]||(F[2]&&(/context/i).test(F[2]))){F[2]=function(H){return H.context}}return{name:F[1],sel:F[2]}}function z(F){if(typeof(F)==="function"){return F}var H=F.match(/^[a-zA-Z\$_][\w\$:-]*(\.[\w\$:-]*[^\.])*!?$/);if(H===null){var M=false,N=F,I=[],L=[],J=0,K;if(/\'|\"/.test(N.charAt(0))){if(/\'|\"/.test(N.charAt(N.length-1))){K=N.substring(1,N.length-1);return function(){return K}}}else{while((H=N.match(/#\{([^{}]+)\}/))!==null){M=true;I[J++]=N.slice(0,H.index);L[J]=z(H[1]);N=N.slice(H.index+H[0].length,N.length)}}if(!M){x("bad data selector syntax: "+F)}I[J]=N;return b(I,L)}H=F.split(".");var G=F.endsWith("!");if(G){H[H.length-1]=H[H.length-1].substring(0,H[H.length-1].length-1)}return function(O){var R=O.context;if(!R){return""}var P=O[H[0]],Q=0;if(P&&P.item){R=P.item;Q+=1}var S=H.length;for(;Q<S;Q++){if(!R){break}R=R[H[Q]]}return(!R&&R!==0)?"":(G?$.htmlEscape(R):R)}}function E(N,G,S){var J,V,M,R,H,Q=[];if(typeof G==="string"){J=G;var L=G.match(c);if(!L){x("bad selector syntax: "+G)}V=L[1];M=L[2];R=L[3];H=L[4];if(M==="."||(!M&&R)){Q[0]=N}else{Q=v.find(N,M)}if(!Q||Q.length===0){return x('The node "'+G+'" was not found in the template')}}else{V=G.prepend;R=G.attr;H=G.append;Q=[N]}if(V||H){if(V&&H){x("append/prepend cannot take place at the same time")}else{if(S){x("no append/prepend/replace modifiers allowed for loop target")}else{if(H&&S){x("cannot append with loop (sel: "+J+")")}}}}var T,K,F,U,I,O,P;if(R){U=(/^style$/i).test(R);I=(/^class$/i).test(R);O=I?"className":R;T=function(X,W){X.setAttribute(d+R,W);if(O in X&&!U){X[O]=""}if(X.nodeType===1){X.removeAttribute(R);I&&X.removeAttribute(O)}};if(U||I){if(U){K=function(W){return W.style.cssText}}else{K=function(W){return W.className}}F=function(W){return W.replace(/\"/g,"&quot;")}}else{K=function(W){return W.getAttribute(R)};F=function(W){return W.replace(/\"/g,"&quot;").replace(/\s/g,"&nbsp;")}}if(V){P=function(X,W){if(I){T(X,W+" "+K(X))}else{T(X,W+K(X))}}}else{if(H){P=function(X,W){if(I){T(X,K(X)+" "+W)}else{T(X,K(X)+W)}}}else{P=function(X,W){T(X,W)}}}}else{if(S){P=function(Y,X){var W=Y.parentNode;if(W){W.insertBefore(document.createTextNode(X),Y.nextSibling);W.removeChild(Y)}}}else{if(V){P=function(X,W){X.insertBefore(document.createTextNode(W),X.firstChild)}}else{if(H){P=function(X,W){X.appendChild(document.createTextNode(W))}}else{P=function(X,W){while(X.firstChild){X.removeChild(X.firstChild)}X.appendChild(document.createTextNode(W))}}}}F=function(W){return W}}return{attr:R,nodes:Q,set:P,sel:J,quotefn:F}}function B(G,I){var H=o+I+":";for(var F=0;F<G.nodes.length;F++){G.set(G.nodes[F],H)}}function t(G,I,F,J,H){return function(Q){var S=I(Q),M=Q[G],U={items:S},P=0,L,O=[],R=function(X,Y,Z,W){var V=$.extend({},Q);V.pos=Y.pos=X;V.item=Y.item=S[X];V.items=S;typeof W!=="undefined"&&(V.length=W);if(typeof Z==="function"&&Z(V)===false){P++;return}O.push(F.call(Y,V))};Q[G]=U;if(n(S)){L=S.length||0;if(typeof J==="function"){S.sort(J)}for(var N=0,T=L;N<T;N++){R(N,U,H,L-P)}}else{if(S&&typeof J!=="undefined"){x("sort is only available on arrays, not objects")}for(var K in S){S.hasOwnProperty(K)&&R(K,U,H)}}typeof M!=="undefined"?Q[G]=M:delete Q[G];return O.join("")}}function h(M,K,O,S){var P=false,N,U,J,I;for(I in O){if(O.hasOwnProperty(I)){if(I==="sort"){U=O.sort;continue}else{if(I==="filter"){J=O.filter;continue}}if(P){x("cannot have more than one loop on a target")}N=I;P=true}}if(!N){x("Error in the selector: "+K+"\nA directive action must be a string, a function or a loop(<-)")}var H=O[N];if(typeof(H)==="string"||typeof(H)==="function"){O={};O[N]={root:H};return h(M,K,O,S)}var R=m(N),G=z(R.sel),Q=E(M,K,true),F=Q.nodes;for(y=0;y<F.length;y++){var L=F[y],T=s(L,H);S[S.length]=a(Q.quotefn,t(R.name,G,T,U,J));Q.nodes=[L];B(Q,S.length-1)}}function A(H,L){var Q=H.getElementsByTagName("*"),N=[],T={a:[],l:{}},I,J,M,R,K,O,G,P,S;for(M=-1,R=Q.length;M<R;M++){G=M>-1?Q[M]:H;if(G.nodeType===1&&G.className!==""){P=G.className.split(" ");for(K=0,O=P.length;K<O;K++){S=P[K];I=F(S,G.tagName);if(I!==false){J=(/nodevalue/i).test(I.attr);if(I.sel.indexOf("@")>-1||J){G.className=G.className.replace("@"+I.attr,"");if(J){I.attr=false}}N.push({n:G,cspec:I})}}}}return N;function F(ac,V){var Y=ac.match(c),aa=Y[3]||q[V],X={prepend:!!Y[1],prop:Y[2],attr:aa,append:!!Y[4],sel:ac},Z,ad,W,ab,U;for(Z=T.a.length-1;Z>=0;Z--){W=T.a[Z];ab=W.l[0];U=ab&&ab[X.prop];if(typeof U!=="undefined"){X.prop=W.p+"."+X.prop;if(T.l[X.prop]===true){U=U[0]}break}}if(typeof U==="undefined"){U=n(L)?L[0][X.prop]:L[X.prop];if(typeof U==="undefined"){return false}}if(n(U)){T.a.push({l:U,p:X.prop});T.l[X.prop]=true;X.t="loop"}else{X.t="str"}return X}}function s(U,I,Y,M){var G=[];M=M||Y&&A(U,Y);if(Y){var R,V,H,N,X,O,Z,P,W;while(M.length>0){H=M[0].cspec;N=M[0].n;M.splice(0,1);if(H.t==="str"){X=E(N,H,false);B(X,G.length);G[G.length]=a(X.quotefn,z(H.prop))}else{Z=z(H.sel);X=E(N,H,true);O=X.nodes;for(R=0,V=O.length;R<V;R++){P=O[R];W=s(P,false,Y,M);G[G.length]=a(X.quotefn,t(H.sel,Z,W));X.nodes=[P];B(X,G.length-1)}}}}var X,J;for(var Q in I){if(I.hasOwnProperty(Q)){J=I[Q];if(typeof(J)==="function"||typeof(J)==="string"){X=E(U,Q,false);B(X,G.length);G[G.length]=a(X.quotefn,z(J))}else{h(U,Q,J,G)}}}var T=k(U),F=[];T=T.replace(/<([^>]+)\s(value\=""|selected)\s?([^>]*)>/ig,"<$1 $3>");T=T.split(d).join("");var L=T.split(o),K;for(var S=1;S<L.length;S++){K=L[S];F[S]=G[parseInt(K,10)];L[S]=K.substring(K.indexOf(":")+1)}return b(L,F)}function l(I,G,H){var F=s((H||this[0]).cloneNode(true),I,G);return function(J){return F({context:J})}}function D(F,J){var I=typeof J==="function"?J:v.compile(J,false,this[0]);for(var G=0,H=this.length;G<H;G++){this[G]=C(this[G],I(F,false))}context=null;return this}function e(F,J){var I=v.compile(J,F,this[0]);for(var G=0,H=this.length;G<H;G++){this[G]=C(this[G],I(F,false))}context=null;return this}function C(J,G){var H,F=J.parentNode,I=0;switch(J.tagName){case"TBODY":case"THEAD":case"TFOOT":G="<TABLE>"+G+"</TABLE>";I=1;break;case"TR":G="<TABLE><TBODY>"+G+"</TBODY></TABLE>";I=2;break;case"TD":case"TH":G="<TABLE><TBODY><TR>"+G+"</TR></TBODY></TABLE>";I=3;break}tmp=document.createElement("SPAN");tmp.style.display="none";document.body.appendChild(tmp);tmp.innerHTML=G;H=tmp.firstChild;while(I--){H=H.firstChild}F.insertBefore(H,J);F.removeChild(J);document.body.removeChild(tmp);J=H;H=F=null;return J}};$p.plugins={};$p.libs={dojo:function(){if(typeof document.querySelector==="undefined"){$p.plugins.find=function(b,a){return dojo.query(a,b)}}},domassistant:function(){if(typeof document.querySelector==="undefined"){$p.plugins.find=function(b,a){return $(b).cssSelect(a)}}DOMAssistant.attach({publicMethods:["compile","render","autoRender"],compile:function(b,a){return $p(this).compile(b,a)},render:function(a,b){return $($p(this).render(a,b))[0]},autoRender:function(a,b){return $($p(this).autoRender(a,b))[0]}})},jquery:function(){if(typeof document.querySelector==="undefined"){$p.plugins.find=function(b,a){return $(b).find(a)}}jQuery.fn.extend({compile:function(b,a){return $p(this[0]).compile(b,a)},render:function(a,b){return $p(this[0]).render(a,b)},autoRender:function(a,b){return jQuery($p(this[0]).autoRender(a,b))}})},mootools:function(){if(typeof document.querySelector==="undefined"){$p.plugins.find=function(b,a){return $(b).getElements(a)}}Element.implement({compile:function(b,a){return $p(this).compile(b,a)},render:function(a,b){return $p(this).render(a,b)},autoRender:function(a,b){return $p(this).autoRender(a,b)}})},prototype:function(){if(typeof document.querySelector==="undefined"){$p.plugins.find=function(b,a){b=b===document?b.body:b;return typeof b==="string"?$$(b):$(b).select(a)}}Element.addMethods({compile:function(b,c,a){return $p(b).compile(c,a)},render:function(b,a,c){return $p(b).render(a,c)},autoRender:function(b,a,c){return $p(b).autoRender(a,c)}})},sizzle:function(){if(typeof document.querySelector==="undefined"){$p.plugins.find=function(b,a){return Sizzle(a,b)}}},sly:function(){if(typeof document.querySelector==="undefined"){$p.plugins.find=function(b,a){return Sly(a,b)}}}};(function(){var a=typeof dojo!=="undefined"&&"dojo"||typeof DOMAssistant!=="undefined"&&"domassistant"||typeof jQuery!=="undefined"&&"jquery"||typeof MooTools!=="undefined"&&"mootools"||typeof Prototype!=="undefined"&&"prototype"||typeof Sizzle!=="undefined"&&"sizzle"||typeof Sly!=="undefined"&&"sly";a&&$p.libs[a]()})();
/*!
 * jQuery UI 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(a,d){a.ui=a.ui||{};if(a.ui.version){return}a.extend(a.ui,{version:"1.8.23",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(e,f){return typeof e==="number"?this.each(function(){var g=this;setTimeout(function(){a(g).focus();if(f){f.call(g)}},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var e;if((a.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){e=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(a.curCSS(this,"position",1))&&(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}else{e=this.parents().filter(function(){return(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!e.length?a(document):e},zIndex:function(h){if(h!==d){return this.css("zIndex",h)}if(this.length){var f=a(this[0]),e,g;while(f.length&&f[0]!==document){e=f.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){g=parseInt(f.css("zIndex"),10);if(!isNaN(g)&&g!==0){return g}}f=f.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});if(!a("<a>").outerWidth(1).jquery){a.each(["Width","Height"],function(g,e){var f=e==="Width"?["Left","Right"]:["Top","Bottom"],h=e.toLowerCase(),k={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};function j(n,m,l,o){a.each(f,function(){m-=parseFloat(a.curCSS(n,"padding"+this,true))||0;if(l){m-=parseFloat(a.curCSS(n,"border"+this+"Width",true))||0}if(o){m-=parseFloat(a.curCSS(n,"margin"+this,true))||0}});return m}a.fn["inner"+e]=function(l){if(l===d){return k["inner"+e].call(this)}return this.each(function(){a(this).css(h,j(this,l)+"px")})};a.fn["outer"+e]=function(l,m){if(typeof l!=="number"){return k["outer"+e].call(this,l)}return this.each(function(){a(this).css(h,j(this,l,true,m)+"px")})}})}function c(g,e){var k=g.nodeName.toLowerCase();if("area"===k){var j=g.parentNode,h=j.name,f;if(!g.href||!h||j.nodeName.toLowerCase()!=="map"){return false}f=a("img[usemap=#"+h+"]")[0];return !!f&&b(f)}return(/input|select|textarea|button|object/.test(k)?!g.disabled:"a"==k?g.href||e:e)&&b(g)}function b(e){return !a(e).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(e){return function(f){return !!a.data(f,e)}}):function(g,f,e){return !!a.data(g,e[3])},focusable:function(e){return c(e,!isNaN(a.attr(e,"tabindex")))},tabbable:function(g){var e=a.attr(g,"tabindex"),f=isNaN(e);return(f||e>=0)&&c(g,!f)}});a(function(){var e=document.body,f=e.appendChild(f=document.createElement("div"));f.offsetHeight;a.extend(f.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=f.offsetHeight===100;a.support.selectstart="onselectstart" in f;e.removeChild(f).style.display="none"});if(!a.curCSS){a.curCSS=a.css}a.extend(a.ui,{plugin:{add:function(f,g,j){var h=a.ui[f].prototype;for(var e in j){h.plugins[e]=h.plugins[e]||[];h.plugins[e].push([g,j[e]])}},call:function(e,g,f){var j=e.plugins[g];if(!j||!e.element[0].parentNode){return}for(var h=0;h<j.length;h++){if(e.options[j[h][0]]){j[h][1].apply(e.element,f)}}}},contains:function(f,e){return document.compareDocumentPosition?f.compareDocumentPosition(e)&16:f!==e&&f.contains(e)},hasScroll:function(h,f){if(a(h).css("overflow")==="hidden"){return false}var e=(f&&f==="left")?"scrollLeft":"scrollTop",g=false;if(h[e]>0){return true}h[e]=1;g=(h[e]>0);h[e]=0;return g},isOverAxis:function(f,e,g){return(f>e)&&(f<(e+g))},isOver:function(k,f,j,h,e,g){return a.ui.isOverAxis(k,j,e)&&a.ui.isOverAxis(f,h,g)}})})(jQuery);
/*!
 * jQuery UI Widget 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(b,d){if(b.cleanData){var c=b.cleanData;b.cleanData=function(f){for(var g=0,h;(h=f[g])!=null;g++){try{b(h).triggerHandler("remove")}catch(j){}}c(f)}}else{var a=b.fn.remove;b.fn.remove=function(e,f){return this.each(function(){if(!f){if(!e||b.filter(e,[this]).length){b("*",this).add([this]).each(function(){try{b(this).triggerHandler("remove")}catch(g){}})}}return a.call(b(this),e,f)})}}b.widget=function(f,h,e){var g=f.split(".")[0],k;f=f.split(".")[1];k=g+"-"+f;if(!e){e=h;h=b.Widget}b.expr[":"][k]=function(l){return !!b.data(l,f)};b[g]=b[g]||{};b[g][f]=function(l,m){if(arguments.length){this._createWidget(l,m)}};var j=new h();j.options=b.extend(true,{},j.options);b[g][f].prototype=b.extend(true,j,{namespace:g,widgetName:f,widgetEventPrefix:b[g][f].prototype.widgetEventPrefix||f,widgetBaseClass:k},e);b.widget.bridge(f,b[g][f])};b.widget.bridge=function(f,e){b.fn[f]=function(j){var g=typeof j==="string",h=Array.prototype.slice.call(arguments,1),k=this;j=!g&&h.length?b.extend.apply(null,[true,j].concat(h)):j;if(g&&j.charAt(0)==="_"){return k}if(g){this.each(function(){var l=b.data(this,f),m=l&&b.isFunction(l[j])?l[j].apply(l,h):l;if(m!==l&&m!==d){k=m;return false}})}else{this.each(function(){var l=b.data(this,f);if(l){l.option(j||{})._init()}else{b.data(this,f,new e(j,this))}})}return k}};b.Widget=function(e,f){if(arguments.length){this._createWidget(e,f)}};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(f,g){b.data(g,this.widgetName,this);this.element=b(g);this.options=b.extend(true,{},this.options,this._getCreateOptions(),f);var e=this;this.element.bind("remove."+this.widgetName,function(){e.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(f,g){var e=f;if(arguments.length===0){return b.extend({},this.options)}if(typeof f==="string"){if(g===d){return this.options[f]}e={};e[f]=g}this._setOptions(e);return this},_setOptions:function(f){var e=this;b.each(f,function(g,h){e._setOption(g,h)});return this},_setOption:function(e,f){this.options[e]=f;if(e==="disabled"){this.widget()[f?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",f)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(e,f,g){var k,j,h=this.options[e];g=g||{};f=b.Event(f);f.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase();f.target=this.element[0];j=f.originalEvent;if(j){for(k in j){if(!(k in f)){f[k]=j[k]}}}this.element.trigger(f,g);return !(b.isFunction(h)&&h.call(this.element[0],f,g)===false||f.isDefaultPrevented())}}})(jQuery);
/*!
 * jQuery UI Mouse 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(b,c){var a=false;b(document).mouseup(function(d){a=false});b.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var d=this;this.element.bind("mousedown."+this.widgetName,function(e){return d._mouseDown(e)}).bind("click."+this.widgetName,function(e){if(true===b.data(e.target,d.widgetName+".preventClickEvent")){b.removeData(e.target,d.widgetName+".preventClickEvent");e.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(f){if(a){return}(this._mouseStarted&&this._mouseUp(f));this._mouseDownEvent=f;var e=this,g=(f.which==1),d=(typeof this.options.cancel=="string"&&f.target.nodeName?b(f.target).closest(this.options.cancel).length:false);if(!g||d||!this._mouseCapture(f)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(f)&&this._mouseDelayMet(f)){this._mouseStarted=(this._mouseStart(f)!==false);if(!this._mouseStarted){f.preventDefault();return true}}if(true===b.data(f.target,this.widgetName+".preventClickEvent")){b.removeData(f.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(h){return e._mouseMove(h)};this._mouseUpDelegate=function(h){return e._mouseUp(h)};b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);f.preventDefault();a=true;return true},_mouseMove:function(d){if(b.browser.msie&&!(document.documentMode>=9)&&!d.button){return this._mouseUp(d)}if(this._mouseStarted){this._mouseDrag(d);return d.preventDefault()}if(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,d)!==false);(this._mouseStarted?this._mouseDrag(d):this._mouseUp(d))}return !this._mouseStarted},_mouseUp:function(d){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(d.target==this._mouseDownEvent.target){b.data(d.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(d)}return false},_mouseDistanceMet:function(d){return(Math.max(Math.abs(this._mouseDownEvent.pageX-d.pageX),Math.abs(this._mouseDownEvent.pageY-d.pageY))>=this.options.distance)},_mouseDelayMet:function(d){return this.mouseDelayMet},_mouseStart:function(d){},_mouseDrag:function(d){},_mouseStop:function(d){},_mouseCapture:function(d){return true}})})(jQuery);
/*!
 * jQuery UI Position 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 */
(function(g,h){g.ui=g.ui||{};var d=/left|center|right/,e=/top|center|bottom/,a="center",f={},b=g.fn.position,c=g.fn.offset;g.fn.position=function(k){if(!k||!k.of){return b.apply(this,arguments)}k=g.extend({},k);var o=g(k.of),n=o[0],q=(k.collision||"flip").split(" "),p=k.offset?k.offset.split(" "):[0,0],m,j,l;if(n.nodeType===9){m=o.width();j=o.height();l={top:0,left:0}}else{if(n.setTimeout){m=o.width();j=o.height();l={top:o.scrollTop(),left:o.scrollLeft()}}else{if(n.preventDefault){k.at="left top";m=j=0;l={top:k.of.pageY,left:k.of.pageX}}else{m=o.outerWidth();j=o.outerHeight();l=o.offset()}}}g.each(["my","at"],function(){var s=(k[this]||"").split(" ");if(s.length===1){s=d.test(s[0])?s.concat([a]):e.test(s[0])?[a].concat(s):[a,a]}s[0]=d.test(s[0])?s[0]:a;s[1]=e.test(s[1])?s[1]:a;k[this]=s});if(q.length===1){q[1]=q[0]}p[0]=parseInt(p[0],10)||0;if(p.length===1){p[1]=p[0]}p[1]=parseInt(p[1],10)||0;if(k.at[0]==="right"){l.left+=m}else{if(k.at[0]===a){l.left+=m/2}}if(k.at[1]==="bottom"){l.top+=j}else{if(k.at[1]===a){l.top+=j/2}}l.left+=p[0];l.top+=p[1];return this.each(function(){var v=g(this),x=v.outerWidth(),u=v.outerHeight(),w=parseInt(g.curCSS(this,"marginLeft",true))||0,t=parseInt(g.curCSS(this,"marginTop",true))||0,z=x+w+(parseInt(g.curCSS(this,"marginRight",true))||0),A=u+t+(parseInt(g.curCSS(this,"marginBottom",true))||0),y=g.extend({},l),s;if(k.my[0]==="right"){y.left-=x}else{if(k.my[0]===a){y.left-=x/2}}if(k.my[1]==="bottom"){y.top-=u}else{if(k.my[1]===a){y.top-=u/2}}if(!f.fractions){y.left=Math.round(y.left);y.top=Math.round(y.top)}s={left:y.left-w,top:y.top-t};g.each(["left","top"],function(C,B){if(g.ui.position[q[C]]){g.ui.position[q[C]][B](y,{targetWidth:m,targetHeight:j,elemWidth:x,elemHeight:u,collisionPosition:s,collisionWidth:z,collisionHeight:A,offset:p,my:k.my,at:k.at})}});if(g.fn.bgiframe){v.bgiframe()}v.offset(g.extend(y,{using:k.using}))})};g.ui.position={fit:{left:function(j,k){var m=g(window),l=k.collisionPosition.left+k.collisionWidth-m.width()-m.scrollLeft();j.left=l>0?j.left-l:Math.max(j.left-k.collisionPosition.left,j.left)},top:function(j,k){var m=g(window),l=k.collisionPosition.top+k.collisionHeight-m.height()-m.scrollTop();j.top=l>0?j.top-l:Math.max(j.top-k.collisionPosition.top,j.top)}},flip:{left:function(k,m){if(m.at[0]===a){return}var o=g(window),n=m.collisionPosition.left+m.collisionWidth-o.width()-o.scrollLeft(),j=m.my[0]==="left"?-m.elemWidth:m.my[0]==="right"?m.elemWidth:0,l=m.at[0]==="left"?m.targetWidth:-m.targetWidth,p=-2*m.offset[0];k.left+=m.collisionPosition.left<0?j+l+p:n>0?j+l+p:0},top:function(k,m){if(m.at[1]===a){return}var o=g(window),n=m.collisionPosition.top+m.collisionHeight-o.height()-o.scrollTop(),j=m.my[1]==="top"?-m.elemHeight:m.my[1]==="bottom"?m.elemHeight:0,l=m.at[1]==="top"?m.targetHeight:-m.targetHeight,p=-2*m.offset[1];k.top+=m.collisionPosition.top<0?j+l+p:n>0?j+l+p:0}}};if(!g.offset.setOffset){g.offset.setOffset=function(n,k){if(/static/.test(g.curCSS(n,"position"))){n.style.position="relative"}var m=g(n),p=m.offset(),j=parseInt(g.curCSS(n,"top",true),10)||0,o=parseInt(g.curCSS(n,"left",true),10)||0,l={top:(k.top-p.top)+j,left:(k.left-p.left)+o};if("using" in k){k.using.call(n,l)}else{m.css(l)}};g.fn.offset=function(j){var k=this[0];if(!k||!k.ownerDocument){return null}if(j){if(g.isFunction(j)){return this.each(function(l){g(this).offset(j.call(this,l,g(this).offset()))})}return this.each(function(){g.offset.setOffset(this,j)})}return c.call(this)}}if(!g.curCSS){g.curCSS=g.css}(function(){var j=document.getElementsByTagName("body")[0],q=document.createElement("div"),n,p,k,o,m;n=document.createElement(j?"div":"body");k={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(j){g.extend(k,{position:"absolute",left:"-1000px",top:"-1000px"})}for(var l in k){n.style[l]=k[l]}n.appendChild(q);p=j||document.documentElement;p.insertBefore(n,p.firstChild);q.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;";o=g(q).offset(function(s,t){return t}).offset();n.innerHTML="";p.removeChild(n);m=o.top+o.left+(j?2000:0);f.fractions=m>21&&m<22})()}(jQuery));
/*!
 * jQuery UI Draggable 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Draggables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}(this.options.addClasses&&this.element.addClass("ui-draggable"));(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));this._mouseInit()},destroy:function(){if(!this.element.data("draggable")){return}this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this},_mouseCapture:function(c){var d=this.options;if(this.helper||d.disabled||a(c.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(c);if(!this.handle){return false}if(d.iframeFix){a(d.iframeFix===true?"iframe":d.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(a(this).offset()).appendTo("body")})}return true},_mouseStart:function(c){var d=this.options;this.helper=this._createHelper(c);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if(a.ui.ddmanager){a.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:c.pageX-this.offset.left,top:c.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(c);this.originalPageX=c.pageX;this.originalPageY=c.pageY;(d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt));if(d.containment){this._setContainment()}if(this._trigger("start",c)===false){this._clear();return false}this._cacheHelperProportions();if(a.ui.ddmanager&&!d.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,c)}this._mouseDrag(c,true);if(a.ui.ddmanager){a.ui.ddmanager.dragStart(this,c)}return true},_mouseDrag:function(c,e){this.position=this._generatePosition(c);this.positionAbs=this._convertPositionTo("absolute");if(!e){var d=this._uiHash();if(this._trigger("drag",c,d)===false){this._mouseUp({});return false}this.position=d.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if(a.ui.ddmanager){a.ui.ddmanager.drag(this,c)}return false},_mouseStop:function(e){var g=false;if(a.ui.ddmanager&&!this.options.dropBehaviour){g=a.ui.ddmanager.drop(this,e)}if(this.dropped){g=this.dropped;this.dropped=false}var d=this.element[0],f=false;while(d&&(d=d.parentNode)){if(d==document){f=true}}if(!f&&this.options.helper==="original"){return false}if((this.options.revert=="invalid"&&!g)||(this.options.revert=="valid"&&g)||this.options.revert===true||(a.isFunction(this.options.revert)&&this.options.revert.call(this.element,g))){var c=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(c._trigger("stop",e)!==false){c._clear()}})}else{if(this._trigger("stop",e)!==false){this._clear()}}return false},_mouseUp:function(c){if(this.options.iframeFix===true){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}if(a.ui.ddmanager){a.ui.ddmanager.dragStop(this,c)}return a.ui.mouse.prototype._mouseUp.call(this,c)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(c){var d=!this.options.handle||!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==c.target){d=true}});return d},_createHelper:function(d){var e=this.options;var c=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[d])):(e.helper=="clone"?this.element.clone().removeAttr("id"):this.element);if(!c.parents("body").length){c.appendTo((e.appendTo=="parent"?this.element[0].parentNode:e.appendTo))}if(c[0]!=this.element[0]&&!(/(fixed|absolute)/).test(c.css("position"))){c.css("position","absolute")}return c},_adjustOffsetFromHelper:function(c){if(typeof c=="string"){c=c.split(" ")}if(a.isArray(c)){c={left:+c[0],top:+c[1]||0}}if("left" in c){this.offset.click.left=c.left+this.margins.left}if("right" in c){this.offset.click.left=this.helperProportions.width-c.right+this.margins.left}if("top" in c){this.offset.click.top=c.top+this.margins.top}if("bottom" in c){this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){c.left+=this.scrollParent.scrollLeft();c.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)){c={top:0,left:0}}return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var c=this.element.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var g=this.options;if(g.containment=="parent"){g.containment=this.helper[0].parentNode}if(g.containment=="document"||g.containment=="window"){this.containment=[g.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,g.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(g.containment=="document"?0:a(window).scrollLeft())+a(g.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(g.containment=="document"?0:a(window).scrollTop())+(a(g.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(g.containment)&&g.containment.constructor!=Array){var h=a(g.containment);var e=h[0];if(!e){return}var f=h.offset();var d=(a(e).css("overflow")!="hidden");this.containment=[(parseInt(a(e).css("borderLeftWidth"),10)||0)+(parseInt(a(e).css("paddingLeft"),10)||0),(parseInt(a(e).css("borderTopWidth"),10)||0)+(parseInt(a(e).css("paddingTop"),10)||0),(d?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(a(e).css("borderLeftWidth"),10)||0)-(parseInt(a(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(a(e).css("borderTopWidth"),10)||0)-(parseInt(a(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=h}else{if(g.containment.constructor==Array){this.containment=g.containment}}},_convertPositionTo:function(g,j){if(!j){j=this.position}var e=g=="absolute"?1:-1;var f=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,h=(/(html|body)/i).test(c[0].tagName);return{top:(j.top+this.offset.relative.top*e+this.offset.parent.top*e-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(h?0:c.scrollTop()))*e)),left:(j.left+this.offset.relative.left*e+this.offset.parent.left*e-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():h?0:c.scrollLeft())*e))}},_generatePosition:function(d){var e=this.options,m=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,j=(/(html|body)/i).test(m[0].tagName);var h=d.pageX;var g=d.pageY;if(this.originalPosition){var c;if(this.containment){if(this.relative_container){var l=this.relative_container.offset();c=[this.containment[0]+l.left,this.containment[1]+l.top,this.containment[2]+l.left,this.containment[3]+l.top]}else{c=this.containment}if(d.pageX-this.offset.click.left<c[0]){h=c[0]+this.offset.click.left}if(d.pageY-this.offset.click.top<c[1]){g=c[1]+this.offset.click.top}if(d.pageX-this.offset.click.left>c[2]){h=c[2]+this.offset.click.left}if(d.pageY-this.offset.click.top>c[3]){g=c[3]+this.offset.click.top}}if(e.grid){var k=e.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1]:this.originalPageY;g=c?(!(k-this.offset.click.top<c[1]||k-this.offset.click.top>c[3])?k:(!(k-this.offset.click.top<c[1])?k-e.grid[1]:k+e.grid[1])):k;var f=e.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/e.grid[0])*e.grid[0]:this.originalPageX;h=c?(!(f-this.offset.click.left<c[0]||f-this.offset.click.left>c[2])?f:(!(f-this.offset.click.left<c[0])?f-e.grid[0]:f+e.grid[0])):f}}return{top:(g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(j?0:m.scrollTop())))),left:(h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():j?0:m.scrollLeft())))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(c,d,e){e=e||this._uiHash();a.ui.plugin.call(this,c,[d,e]);if(c=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return a.Widget.prototype._trigger.call(this,c,d,e)},plugins:{},_uiHash:function(c){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.23"});a.ui.plugin.add("draggable","connectToSortable",{start:function(d,f){var e=a(this).data("draggable"),g=e.options,c=a.extend({},f,{item:e.element});e.sortables=[];a(g.connectToSortable).each(function(){var h=a.data(this,"sortable");if(h&&!h.options.disabled){e.sortables.push({instance:h,shouldRevert:h.options.revert});h.refreshPositions();h._trigger("activate",d,c)}})},stop:function(d,f){var e=a(this).data("draggable"),c=a.extend({},f,{item:e.element});a.each(e.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;e.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(d);this.instance.options.helper=this.instance.options._helper;if(e.options.helper=="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",d,c)}})},drag:function(d,g){var f=a(this).data("draggable"),c=this;var e=function(k){var q=this.offset.click.top,p=this.offset.click.left;var h=this.positionAbs.top,m=this.positionAbs.left;var l=k.height,n=k.width;var s=k.top,j=k.left;return a.ui.isOver(h+q,m+p,s,j,l,n)};a.each(f.sortables,function(h){this.instance.positionAbs=f.positionAbs;this.instance.helperProportions=f.helperProportions;this.instance.offset.click=f.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=a(c).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return g.helper[0]};d.target=this.instance.currentItem[0];this.instance._mouseCapture(d,true);this.instance._mouseStart(d,true,true);this.instance.offset.click.top=f.offset.click.top;this.instance.offset.click.left=f.offset.click.left;this.instance.offset.parent.left-=f.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=f.offset.parent.top-this.instance.offset.parent.top;f._trigger("toSortable",d);f.dropped=this.instance.element;f.currentItem=f.element;this.instance.fromOutside=f}if(this.instance.currentItem){this.instance._mouseDrag(d)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",d,this.instance._uiHash(this.instance));this.instance._mouseStop(d,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}f._trigger("fromSortable",d);f.dropped=false}}})}});a.ui.plugin.add("draggable","cursor",{start:function(d,e){var c=a("body"),f=a(this).data("draggable").options;if(c.css("cursor")){f._cursor=c.css("cursor")}c.css("cursor",f.cursor)},stop:function(c,d){var e=a(this).data("draggable").options;if(e._cursor){a("body").css("cursor",e._cursor)}}});a.ui.plugin.add("draggable","opacity",{start:function(d,e){var c=a(e.helper),f=a(this).data("draggable").options;if(c.css("opacity")){f._opacity=c.css("opacity")}c.css("opacity",f.opacity)},stop:function(c,d){var e=a(this).data("draggable").options;if(e._opacity){a(d.helper).css("opacity",e._opacity)}}});a.ui.plugin.add("draggable","scroll",{start:function(d,e){var c=a(this).data("draggable");if(c.scrollParent[0]!=document&&c.scrollParent[0].tagName!="HTML"){c.overflowOffset=c.scrollParent.offset()}},drag:function(e,f){var d=a(this).data("draggable"),g=d.options,c=false;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!g.axis||g.axis!="x"){if((d.overflowOffset.top+d.scrollParent[0].offsetHeight)-e.pageY<g.scrollSensitivity){d.scrollParent[0].scrollTop=c=d.scrollParent[0].scrollTop+g.scrollSpeed}else{if(e.pageY-d.overflowOffset.top<g.scrollSensitivity){d.scrollParent[0].scrollTop=c=d.scrollParent[0].scrollTop-g.scrollSpeed}}}if(!g.axis||g.axis!="y"){if((d.overflowOffset.left+d.scrollParent[0].offsetWidth)-e.pageX<g.scrollSensitivity){d.scrollParent[0].scrollLeft=c=d.scrollParent[0].scrollLeft+g.scrollSpeed}else{if(e.pageX-d.overflowOffset.left<g.scrollSensitivity){d.scrollParent[0].scrollLeft=c=d.scrollParent[0].scrollLeft-g.scrollSpeed}}}}else{if(!g.axis||g.axis!="x"){if(e.pageY-a(document).scrollTop()<g.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed)}else{if(a(window).height()-(e.pageY-a(document).scrollTop())<g.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)}}}if(!g.axis||g.axis!="y"){if(e.pageX-a(document).scrollLeft()<g.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed)}else{if(a(window).width()-(e.pageX-a(document).scrollLeft())<g.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed)}}}}if(c!==false&&a.ui.ddmanager&&!g.dropBehaviour){a.ui.ddmanager.prepareOffsets(d,e)}}});a.ui.plugin.add("draggable","snap",{start:function(d,e){var c=a(this).data("draggable"),f=c.options;c.snapElements=[];a(f.snap.constructor!=String?(f.snap.items||":data(draggable)"):f.snap).each(function(){var h=a(this);var g=h.offset();if(this!=c.element[0]){c.snapElements.push({item:this,width:h.outerWidth(),height:h.outerHeight(),top:g.top,left:g.left})}})},drag:function(u,p){var g=a(this).data("draggable"),q=g.options;var y=q.snapTolerance;var x=p.offset.left,w=x+g.helperProportions.width,f=p.offset.top,e=f+g.helperProportions.height;for(var v=g.snapElements.length-1;v>=0;v--){var s=g.snapElements[v].left,n=s+g.snapElements[v].width,m=g.snapElements[v].top,A=m+g.snapElements[v].height;if(!((s-y<x&&x<n+y&&m-y<f&&f<A+y)||(s-y<x&&x<n+y&&m-y<e&&e<A+y)||(s-y<w&&w<n+y&&m-y<f&&f<A+y)||(s-y<w&&w<n+y&&m-y<e&&e<A+y))){if(g.snapElements[v].snapping){(g.options.snap.release&&g.options.snap.release.call(g.element,u,a.extend(g._uiHash(),{snapItem:g.snapElements[v].item})))}g.snapElements[v].snapping=false;continue}if(q.snapMode!="inner"){var c=Math.abs(m-e)<=y;var z=Math.abs(A-f)<=y;var j=Math.abs(s-w)<=y;var k=Math.abs(n-x)<=y;if(c){p.position.top=g._convertPositionTo("relative",{top:m-g.helperProportions.height,left:0}).top-g.margins.top}if(z){p.position.top=g._convertPositionTo("relative",{top:A,left:0}).top-g.margins.top}if(j){p.position.left=g._convertPositionTo("relative",{top:0,left:s-g.helperProportions.width}).left-g.margins.left}if(k){p.position.left=g._convertPositionTo("relative",{top:0,left:n}).left-g.margins.left}}var h=(c||z||j||k);if(q.snapMode!="outer"){var c=Math.abs(m-f)<=y;var z=Math.abs(A-e)<=y;var j=Math.abs(s-x)<=y;var k=Math.abs(n-w)<=y;if(c){p.position.top=g._convertPositionTo("relative",{top:m,left:0}).top-g.margins.top}if(z){p.position.top=g._convertPositionTo("relative",{top:A-g.helperProportions.height,left:0}).top-g.margins.top}if(j){p.position.left=g._convertPositionTo("relative",{top:0,left:s}).left-g.margins.left}if(k){p.position.left=g._convertPositionTo("relative",{top:0,left:n-g.helperProportions.width}).left-g.margins.left}}if(!g.snapElements[v].snapping&&(c||z||j||k||h)){(g.options.snap.snap&&g.options.snap.snap.call(g.element,u,a.extend(g._uiHash(),{snapItem:g.snapElements[v].item})))}g.snapElements[v].snapping=(c||z||j||k||h)}}});a.ui.plugin.add("draggable","stack",{start:function(d,e){var g=a(this).data("draggable").options;var f=a.makeArray(a(g.stack)).sort(function(j,h){return(parseInt(a(j).css("zIndex"),10)||0)-(parseInt(a(h).css("zIndex"),10)||0)});if(!f.length){return}var c=parseInt(f[0].style.zIndex)||0;a(f).each(function(h){this.style.zIndex=c+h});this[0].style.zIndex=c+f.length}});a.ui.plugin.add("draggable","zIndex",{start:function(d,e){var c=a(e.helper),f=a(this).data("draggable").options;if(c.css("zIndex")){f._zIndex=c.css("zIndex")}c.css("zIndex",f.zIndex)},stop:function(c,d){var e=a(this).data("draggable").options;if(e._zIndex){a(d.helper).css("zIndex",e._zIndex)}}})})(jQuery);
/*!
 * jQuery UI Droppable 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Droppables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */
(function(a,b){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var d=this.options,c=d.accept;this.isover=0;this.isout=1;this.accept=a.isFunction(c)?c:function(e){return e.is(c)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[d.scope]=a.ui.ddmanager.droppables[d.scope]||[];a.ui.ddmanager.droppables[d.scope].push(this);(d.addClasses&&this.element.addClass("ui-droppable"))},destroy:function(){var c=a.ui.ddmanager.droppables[this.options.scope];for(var d=0;d<c.length;d++){if(c[d]==this){c.splice(d,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(c,d){if(c=="accept"){this.accept=a.isFunction(d)?d:function(e){return e.is(d)}}a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(d){var c=a.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}(c&&this._trigger("activate",d,this.ui(c)))},_deactivate:function(d){var c=a.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}(c&&this._trigger("deactivate",d,this.ui(c)))},_over:function(d){var c=a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0]){return}if(this.accept.call(this.element[0],(c.currentItem||c.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",d,this.ui(c))}},_out:function(d){var c=a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0]){return}if(this.accept.call(this.element[0],(c.currentItem||c.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",d,this.ui(c))}},_drop:function(d,e){var c=e||a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0]){return false}var f=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var g=a.data(this,"droppable");if(g.options.greedy&&!g.options.disabled&&g.options.scope==c.options.scope&&g.accept.call(g.element[0],(c.currentItem||c.element))&&a.ui.intersect(c,a.extend(g,{offset:g.element.offset()}),g.options.tolerance)){f=true;return false}});if(f){return false}if(this.accept.call(this.element[0],(c.currentItem||c.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",d,this.ui(c));return this.element}return false},ui:function(d){return{draggable:(d.currentItem||d.element),helper:d.helper,position:d.position,offset:d.positionAbs}}});a.extend(a.ui.droppable,{version:"1.8.23"});a.ui.intersect=function(s,k,p){if(!k.offset){return false}var e=(s.positionAbs||s.position.absolute).left,d=e+s.helperProportions.width,o=(s.positionAbs||s.position.absolute).top,n=o+s.helperProportions.height;var g=k.offset.left,c=g+k.proportions.width,q=k.offset.top,m=q+k.proportions.height;switch(p){case"fit":return(g<=e&&d<=c&&q<=o&&n<=m);break;case"intersect":return(g<e+(s.helperProportions.width/2)&&d-(s.helperProportions.width/2)<c&&q<o+(s.helperProportions.height/2)&&n-(s.helperProportions.height/2)<m);break;case"pointer":var h=((s.positionAbs||s.position.absolute).left+(s.clickOffset||s.offset.click).left),j=((s.positionAbs||s.position.absolute).top+(s.clickOffset||s.offset.click).top),f=a.ui.isOver(j,h,q,g,k.proportions.height,k.proportions.width);return f;break;case"touch":return((o>=q&&o<=m)||(n>=q&&n<=m)||(o<q&&n>m))&&((e>=g&&e<=c)||(d>=g&&d<=c)||(e<g&&d>c));break;default:return false;break}};a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(f,h){var c=a.ui.ddmanager.droppables[f.options.scope]||[];var g=h?h.type:null;var k=(f.currentItem||f.element).find(":data(droppable)").andSelf();droppablesLoop:for(var e=0;e<c.length;e++){if(c[e].options.disabled||(f&&!c[e].accept.call(c[e].element[0],(f.currentItem||f.element)))){continue}for(var d=0;d<k.length;d++){if(k[d]==c[e].element[0]){c[e].proportions.height=0;continue droppablesLoop}}c[e].visible=c[e].element.css("display")!="none";if(!c[e].visible){continue}if(g=="mousedown"){c[e]._activate.call(c[e],h)}c[e].offset=c[e].element.offset();c[e].proportions={width:c[e].element[0].offsetWidth,height:c[e].element[0].offsetHeight}}},drop:function(c,d){var e=false;a.each(a.ui.ddmanager.droppables[c.options.scope]||[],function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&a.ui.intersect(c,this,this.options.tolerance)){e=this._drop.call(this,d)||e}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(c.currentItem||c.element))){this.isout=1;this.isover=0;this._deactivate.call(this,d)}});return e},dragStart:function(c,d){c.element.parents(":not(body,html)").bind("scroll.droppable",function(){if(!c.options.refreshPositions){a.ui.ddmanager.prepareOffsets(c,d)}})},drag:function(c,d){if(c.options.refreshPositions){a.ui.ddmanager.prepareOffsets(c,d)}a.each(a.ui.ddmanager.droppables[c.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var f=a.ui.intersect(c,this,this.options.tolerance);var h=!f&&this.isover==1?"isout":(f&&this.isover==0?"isover":null);if(!h){return}var g;if(this.options.greedy){var e=this.element.parents(":data(droppable):eq(0)");if(e.length){g=a.data(e[0],"droppable");g.greedyChild=(h=="isover"?1:0)}}if(g&&h=="isover"){g.isover=0;g.isout=1;g._out.call(g,d)}this[h]=1;this[h=="isout"?"isover":"isout"]=0;this[h=="isover"?"_over":"_out"].call(this,d);if(g&&h=="isout"){g.isout=0;g.isover=1;g._over.call(g,d)}})},dragStop:function(c,d){c.element.parents(":not(body,html)").unbind("scroll.droppable");if(!c.options.refreshPositions){a.ui.ddmanager.prepareOffsets(c,d)}}}})(jQuery);
/*!
 * jQuery UI Resizable 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Resizables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(c,d){c.widget("ui.resizable",c.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var f=this,k=this.options;this.element.addClass("ui-resizable");c.extend(this,{_aspectRatio:!!(k.aspectRatio),aspectRatio:k.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:k.helper||k.ghost||k.animate?k.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){this.element.wrap(c('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=k.handles||(!c(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var l=this.handles.split(",");this.handles={};for(var g=0;g<l.length;g++){var j=c.trim(l[g]),e="ui-resizable-"+j;var h=c('<div class="ui-resizable-handle '+e+'"></div>');h.css({zIndex:k.zIndex});if("se"==j){h.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[j]=".ui-resizable-"+j;this.element.append(h)}}this._renderAxis=function(q){q=q||this.element;for(var n in this.handles){if(this.handles[n].constructor==String){this.handles[n]=c(this.handles[n],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var o=c(this.handles[n],this.element),p=0;p=/sw|ne|nw|se|n|s/.test(n)?o.outerHeight():o.outerWidth();var m=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");q.css(m,p);this._proportionallyResize()}if(!c(this.handles[n]).length){continue}}};this._renderAxis(this.element);this._handles=c(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!f.resizing){if(this.className){var m=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}f.axis=m&&m[1]?m[1]:"se"}});if(k.autoHide){this._handles.hide();c(this.element).addClass("ui-resizable-autohide").hover(function(){if(k.disabled){return}c(this).removeClass("ui-resizable-autohide");f._handles.show()},function(){if(k.disabled){return}if(!f.resizing){c(this).addClass("ui-resizable-autohide");f._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var e=function(g){c(g).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){e(this.element);var f=this.element;f.after(this.originalElement.css({position:f.css("position"),width:f.outerWidth(),height:f.outerHeight(),top:f.css("top"),left:f.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);e(this.originalElement);return this},_mouseCapture:function(f){var g=false;for(var e in this.handles){if(c(this.handles[e])[0]==f.target){g=true}}return !this.options.disabled&&g},_mouseStart:function(g){var k=this.options,f=this.element.position(),e=this.element;this.resizing=true;this.documentScroll={top:c(document).scrollTop(),left:c(document).scrollLeft()};if(e.is(".ui-draggable")||(/absolute/).test(e.css("position"))){e.css({position:"absolute",top:f.top,left:f.left})}this._renderProxy();var l=b(this.helper.css("left")),h=b(this.helper.css("top"));if(k.containment){l+=c(k.containment).scrollLeft()||0;h+=c(k.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:l,top:h};this.size=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalSize=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalPosition={left:l,top:h};this.sizeDiff={width:e.outerWidth()-e.width(),height:e.outerHeight()-e.height()};this.originalMousePosition={left:g.pageX,top:g.pageY};this.aspectRatio=(typeof k.aspectRatio=="number")?k.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var j=c(".ui-resizable-"+this.axis).css("cursor");c("body").css("cursor",j=="auto"?this.axis+"-resize":j);e.addClass("ui-resizable-resizing");this._propagate("start",g);return true},_mouseDrag:function(e){var h=this.helper,g=this.options,n={},s=this,k=this.originalMousePosition,p=this.axis;var t=(e.pageX-k.left)||0,q=(e.pageY-k.top)||0;var j=this._change[p];if(!j){return false}var m=j.apply(this,[e,t,q]),l=c.browser.msie&&c.browser.version<7,f=this.sizeDiff;this._updateVirtualBoundaries(e.shiftKey);if(this._aspectRatio||e.shiftKey){m=this._updateRatio(m,e)}m=this._respectSize(m,e);this._propagate("resize",e);h.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(m);this._trigger("resize",e,this.ui());return false},_mouseStop:function(h){this.resizing=false;var j=this.options,n=this;if(this._helper){var g=this._proportionallyResizeElements,e=g.length&&(/textarea/i).test(g[0].nodeName),f=e&&c.ui.hasScroll(g[0],"left")?0:n.sizeDiff.height,l=e?0:n.sizeDiff.width;var p={width:(n.helper.width()-l),height:(n.helper.height()-f)},k=(parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left))||null,m=(parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top))||null;if(!j.animate){this.element.css(c.extend(p,{top:m,left:k}))}n.helper.height(n.size.height);n.helper.width(n.size.width);if(this._helper&&!j.animate){this._proportionallyResize()}}c("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",h);if(this._helper){this.helper.remove()}return false},_updateVirtualBoundaries:function(g){var k=this.options,j,h,f,l,e;e={minWidth:a(k.minWidth)?k.minWidth:0,maxWidth:a(k.maxWidth)?k.maxWidth:Infinity,minHeight:a(k.minHeight)?k.minHeight:0,maxHeight:a(k.maxHeight)?k.maxHeight:Infinity};if(this._aspectRatio||g){j=e.minHeight*this.aspectRatio;f=e.minWidth/this.aspectRatio;h=e.maxHeight*this.aspectRatio;l=e.maxWidth/this.aspectRatio;if(j>e.minWidth){e.minWidth=j}if(f>e.minHeight){e.minHeight=f}if(h<e.maxWidth){e.maxWidth=h}if(l<e.maxHeight){e.maxHeight=l}}this._vBoundaries=e},_updateCache:function(e){var f=this.options;this.offset=this.helper.offset();if(a(e.left)){this.position.left=e.left}if(a(e.top)){this.position.top=e.top}if(a(e.height)){this.size.height=e.height}if(a(e.width)){this.size.width=e.width}},_updateRatio:function(h,g){var j=this.options,k=this.position,f=this.size,e=this.axis;if(a(h.height)){h.width=(h.height*this.aspectRatio)}else{if(a(h.width)){h.height=(h.width/this.aspectRatio)}}if(e=="sw"){h.left=k.left+(f.width-h.width);h.top=null}if(e=="nw"){h.top=k.top+(f.height-h.height);h.left=k.left+(f.width-h.width)}return h},_respectSize:function(m,g){var k=this.helper,j=this._vBoundaries,t=this._aspectRatio||g.shiftKey,s=this.axis,v=a(m.width)&&j.maxWidth&&(j.maxWidth<m.width),n=a(m.height)&&j.maxHeight&&(j.maxHeight<m.height),h=a(m.width)&&j.minWidth&&(j.minWidth>m.width),u=a(m.height)&&j.minHeight&&(j.minHeight>m.height);if(h){m.width=j.minWidth}if(u){m.height=j.minHeight}if(v){m.width=j.maxWidth}if(n){m.height=j.maxHeight}var f=this.originalPosition.left+this.originalSize.width,q=this.position.top+this.size.height;var l=/sw|nw|w/.test(s),e=/nw|ne|n/.test(s);if(h&&l){m.left=f-j.minWidth}if(v&&l){m.left=f-j.maxWidth}if(u&&e){m.top=q-j.minHeight}if(n&&e){m.top=q-j.maxHeight}var p=!m.width&&!m.height;if(p&&!m.left&&m.top){m.top=null}else{if(p&&!m.top&&m.left){m.left=null}}return m},_proportionallyResize:function(){var k=this.options;if(!this._proportionallyResizeElements.length){return}var g=this.helper||this.element;for(var f=0;f<this._proportionallyResizeElements.length;f++){var h=this._proportionallyResizeElements[f];if(!this.borderDif){var e=[h.css("borderTopWidth"),h.css("borderRightWidth"),h.css("borderBottomWidth"),h.css("borderLeftWidth")],j=[h.css("paddingTop"),h.css("paddingRight"),h.css("paddingBottom"),h.css("paddingLeft")];this.borderDif=c.map(e,function(l,n){var m=parseInt(l,10)||0,o=parseInt(j[n],10)||0;return m+o})}if(c.browser.msie&&!(!(c(g).is(":hidden")||c(g).parents(":hidden").length))){continue}h.css({height:(g.height()-this.borderDif[0]-this.borderDif[2])||0,width:(g.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var f=this.element,j=this.options;this.elementOffset=f.offset();if(this._helper){this.helper=this.helper||c('<div style="overflow:hidden;"></div>');var e=c.browser.msie&&c.browser.version<7,g=(e?1:0),h=(e?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+h,height:this.element.outerHeight()+h,position:"absolute",left:this.elementOffset.left-g+"px",top:this.elementOffset.top-g+"px",zIndex:++j.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(g,f,e){return{width:this.originalSize.width+f}},w:function(h,f,e){var k=this.options,g=this.originalSize,j=this.originalPosition;return{left:j.left+f,width:g.width-f}},n:function(h,f,e){var k=this.options,g=this.originalSize,j=this.originalPosition;return{top:j.top+e,height:g.height-e}},s:function(g,f,e){return{height:this.originalSize.height+e}},se:function(g,f,e){return c.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[g,f,e]))},sw:function(g,f,e){return c.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[g,f,e]))},ne:function(g,f,e){return c.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[g,f,e]))},nw:function(g,f,e){return c.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[g,f,e]))}},_propagate:function(f,e){c.ui.plugin.call(this,f,[e,this.ui()]);(f!="resize"&&this._trigger(f,e,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});c.extend(c.ui.resizable,{version:"1.8.23"});c.ui.plugin.add("resizable","alsoResize",{start:function(f,g){var e=c(this).data("resizable"),j=e.options;var h=function(k){c(k).each(function(){var l=c(this);l.data("resizable-alsoresize",{width:parseInt(l.width(),10),height:parseInt(l.height(),10),left:parseInt(l.css("left"),10),top:parseInt(l.css("top"),10)})})};if(typeof(j.alsoResize)=="object"&&!j.alsoResize.parentNode){if(j.alsoResize.length){j.alsoResize=j.alsoResize[0];h(j.alsoResize)}else{c.each(j.alsoResize,function(k){h(k)})}}else{h(j.alsoResize)}},resize:function(g,j){var f=c(this).data("resizable"),k=f.options,h=f.originalSize,m=f.originalPosition;var l={height:(f.size.height-h.height)||0,width:(f.size.width-h.width)||0,top:(f.position.top-m.top)||0,left:(f.position.left-m.left)||0},e=function(n,o){c(n).each(function(){var s=c(this),t=c(this).data("resizable-alsoresize"),q={},p=o&&o.length?o:s.parents(j.originalElement[0]).length?["width","height"]:["width","height","top","left"];c.each(p,function(u,w){var v=(t[w]||0)+(l[w]||0);if(v&&v>=0){q[w]=v||null}});s.css(q)})};if(typeof(k.alsoResize)=="object"&&!k.alsoResize.nodeType){c.each(k.alsoResize,function(n,o){e(n,o)})}else{e(k.alsoResize)}},stop:function(e,f){c(this).removeData("resizable-alsoresize")}});c.ui.plugin.add("resizable","animate",{stop:function(j,p){var q=c(this).data("resizable"),k=q.options;var h=q._proportionallyResizeElements,e=h.length&&(/textarea/i).test(h[0].nodeName),f=e&&c.ui.hasScroll(h[0],"left")?0:q.sizeDiff.height,m=e?0:q.sizeDiff.width;var g={width:(q.size.width-m),height:(q.size.height-f)},l=(parseInt(q.element.css("left"),10)+(q.position.left-q.originalPosition.left))||null,n=(parseInt(q.element.css("top"),10)+(q.position.top-q.originalPosition.top))||null;q.element.animate(c.extend(g,n&&l?{top:n,left:l}:{}),{duration:k.animateDuration,easing:k.animateEasing,step:function(){var o={width:parseInt(q.element.css("width"),10),height:parseInt(q.element.css("height"),10),top:parseInt(q.element.css("top"),10),left:parseInt(q.element.css("left"),10)};if(h&&h.length){c(h[0]).css({width:o.width,height:o.height})}q._updateCache(o);q._propagate("resize",j)}})}});c.ui.plugin.add("resizable","containment",{start:function(f,t){var v=c(this).data("resizable"),k=v.options,m=v.element;var g=k.containment,l=(g instanceof c)?g.get(0):(/parent/.test(g))?m.parent().get(0):g;if(!l){return}v.containerElement=c(l);if(/document/.test(g)||g==document){v.containerOffset={left:0,top:0};v.containerPosition={left:0,top:0};v.parentData={element:c(document),left:0,top:0,width:c(document).width(),height:c(document).height()||document.body.parentNode.scrollHeight}}else{var q=c(l),j=[];c(["Top","Right","Left","Bottom"]).each(function(p,o){j[p]=b(q.css("padding"+o))});v.containerOffset=q.offset();v.containerPosition=q.position();v.containerSize={height:(q.innerHeight()-j[3]),width:(q.innerWidth()-j[1])};var s=v.containerOffset,e=v.containerSize.height,n=v.containerSize.width,h=(c.ui.hasScroll(l,"left")?l.scrollWidth:n),u=(c.ui.hasScroll(l)?l.scrollHeight:e);v.parentData={element:l,left:s.left,top:s.top,width:h,height:u}}},resize:function(g,s){var v=c(this).data("resizable"),j=v.options,f=v.containerSize,q=v.containerOffset,n=v.size,p=v.position,t=v._aspectRatio||g.shiftKey,e={top:0,left:0},h=v.containerElement;if(h[0]!=document&&(/static/).test(h.css("position"))){e=q}if(p.left<(v._helper?q.left:0)){v.size.width=v.size.width+(v._helper?(v.position.left-q.left):(v.position.left-e.left));if(t){v.size.height=v.size.width/v.aspectRatio}v.position.left=j.helper?q.left:0}if(p.top<(v._helper?q.top:0)){v.size.height=v.size.height+(v._helper?(v.position.top-q.top):v.position.top);if(t){v.size.width=v.size.height*v.aspectRatio}v.position.top=v._helper?q.top:0}v.offset.left=v.parentData.left+v.position.left;v.offset.top=v.parentData.top+v.position.top;var m=Math.abs((v._helper?v.offset.left-e.left:(v.offset.left-e.left))+v.sizeDiff.width),u=Math.abs((v._helper?v.offset.top-e.top:(v.offset.top-q.top))+v.sizeDiff.height);var l=v.containerElement.get(0)==v.element.parent().get(0),k=/relative|absolute/.test(v.containerElement.css("position"));if(l&&k){m-=v.parentData.left}if(m+v.size.width>=v.parentData.width){v.size.width=v.parentData.width-m;if(t){v.size.height=v.size.width/v.aspectRatio}}if(u+v.size.height>=v.parentData.height){v.size.height=v.parentData.height-u;if(t){v.size.width=v.size.height*v.aspectRatio}}},stop:function(f,p){var s=c(this).data("resizable"),g=s.options,m=s.position,n=s.containerOffset,e=s.containerPosition,j=s.containerElement;var k=c(s.helper),t=k.offset(),q=k.outerWidth()-s.sizeDiff.width,l=k.outerHeight()-s.sizeDiff.height;if(s._helper&&!g.animate&&(/relative/).test(j.css("position"))){c(this).css({left:t.left-e.left-n.left,width:q,height:l})}if(s._helper&&!g.animate&&(/static/).test(j.css("position"))){c(this).css({left:t.left-e.left-n.left,width:q,height:l})}}});c.ui.plugin.add("resizable","ghost",{start:function(g,h){var e=c(this).data("resizable"),j=e.options,f=e.size;e.ghost=e.originalElement.clone();e.ghost.css({opacity:0.25,display:"block",position:"relative",height:f.height,width:f.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof j.ghost=="string"?j.ghost:"");e.ghost.appendTo(e.helper)},resize:function(f,g){var e=c(this).data("resizable"),h=e.options;if(e.ghost){e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})}},stop:function(f,g){var e=c(this).data("resizable"),h=e.options;if(e.ghost&&e.helper){e.helper.get(0).removeChild(e.ghost.get(0))}}});c.ui.plugin.add("resizable","grid",{resize:function(e,n){var q=c(this).data("resizable"),h=q.options,l=q.size,j=q.originalSize,k=q.originalPosition,p=q.axis,m=h._aspectRatio||e.shiftKey;h.grid=typeof h.grid=="number"?[h.grid,h.grid]:h.grid;var g=Math.round((l.width-j.width)/(h.grid[0]||1))*(h.grid[0]||1),f=Math.round((l.height-j.height)/(h.grid[1]||1))*(h.grid[1]||1);if(/^(se|s|e)$/.test(p)){q.size.width=j.width+g;q.size.height=j.height+f}else{if(/^(ne)$/.test(p)){q.size.width=j.width+g;q.size.height=j.height+f;q.position.top=k.top-f}else{if(/^(sw)$/.test(p)){q.size.width=j.width+g;q.size.height=j.height+f;q.position.left=k.left-g}else{q.size.width=j.width+g;q.size.height=j.height+f;q.position.top=k.top-f;q.position.left=k.left-g}}}}});var b=function(e){return parseInt(e,10)||0};var a=function(e){return !isNaN(parseInt(e,10))}})(jQuery);
/*!
 * jQuery UI Sortable 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Sortables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){var c=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?c.axis==="x"||(/left|right/).test(this.items[0].item.css("float"))||(/inline|table-cell/).test(this.items[0].item.css("display")):false;this.offset=this.element.offset();this._mouseInit();this.ready=true},destroy:function(){a.Widget.prototype.destroy.call(this);this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var c=this.items.length-1;c>=0;c--){this.items[c].item.removeData(this.widgetName+"-item")}return this},_setOption:function(c,d){if(c==="disabled"){this.options[c]=d;this.widget()[d?"addClass":"removeClass"]("ui-sortable-disabled")}else{a.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(g,h){var f=this;if(this.reverting){return false}if(this.options.disabled||this.options.type=="static"){return false}this._refreshItems(g);var e=null,d=this,c=a(g.target).parents().each(function(){if(a.data(this,f.widgetName+"-item")==d){e=a(this);return false}});if(a.data(g.target,f.widgetName+"-item")==d){e=a(g.target)}if(!e){return false}if(this.options.handle&&!h){var j=false;a(this.options.handle,e).find("*").andSelf().each(function(){if(this==g.target){j=true}});if(!j){return false}}this.currentItem=e;this._removeCurrentsFromItems();return true},_mouseStart:function(f,g,c){var h=this.options,d=this;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(f);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:f.pageX-this.offset.left,top:f.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(f);this.originalPageX=f.pageX;this.originalPageY=f.pageY;(h.cursorAt&&this._adjustOffsetFromHelper(h.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!=this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(h.containment){this._setContainment()}if(h.cursor){if(a("body").css("cursor")){this._storedCursor=a("body").css("cursor")}a("body").css("cursor",h.cursor)}if(h.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",h.opacity)}if(h.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",h.zIndex)}if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",f,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!c){for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("activate",f,d._uiHash(this))}}if(a.ui.ddmanager){a.ui.ddmanager.current=this}if(a.ui.ddmanager&&!h.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,f)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(f);return true},_mouseDrag:function(g){this.position=this._generatePosition(g);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){var h=this.options,c=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-g.pageY<h.scrollSensitivity){this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop+h.scrollSpeed}else{if(g.pageY-this.overflowOffset.top<h.scrollSensitivity){this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop-h.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-g.pageX<h.scrollSensitivity){this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft+h.scrollSpeed}else{if(g.pageX-this.overflowOffset.left<h.scrollSensitivity){this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft-h.scrollSpeed}}}else{if(g.pageY-a(document).scrollTop()<h.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()-h.scrollSpeed)}else{if(a(window).height()-(g.pageY-a(document).scrollTop())<h.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()+h.scrollSpeed)}}if(g.pageX-a(document).scrollLeft()<h.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()-h.scrollSpeed)}else{if(a(window).width()-(g.pageX-a(document).scrollLeft())<h.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()+h.scrollSpeed)}}}if(c!==false&&a.ui.ddmanager&&!h.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,g)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}for(var e=this.items.length-1;e>=0;e--){var f=this.items[e],d=f.item[0],j=this._intersectsWithPointer(f);if(!j){continue}if(d!=this.currentItem[0]&&this.placeholder[j==1?"next":"prev"]()[0]!=d&&!a.ui.contains(this.placeholder[0],d)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],d):true)){this.direction=j==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(f)){this._rearrange(g,f)}else{break}this._trigger("change",g,this._uiHash());break}}this._contactContainers(g);if(a.ui.ddmanager){a.ui.ddmanager.drag(this,g)}this._trigger("sort",g,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(d,e){if(!d){return}if(a.ui.ddmanager&&!this.options.dropBehaviour){a.ui.ddmanager.drop(this,d)}if(this.options.revert){var c=this;var f=c.placeholder.offset();c.reverting=true;a(this.helper).animate({left:f.left-this.offset.parent.left-c.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:f.top-this.offset.parent.top-c.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){c._clear(d)})}else{this._clear(d,e)}return false},cancel:function(){var c=this;if(this.dragging){this._mouseUp({target:null});if(this.options.helper=="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var d=this.containers.length-1;d>=0;d--){this.containers[d]._trigger("deactivate",null,c._uiHash(this));if(this.containers[d].containerCache.over){this.containers[d]._trigger("out",null,c._uiHash(this));this.containers[d].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}a.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){a(this.domPosition.prev).after(this.currentItem)}else{a(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(e){var c=this._getItemsAsjQuery(e&&e.connected);var d=[];e=e||{};a(c).each(function(){var f=(a(e.item||this).attr(e.attribute||"id")||"").match(e.expression||(/(.+)[-=_](.+)/));if(f){d.push((e.key||f[1]+"[]")+"="+(e.key&&e.expression?f[1]:f[2]))}});if(!d.length&&e.key){d.push(e.key+"=")}return d.join("&")},toArray:function(e){var c=this._getItemsAsjQuery(e&&e.connected);var d=[];e=e||{};c.each(function(){d.push(a(e.item||this).attr(e.attribute||"id")||"")});return d},_intersectsWith:function(n){var e=this.positionAbs.left,d=e+this.helperProportions.width,m=this.positionAbs.top,k=m+this.helperProportions.height;var f=n.left,c=f+n.width,o=n.top,j=o+n.height;var p=this.offset.click.top,h=this.offset.click.left;var g=(m+p)>o&&(m+p)<j&&(e+h)>f&&(e+h)<c;if(this.options.tolerance=="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>n[this.floating?"width":"height"])){return g}else{return(f<e+(this.helperProportions.width/2)&&d-(this.helperProportions.width/2)<c&&o<m+(this.helperProportions.height/2)&&k-(this.helperProportions.height/2)<j)}},_intersectsWithPointer:function(e){var f=(this.options.axis==="x")||a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),d=(this.options.axis==="y")||a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),h=f&&d,c=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();if(!h){return false}return this.floating?(((g&&g=="right")||c=="down")?2:1):(c&&(c=="down"?2:1))},_intersectsWithSides:function(f){var d=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,f.top+(f.height/2),f.height),e=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,f.left+(f.width/2),f.width),c=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();if(this.floating&&g){return((g=="right"&&e)||(g=="left"&&!e))}else{return c&&((c=="down"&&d)||(c=="up"&&!d))}},_getDragVerticalDirection:function(){var c=this.positionAbs.top-this.lastPositionAbs.top;return c!=0&&(c>0?"down":"up")},_getDragHorizontalDirection:function(){var c=this.positionAbs.left-this.lastPositionAbs.left;return c!=0&&(c>0?"right":"left")},refresh:function(c){this._refreshItems(c);this.refreshPositions();return this},_connectWith:function(){var c=this.options;return c.connectWith.constructor==String?[c.connectWith]:c.connectWith},_getItemsAsjQuery:function(c){var m=this;var h=[];var f=[];var k=this._connectWith();if(k&&c){for(var e=k.length-1;e>=0;e--){var l=a(k[e]);for(var d=l.length-1;d>=0;d--){var g=a.data(l[d],this.widgetName);if(g&&g!=this&&!g.options.disabled){f.push([a.isFunction(g.options.items)?g.options.items.call(g.element):a(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g])}}}}f.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var e=f.length-1;e>=0;e--){f[e][0].each(function(){h.push(this)})}return a(h)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");for(var d=0;d<this.items.length;d++){for(var c=0;c<e.length;c++){if(e[c]==this.items[d].item[0]){this.items.splice(d,1)}}}},_refreshItems:function(c){this.items=[];this.containers=[this];var k=this.items;var q=this;var g=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],c,{item:this.currentItem}):a(this.options.items,this.element),this]];var m=this._connectWith();if(m&&this.ready){for(var f=m.length-1;f>=0;f--){var n=a(m[f]);for(var e=n.length-1;e>=0;e--){var h=a.data(n[e],this.widgetName);if(h&&h!=this&&!h.options.disabled){g.push([a.isFunction(h.options.items)?h.options.items.call(h.element[0],c,{item:this.currentItem}):a(h.options.items,h.element),h]);this.containers.push(h)}}}}for(var f=g.length-1;f>=0;f--){var l=g[f][1];var d=g[f][0];for(var e=0,o=d.length;e<o;e++){var p=a(d[e]);p.data(this.widgetName+"-item",l);k.push({item:p,instance:l,width:0,height:0,left:0,top:0})}}},refreshPositions:function(c){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}for(var e=this.items.length-1;e>=0;e--){var f=this.items[e];if(f.instance!=this.currentContainer&&this.currentContainer&&f.item[0]!=this.currentItem[0]){continue}var d=this.options.toleranceElement?a(this.options.toleranceElement,f.item):f.item;if(!c){f.width=d.outerWidth();f.height=d.outerHeight()}var g=d.offset();f.left=g.left;f.top=g.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var e=this.containers.length-1;e>=0;e--){var g=this.containers[e].element.offset();this.containers[e].containerCache.left=g.left;this.containers[e].containerCache.top=g.top;this.containers[e].containerCache.width=this.containers[e].element.outerWidth();this.containers[e].containerCache.height=this.containers[e].element.outerHeight()}}return this},_createPlaceholder:function(e){var c=e||this,f=c.options;if(!f.placeholder||f.placeholder.constructor==String){var d=f.placeholder;f.placeholder={element:function(){var g=a(document.createElement(c.currentItem[0].nodeName)).addClass(d||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!d){g.style.visibility="hidden"}return g},update:function(g,h){if(d&&!f.forcePlaceholderSize){return}if(!h.height()){h.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10))}if(!h.width()){h.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}}c.placeholder=a(f.placeholder.element.call(c.element,c.currentItem));c.currentItem.after(c.placeholder);f.placeholder.update(c,c.placeholder)},_contactContainers:function(c){var e=null,l=null;for(var g=this.containers.length-1;g>=0;g--){if(a.ui.contains(this.currentItem[0],this.containers[g].element[0])){continue}if(this._intersectsWith(this.containers[g].containerCache)){if(e&&a.ui.contains(this.containers[g].element[0],e.element[0])){continue}e=this.containers[g];l=g}else{if(this.containers[g].containerCache.over){this.containers[g]._trigger("out",c,this._uiHash(this));this.containers[g].containerCache.over=0}}}if(!e){return}if(this.containers.length===1){this.containers[l]._trigger("over",c,this._uiHash(this));this.containers[l].containerCache.over=1}else{if(this.currentContainer!=this.containers[l]){var k=10000;var h=null;var d=this.positionAbs[this.containers[l].floating?"left":"top"];for(var f=this.items.length-1;f>=0;f--){if(!a.ui.contains(this.containers[l].element[0],this.items[f].item[0])){continue}var m=this.containers[l].floating?this.items[f].item.offset().left:this.items[f].item.offset().top;if(Math.abs(m-d)<k){k=Math.abs(m-d);h=this.items[f];this.direction=(m-d>0)?"down":"up"}}if(!h&&!this.options.dropOnEmpty){return}this.currentContainer=this.containers[l];h?this._rearrange(c,h,null,true):this._rearrange(c,null,this.containers[l].element,true);this._trigger("change",c,this._uiHash());this.containers[l]._trigger("change",c,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[l]._trigger("over",c,this._uiHash(this));this.containers[l].containerCache.over=1}}},_createHelper:function(d){var e=this.options;var c=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[d,this.currentItem])):(e.helper=="clone"?this.currentItem.clone():this.currentItem);if(!c.parents("body").length){a(e.appendTo!="parent"?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(c[0])}if(c[0]==this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(c[0].style.width==""||e.forceHelperSize){c.width(this.currentItem.width())}if(c[0].style.height==""||e.forceHelperSize){c.height(this.currentItem.height())}return c},_adjustOffsetFromHelper:function(c){if(typeof c=="string"){c=c.split(" ")}if(a.isArray(c)){c={left:+c[0],top:+c[1]||0}}if("left" in c){this.offset.click.left=c.left+this.margins.left}if("right" in c){this.offset.click.left=this.helperProportions.width-c.right+this.margins.left}if("top" in c){this.offset.click.top=c.top+this.margins.top}if("bottom" in c){this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){c.left+=this.scrollParent.scrollLeft();c.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)){c={top:0,left:0}}return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var c=this.currentItem.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var f=this.options;if(f.containment=="parent"){f.containment=this.helper[0].parentNode}if(f.containment=="document"||f.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(f.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(f.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(f.containment)){var d=a(f.containment)[0];var e=a(f.containment).offset();var c=(a(d).css("overflow")!="hidden");this.containment=[e.left+(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0)-this.margins.top,e.left+(c?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(c?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(g,j){if(!j){j=this.position}var e=g=="absolute"?1:-1;var f=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,h=(/(html|body)/i).test(c[0].tagName);return{top:(j.top+this.offset.relative.top*e+this.offset.parent.top*e-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(h?0:c.scrollTop()))*e)),left:(j.left+this.offset.relative.left*e+this.offset.parent.left*e-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():h?0:c.scrollLeft())*e))}},_generatePosition:function(f){var j=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,k=(/(html|body)/i).test(c[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}var e=f.pageX;var d=f.pageY;if(this.originalPosition){if(this.containment){if(f.pageX-this.offset.click.left<this.containment[0]){e=this.containment[0]+this.offset.click.left}if(f.pageY-this.offset.click.top<this.containment[1]){d=this.containment[1]+this.offset.click.top}if(f.pageX-this.offset.click.left>this.containment[2]){e=this.containment[2]+this.offset.click.left}if(f.pageY-this.offset.click.top>this.containment[3]){d=this.containment[3]+this.offset.click.top}}if(j.grid){var h=this.originalPageY+Math.round((d-this.originalPageY)/j.grid[1])*j.grid[1];d=this.containment?(!(h-this.offset.click.top<this.containment[1]||h-this.offset.click.top>this.containment[3])?h:(!(h-this.offset.click.top<this.containment[1])?h-j.grid[1]:h+j.grid[1])):h;var g=this.originalPageX+Math.round((e-this.originalPageX)/j.grid[0])*j.grid[0];e=this.containment?(!(g-this.offset.click.left<this.containment[0]||g-this.offset.click.left>this.containment[2])?g:(!(g-this.offset.click.left<this.containment[0])?g-j.grid[0]:g+j.grid[0])):g}}return{top:(d-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(k?0:c.scrollTop())))),left:(e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():k?0:c.scrollLeft())))}},_rearrange:function(h,g,d,f){d?d[0].appendChild(this.placeholder[0]):g.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction=="down"?g.item[0]:g.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var e=this,c=this.counter;window.setTimeout(function(){if(c==e.counter){e.refreshPositions(!f)}},0)},_clear:function(e,f){this.reverting=false;var g=[],c=this;if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var d in this._storedCSS){if(this._storedCSS[d]=="auto"||this._storedCSS[d]=="static"){this._storedCSS[d]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!f){g.push(function(h){this._trigger("receive",h,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!f){g.push(function(h){this._trigger("update",h,this._uiHash())})}if(!a.ui.contains(this.element[0],this.currentItem[0])){if(!f){g.push(function(h){this._trigger("remove",h,this._uiHash())})}for(var d=this.containers.length-1;d>=0;d--){if(a.ui.contains(this.containers[d].element[0],this.currentItem[0])&&!f){g.push((function(h){return function(j){h._trigger("receive",j,this._uiHash(this))}}).call(this,this.containers[d]));g.push((function(h){return function(j){h._trigger("update",j,this._uiHash(this))}}).call(this,this.containers[d]))}}}for(var d=this.containers.length-1;d>=0;d--){if(!f){g.push((function(h){return function(j){h._trigger("deactivate",j,this._uiHash(this))}}).call(this,this.containers[d]))}if(this.containers[d].containerCache.over){g.push((function(h){return function(j){h._trigger("out",j,this._uiHash(this))}}).call(this,this.containers[d]));this.containers[d].containerCache.over=0}}if(this._storedCursor){a("body").css("cursor",this._storedCursor)}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!f){this._trigger("beforeStop",e,this._uiHash());for(var d=0;d<g.length;d++){g[d].call(this,e)}this._trigger("stop",e,this._uiHash())}this.fromOutside=false;return false}if(!f){this._trigger("beforeStop",e,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!=this.currentItem[0]){this.helper.remove()}this.helper=null;if(!f){for(var d=0;d<g.length;d++){g[d].call(this,e)}this._trigger("stop",e,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if(a.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(d){var c=d||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:d?d.element:null}}});a.extend(a.ui.sortable,{version:"1.8.23"})})(jQuery);
/*!
 * jQuery UI Accordion 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Accordion
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var c=this,d=c.options;c.running=0;c.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix");c.headers=c.element.find(d.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){if(d.disabled){return}a(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){if(d.disabled){return}a(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){if(d.disabled){return}a(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){if(d.disabled){return}a(this).removeClass("ui-state-focus")});c.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(d.navigation){var e=c.element.find("a").filter(d.navigationFilter).eq(0);if(e.length){var f=e.closest(".ui-accordion-header");if(f.length){c.active=f}else{c.active=e.closest(".ui-accordion-content").prev()}}}c.active=c._findActive(c.active||d.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");c.active.next().addClass("ui-accordion-content-active");c._createIcons();c.resize();c.element.attr("role","tablist");c.headers.attr("role","tab").bind("keydown.accordion",function(g){return c._keydown(g)}).next().attr("role","tabpanel");c.headers.not(c.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();if(!c.active.length){c.headers.eq(0).attr("tabIndex",0)}else{c.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0})}if(!a.browser.safari){c.headers.find("a").attr("tabIndex",-1)}if(d.event){c.headers.bind(d.event.split(" ").join(".accordion ")+".accordion",function(g){c._clickHandler.call(c,g,this);g.preventDefault()})}},_createIcons:function(){var c=this.options;if(c.icons){a("<span></span>").addClass("ui-icon "+c.icons.header).prependTo(this.headers);this.active.children(".ui-icon").toggleClass(c.icons.header).toggleClass(c.icons.headerSelected);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-icon").remove();this.element.removeClass("ui-accordion-icons")},destroy:function(){var c=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex");this.headers.find("a").removeAttr("tabIndex");this._destroyIcons();var d=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");if(c.autoHeight||c.fillHeight){d.css("height","")}return a.Widget.prototype.destroy.call(this)},_setOption:function(c,d){a.Widget.prototype._setOption.apply(this,arguments);if(c=="active"){this.activate(d)}if(c=="icons"){this._destroyIcons();if(d){this._createIcons()}}if(c=="disabled"){this.headers.add(this.headers.next())[d?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")}},_keydown:function(f){if(this.options.disabled||f.altKey||f.ctrlKey){return}var g=a.ui.keyCode,e=this.headers.length,c=this.headers.index(f.target),d=false;switch(f.keyCode){case g.RIGHT:case g.DOWN:d=this.headers[(c+1)%e];break;case g.LEFT:case g.UP:d=this.headers[(c-1+e)%e];break;case g.SPACE:case g.ENTER:this._clickHandler({target:f.target},f.target);f.preventDefault()}if(d){a(f.target).attr("tabIndex",-1);a(d).attr("tabIndex",0);d.focus();return false}return true},resize:function(){var c=this.options,e;if(c.fillSpace){if(a.browser.msie){var d=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}e=this.element.parent().height();if(a.browser.msie){this.element.parent().css("overflow",d)}this.headers.each(function(){e-=a(this).outerHeight(true)});this.headers.next().each(function(){a(this).height(Math.max(0,e-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else{if(c.autoHeight){e=0;this.headers.next().each(function(){e=Math.max(e,a(this).height("").height())}).height(e)}}return this},activate:function(c){this.options.active=c;var d=this._findActive(c)[0];this._clickHandler({target:d},d);return this},_findActive:function(c){return c?typeof c==="number"?this.headers.filter(":eq("+c+")"):this.headers.not(this.headers.not(c)):c===false?a([]):this.headers.filter(":eq(0)")},_clickHandler:function(c,g){var m=this.options;if(m.disabled){return}if(!c.target){if(!m.collapsible){return}this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(m.icons.headerSelected).addClass(m.icons.header);this.active.next().addClass("ui-accordion-content-active");var j=this.active.next(),f={options:m,newHeader:a([]),oldHeader:m.active,newContent:a([]),oldContent:j},d=(this.active=a([]));this._toggle(d,j,f);return}var h=a(c.currentTarget||g),k=h[0]===this.active[0];m.active=m.collapsible&&k?false:this.headers.index(h);if(this.running||(!m.collapsible&&k)){return}var e=this.active,d=h.next(),j=this.active.next(),f={options:m,newHeader:k&&m.collapsible?a([]):h,oldHeader:this.active,newContent:k&&m.collapsible?a([]):d,oldContent:j},l=this.headers.index(this.active[0])>this.headers.index(h[0]);this.active=k?a([]):h;this._toggle(d,j,f,k,l);e.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(m.icons.headerSelected).addClass(m.icons.header);if(!k){h.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(m.icons.header).addClass(m.icons.headerSelected);h.next().addClass("ui-accordion-content-active")}return},_toggle:function(c,j,g,k,l){var n=this,o=n.options;n.toShow=c;n.toHide=j;n.data=g;var d=function(){if(!n){return}return n._completed.apply(n,arguments)};n._trigger("changestart",null,n.data);n.running=j.size()===0?c.size():j.size();if(o.animated){var f={};if(o.collapsible&&k){f={toShow:a([]),toHide:j,complete:d,down:l,autoHeight:o.autoHeight||o.fillSpace}}else{f={toShow:c,toHide:j,complete:d,down:l,autoHeight:o.autoHeight||o.fillSpace}}if(!o.proxied){o.proxied=o.animated}if(!o.proxiedDuration){o.proxiedDuration=o.duration}o.animated=a.isFunction(o.proxied)?o.proxied(f):o.proxied;o.duration=a.isFunction(o.proxiedDuration)?o.proxiedDuration(f):o.proxiedDuration;var m=a.ui.accordion.animations,e=o.duration,h=o.animated;if(h&&!m[h]&&!a.easing[h]){h="slide"}if(!m[h]){m[h]=function(p){this.slide(p,{easing:h,duration:e||700})}}m[h](f)}else{if(o.collapsible&&k){c.toggle()}else{j.hide();c.show()}d(true)}j.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur();c.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(c){this.running=c?0:--this.running;if(this.running){return}if(this.options.clearStyle){this.toShow.add(this.toHide).css({height:"",overflow:""})}this.toHide.removeClass("ui-accordion-content-active");if(this.toHide.length){this.toHide.parent()[0].className=this.toHide.parent()[0].className}this._trigger("change",null,this.data)}});a.extend(a.ui.accordion,{version:"1.8.23",animations:{slide:function(l,j){l=a.extend({easing:"swing",duration:300},l,j);if(!l.toHide.size()){l.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},l);return}if(!l.toShow.size()){l.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},l);return}var d=l.toShow.css("overflow"),h=0,e={},g={},f=["height","paddingTop","paddingBottom"],c;var k=l.toShow;c=k[0].style.width;k.width(k.parent().width()-parseFloat(k.css("paddingLeft"))-parseFloat(k.css("paddingRight"))-(parseFloat(k.css("borderLeftWidth"))||0)-(parseFloat(k.css("borderRightWidth"))||0));a.each(f,function(m,o){g[o]="hide";var n=(""+a.css(l.toShow[0],o)).match(/^([\d+-.]+)(.*)$/);e[o]={value:n[1],unit:n[2]||"px"}});l.toShow.css({height:0,overflow:"hidden"}).show();l.toHide.filter(":hidden").each(l.complete).end().filter(":visible").animate(g,{step:function(m,n){if(n.prop=="height"){h=(n.end-n.start===0)?0:(n.now-n.start)/(n.end-n.start)}l.toShow[0].style[n.prop]=(h*e[n.prop].value)+e[n.prop].unit},duration:l.duration,easing:l.easing,complete:function(){if(!l.autoHeight){l.toShow.css("height","")}l.toShow.css({width:c,overflow:d});l.complete()}})},bounceslide:function(c){this.slide(c,{easing:c.down?"easeOutBounce":"swing",duration:c.down?1000:200})}}})})(jQuery);
/*!
 * jQuery UI Slider 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Slider
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(b,c){var a=5;b.widget("ui.slider",b.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var e=this,k=this.options,j=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),h="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",d=(k.values&&k.values.length)||1,g=[];this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(k.disabled?" ui-slider-disabled ui-disabled":""));this.range=b([]);if(k.range){if(k.range===true){if(!k.values){k.values=[this._valueMin(),this._valueMin()]}if(k.values.length&&k.values.length!==2){k.values=[k.values[0],k.values[0]]}}this.range=b("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+((k.range==="min"||k.range==="max")?" ui-slider-range-"+k.range:""))}for(var f=j.length;f<d;f+=1){g.push(h)}this.handles=j.add(b(g.join("")).appendTo(e.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(l){l.preventDefault()}).hover(function(){if(!k.disabled){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")}).focus(function(){if(!k.disabled){b(".ui-slider .ui-state-focus").removeClass("ui-state-focus");b(this).addClass("ui-state-focus")}else{b(this).blur()}}).blur(function(){b(this).removeClass("ui-state-focus")});this.handles.each(function(l){b(this).data("index.ui-slider-handle",l)});this.handles.keydown(function(p){var m=b(this).data("index.ui-slider-handle"),q,n,l,o;if(e.options.disabled){return}switch(p.keyCode){case b.ui.keyCode.HOME:case b.ui.keyCode.END:case b.ui.keyCode.PAGE_UP:case b.ui.keyCode.PAGE_DOWN:case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:p.preventDefault();if(!e._keySliding){e._keySliding=true;b(this).addClass("ui-state-active");q=e._start(p,m);if(q===false){return}}break}o=e.options.step;if(e.options.values&&e.options.values.length){n=l=e.values(m)}else{n=l=e.value()}switch(p.keyCode){case b.ui.keyCode.HOME:l=e._valueMin();break;case b.ui.keyCode.END:l=e._valueMax();break;case b.ui.keyCode.PAGE_UP:l=e._trimAlignValue(n+((e._valueMax()-e._valueMin())/a));break;case b.ui.keyCode.PAGE_DOWN:l=e._trimAlignValue(n-((e._valueMax()-e._valueMin())/a));break;case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:if(n===e._valueMax()){return}l=e._trimAlignValue(n+o);break;case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(n===e._valueMin()){return}l=e._trimAlignValue(n-o);break}e._slide(p,m,l)}).keyup(function(m){var l=b(this).data("index.ui-slider-handle");if(e._keySliding){e._keySliding=false;e._stop(m,l);e._change(m,l);b(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},_mouseCapture:function(f){var g=this.options,k,m,e,h,p,l,n,j,d;if(g.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();k={x:f.pageX,y:f.pageY};m=this._normValueFromMouse(k);e=this._valueMax()-this._valueMin()+1;p=this;this.handles.each(function(o){var q=Math.abs(m-p.values(o));if(e>q){e=q;h=b(this);l=o}});if(g.range===true&&this.values(1)===g.min){l+=1;h=b(this.handles[l])}n=this._start(f,l);if(n===false){return false}this._mouseSliding=true;p._handleIndex=l;h.addClass("ui-state-active").focus();j=h.offset();d=!b(f.target).parents().andSelf().is(".ui-slider-handle");this._clickOffset=d?{left:0,top:0}:{left:f.pageX-j.left-(h.width()/2),top:f.pageY-j.top-(h.height()/2)-(parseInt(h.css("borderTopWidth"),10)||0)-(parseInt(h.css("borderBottomWidth"),10)||0)+(parseInt(h.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(f,l,m)}this._animateOff=true;return true},_mouseStart:function(d){return true},_mouseDrag:function(f){var d={x:f.pageX,y:f.pageY},e=this._normValueFromMouse(d);this._slide(f,this._handleIndex,e);return false},_mouseStop:function(d){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(d,this._handleIndex);this._change(d,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal"},_normValueFromMouse:function(e){var d,h,g,f,j;if(this.orientation==="horizontal"){d=this.elementSize.width;h=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{d=this.elementSize.height;h=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}g=(h/d);if(g>1){g=1}if(g<0){g=0}if(this.orientation==="vertical"){g=1-g}f=this._valueMax()-this._valueMin();j=this._valueMin()+g*f;return this._trimAlignValue(j)},_start:function(f,e){var d={handle:this.handles[e],value:this.value()};if(this.options.values&&this.options.values.length){d.value=this.values(e);d.values=this.values()}return this._trigger("start",f,d)},_slide:function(h,g,f){var d,e,j;if(this.options.values&&this.options.values.length){d=this.values(g?0:1);if((this.options.values.length===2&&this.options.range===true)&&((g===0&&f>d)||(g===1&&f<d))){f=d}if(f!==this.values(g)){e=this.values();e[g]=f;j=this._trigger("slide",h,{handle:this.handles[g],value:f,values:e});d=this.values(g?0:1);if(j!==false){this.values(g,f,true)}}}else{if(f!==this.value()){j=this._trigger("slide",h,{handle:this.handles[g],value:f});if(j!==false){this.value(f)}}}},_stop:function(f,e){var d={handle:this.handles[e],value:this.value()};if(this.options.values&&this.options.values.length){d.value=this.values(e);d.values=this.values()}this._trigger("stop",f,d)},_change:function(f,e){if(!this._keySliding&&!this._mouseSliding){var d={handle:this.handles[e],value:this.value()};if(this.options.values&&this.options.values.length){d.value=this.values(e);d.values=this.values()}this._trigger("change",f,d)}},value:function(d){if(arguments.length){this.options.value=this._trimAlignValue(d);this._refreshValue();this._change(null,0);return}return this._value()},values:function(e,h){var g,d,f;if(arguments.length>1){this.options.values[e]=this._trimAlignValue(h);this._refreshValue();this._change(null,e);return}if(arguments.length){if(b.isArray(arguments[0])){g=this.options.values;d=arguments[0];for(f=0;f<g.length;f+=1){g[f]=this._trimAlignValue(d[f]);this._change(null,f)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(e)}else{return this.value()}}}else{return this._values()}},_setOption:function(e,f){var d,g=0;if(b.isArray(this.options.values)){g=this.options.values.length}b.Widget.prototype._setOption.apply(this,arguments);switch(e){case"disabled":if(f){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.propAttr("disabled",true);this.element.addClass("ui-disabled")}else{this.handles.propAttr("disabled",false);this.element.removeClass("ui-disabled")}break;case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(d=0;d<g;d+=1){this._change(null,d)}this._animateOff=false;break}},_value:function(){var d=this.options.value;d=this._trimAlignValue(d);return d},_values:function(d){var g,f,e;if(arguments.length){g=this.options.values[d];g=this._trimAlignValue(g);return g}else{f=this.options.values.slice();for(e=0;e<f.length;e+=1){f[e]=this._trimAlignValue(f[e])}return f}},_trimAlignValue:function(g){if(g<=this._valueMin()){return this._valueMin()}if(g>=this._valueMax()){return this._valueMax()}var d=(this.options.step>0)?this.options.step:1,f=(g-this._valueMin())%d,e=g-f;if(Math.abs(f)*2>=d){e+=(f>0)?d:(-d)}return parseFloat(e.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var g=this.options.range,f=this.options,n=this,e=(!this._animateOff)?f.animate:false,h,d={},j,l,k,m;if(this.options.values&&this.options.values.length){this.handles.each(function(p,o){h=(n.values(p)-n._valueMin())/(n._valueMax()-n._valueMin())*100;d[n.orientation==="horizontal"?"left":"bottom"]=h+"%";b(this).stop(1,1)[e?"animate":"css"](d,f.animate);if(n.options.range===true){if(n.orientation==="horizontal"){if(p===0){n.range.stop(1,1)[e?"animate":"css"]({left:h+"%"},f.animate)}if(p===1){n.range[e?"animate":"css"]({width:(h-j)+"%"},{queue:false,duration:f.animate})}}else{if(p===0){n.range.stop(1,1)[e?"animate":"css"]({bottom:(h)+"%"},f.animate)}if(p===1){n.range[e?"animate":"css"]({height:(h-j)+"%"},{queue:false,duration:f.animate})}}}j=h})}else{l=this.value();k=this._valueMin();m=this._valueMax();h=(m!==k)?(l-k)/(m-k)*100:0;d[n.orientation==="horizontal"?"left":"bottom"]=h+"%";this.handle.stop(1,1)[e?"animate":"css"](d,f.animate);if(g==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[e?"animate":"css"]({width:h+"%"},f.animate)}if(g==="max"&&this.orientation==="horizontal"){this.range[e?"animate":"css"]({width:(100-h)+"%"},{queue:false,duration:f.animate})}if(g==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[e?"animate":"css"]({height:h+"%"},f.animate)}if(g==="max"&&this.orientation==="vertical"){this.range[e?"animate":"css"]({height:(100-h)+"%"},{queue:false,duration:f.animate})}}}});b.extend(b.ui.slider,{version:"1.8.23"})}(jQuery));
/*!
 * jQuery UI Tabs 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Tabs
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(d,f){var c=0,b=0;function e(){return ++c}function a(){return ++b}d.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(true)},_setOption:function(g,h){if(g=="selected"){if(this.options.collapsible&&h==this.options.selected){return}this.select(h)}else{this.options[g]=h;this._tabify()}},_tabId:function(g){return g.title&&g.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+e()},_sanitizeSelector:function(g){return g.replace(/:/g,"\\:")},_cookie:function(){var g=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+a());return d.cookie.apply(null,[g].concat(d.makeArray(arguments)))},_ui:function(h,g){return{tab:h,panel:g,index:this.anchors.index(h)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var g=d(this);g.html(g.data("label.tabs")).removeData("label.tabs")})},_tabify:function(u){var v=this,j=this.options,h=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=d(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return d("a",this)[0]});this.panels=d([]);this.anchors.each(function(x,o){var w=d(o).attr("href");var y=w.split("#")[0],z;if(y&&(y===location.toString().split("#")[0]||(z=d("base")[0])&&y===z.href)){w=o.hash;o.href=w}if(h.test(w)){v.panels=v.panels.add(v.element.find(v._sanitizeSelector(w)))}else{if(w&&w!=="#"){d.data(o,"href.tabs",w);d.data(o,"load.tabs",w.replace(/#.*$/,""));var B=v._tabId(o);o.href="#"+B;var A=v.element.find("#"+B);if(!A.length){A=d(j.panelTemplate).attr("id",B).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(v.panels[x-1]||v.list);A.data("destroy.tabs",true)}v.panels=v.panels.add(A)}else{j.disabled.push(x)}}});if(u){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(j.selected===f){if(location.hash){this.anchors.each(function(w,o){if(o.hash==location.hash){j.selected=w;return false}})}if(typeof j.selected!=="number"&&j.cookie){j.selected=parseInt(v._cookie(),10)}if(typeof j.selected!=="number"&&this.lis.filter(".ui-tabs-selected").length){j.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}j.selected=j.selected||(this.lis.length?0:-1)}else{if(j.selected===null){j.selected=-1}}j.selected=((j.selected>=0&&this.anchors[j.selected])||j.selected<0)?j.selected:0;j.disabled=d.unique(j.disabled.concat(d.map(this.lis.filter(".ui-state-disabled"),function(w,o){return v.lis.index(w)}))).sort();if(d.inArray(j.selected,j.disabled)!=-1){j.disabled.splice(d.inArray(j.selected,j.disabled),1)}this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");if(j.selected>=0&&this.anchors.length){v.element.find(v._sanitizeSelector(v.anchors[j.selected].hash)).removeClass("ui-tabs-hide");this.lis.eq(j.selected).addClass("ui-tabs-selected ui-state-active");v.element.queue("tabs",function(){v._trigger("show",null,v._ui(v.anchors[j.selected],v.element.find(v._sanitizeSelector(v.anchors[j.selected].hash))[0]))});this.load(j.selected)}d(window).bind("unload",function(){v.lis.add(v.anchors).unbind(".tabs");v.lis=v.anchors=v.panels=null})}else{j.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}this.element[j.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");if(j.cookie){this._cookie(j.selected,j.cookie)}for(var m=0,t;(t=this.lis[m]);m++){d(t)[d.inArray(m,j.disabled)!=-1&&!d(t).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled")}if(j.cache===false){this.anchors.removeData("cache.tabs")}this.lis.add(this.anchors).unbind(".tabs");if(j.event!=="mouseover"){var l=function(w,o){if(o.is(":not(.ui-state-disabled)")){o.addClass("ui-state-"+w)}};var p=function(w,o){o.removeClass("ui-state-"+w)};this.lis.bind("mouseover.tabs",function(){l("hover",d(this))});this.lis.bind("mouseout.tabs",function(){p("hover",d(this))});this.anchors.bind("focus.tabs",function(){l("focus",d(this).closest("li"))});this.anchors.bind("blur.tabs",function(){p("focus",d(this).closest("li"))})}var g,n;if(j.fx){if(d.isArray(j.fx)){g=j.fx[0];n=j.fx[1]}else{g=n=j.fx}}function k(o,w){o.css("display","");if(!d.support.opacity&&w.opacity){o[0].style.removeAttribute("filter")}}var q=n?function(o,w){d(o).closest("li").addClass("ui-tabs-selected ui-state-active");w.hide().removeClass("ui-tabs-hide").animate(n,n.duration||"normal",function(){k(w,n);v._trigger("show",null,v._ui(o,w[0]))})}:function(o,w){d(o).closest("li").addClass("ui-tabs-selected ui-state-active");w.removeClass("ui-tabs-hide");v._trigger("show",null,v._ui(o,w[0]))};var s=g?function(w,o){o.animate(g,g.duration||"normal",function(){v.lis.removeClass("ui-tabs-selected ui-state-active");o.addClass("ui-tabs-hide");k(o,g);v.element.dequeue("tabs")})}:function(w,o,x){v.lis.removeClass("ui-tabs-selected ui-state-active");o.addClass("ui-tabs-hide");v.element.dequeue("tabs")};this.anchors.bind(j.event+".tabs",function(){var w=this,y=d(w).closest("li"),o=v.panels.filter(":not(.ui-tabs-hide)"),x=v.element.find(v._sanitizeSelector(w.hash));if((y.hasClass("ui-tabs-selected")&&!j.collapsible)||y.hasClass("ui-state-disabled")||y.hasClass("ui-state-processing")||v.panels.filter(":animated").length||v._trigger("select",null,v._ui(this,x[0]))===false){this.blur();return false}j.selected=v.anchors.index(this);v.abort();if(j.collapsible){if(y.hasClass("ui-tabs-selected")){j.selected=-1;if(j.cookie){v._cookie(j.selected,j.cookie)}v.element.queue("tabs",function(){s(w,o)}).dequeue("tabs");this.blur();return false}else{if(!o.length){if(j.cookie){v._cookie(j.selected,j.cookie)}v.element.queue("tabs",function(){q(w,x)});v.load(v.anchors.index(this));this.blur();return false}}}if(j.cookie){v._cookie(j.selected,j.cookie)}if(x.length){if(o.length){v.element.queue("tabs",function(){s(w,o)})}v.element.queue("tabs",function(){q(w,x)});v.load(v.anchors.index(this))}else{throw"jQuery UI Tabs: Mismatching fragment identifier."}if(d.browser.msie){this.blur()}});this.anchors.bind("click.tabs",function(){return false})},_getIndex:function(g){if(typeof g=="string"){g=this.anchors.index(this.anchors.filter("[href$='"+g+"']"))}return g},destroy:function(){var g=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var h=d.data(this,"href.tabs");if(h){this.href=h}var j=d(this).unbind(".tabs");d.each(["href","load","cache"],function(k,l){j.removeData(l+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){if(d.data(this,"destroy.tabs")){d(this).remove()}else{d(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "))}});if(g.cookie){this._cookie(null,g.cookie)}return this},add:function(k,j,h){if(h===f){h=this.anchors.length}var g=this,m=this.options,p=d(m.tabTemplate.replace(/#\{href\}/g,k).replace(/#\{label\}/g,j)),n=!k.indexOf("#")?k.replace("#",""):this._tabId(d("a",p)[0]);p.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var l=g.element.find("#"+n);if(!l.length){l=d(m.panelTemplate).attr("id",n).data("destroy.tabs",true)}l.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(h>=this.lis.length){p.appendTo(this.list);l.appendTo(this.list[0].parentNode)}else{p.insertBefore(this.lis[h]);l.insertBefore(this.panels[h])}m.disabled=d.map(m.disabled,function(q,o){return q>=h?++q:q});this._tabify();if(this.anchors.length==1){m.selected=0;p.addClass("ui-tabs-selected ui-state-active");l.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){g._trigger("show",null,g._ui(g.anchors[0],g.panels[0]))});this.load(0)}this._trigger("add",null,this._ui(this.anchors[h],this.panels[h]));return this},remove:function(g){g=this._getIndex(g);var j=this.options,k=this.lis.eq(g).remove(),h=this.panels.eq(g).remove();if(k.hasClass("ui-tabs-selected")&&this.anchors.length>1){this.select(g+(g+1<this.anchors.length?1:-1))}j.disabled=d.map(d.grep(j.disabled,function(m,l){return m!=g}),function(m,l){return m>=g?--m:m});this._tabify();this._trigger("remove",null,this._ui(k.find("a")[0],h[0]));return this},enable:function(g){g=this._getIndex(g);var h=this.options;if(d.inArray(g,h.disabled)==-1){return}this.lis.eq(g).removeClass("ui-state-disabled");h.disabled=d.grep(h.disabled,function(k,j){return k!=g});this._trigger("enable",null,this._ui(this.anchors[g],this.panels[g]));return this},disable:function(h){h=this._getIndex(h);var g=this,j=this.options;if(h!=j.selected){this.lis.eq(h).addClass("ui-state-disabled");j.disabled.push(h);j.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[h],this.panels[h]))}return this},select:function(g){g=this._getIndex(g);if(g==-1){if(this.options.collapsible&&this.options.selected!=-1){g=this.options.selected}else{return this}}this.anchors.eq(g).trigger(this.options.event+".tabs");return this},load:function(k){k=this._getIndex(k);var h=this,m=this.options,g=this.anchors.eq(k)[0],j=d.data(g,"load.tabs");this.abort();if(!j||this.element.queue("tabs").length!==0&&d.data(g,"cache.tabs")){this.element.dequeue("tabs");return}this.lis.eq(k).addClass("ui-state-processing");if(m.spinner){var l=d("span",g);l.data("label.tabs",l.html()).html(m.spinner)}this.xhr=d.ajax(d.extend({},m.ajaxOptions,{url:j,success:function(o,n){h.element.find(h._sanitizeSelector(g.hash)).html(o);h._cleanup();if(m.cache){d.data(g,"cache.tabs",true)}h._trigger("load",null,h._ui(h.anchors[k],h.panels[k]));try{m.ajaxOptions.success(o,n)}catch(p){}},error:function(p,n,o){h._cleanup();h._trigger("load",null,h._ui(h.anchors[k],h.panels[k]));try{m.ajaxOptions.error(p,n,k,g)}catch(o){}}}));h.element.dequeue("tabs");return this},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._cleanup();return this},url:function(h,g){this.anchors.eq(h).removeData("cache.tabs").data("load.tabs",g);return this},length:function(){return this.anchors.length}});d.extend(d.ui.tabs,{version:"1.8.23"});d.extend(d.ui.tabs.prototype,{rotation:null,rotate:function(j,l){var g=this,m=this.options;var h=g._rotate||(g._rotate=function(n){clearTimeout(g.rotation);g.rotation=setTimeout(function(){var o=m.selected;g.select(++o<g.anchors.length?o:0)},j);if(n){n.stopPropagation()}});var k=g._unrotate||(g._unrotate=!l?function(n){if(n.clientX){g.rotate(null)}}:function(n){h()});if(j){this.element.bind("tabsshow",h);this.anchors.bind(m.event+".tabs",k);h()}else{clearTimeout(g.rotation);this.element.unbind("tabsshow",h);this.anchors.unbind(m.event+".tabs",k);delete this._rotate;delete this._unrotate}return this}})})(jQuery);
/*!
 * jQuery UI Datepicker 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Datepicker
 *
 * Depends:
 *	jquery.ui.core.js
 */
(function($,undefined){$.extend($.ui,{datepicker:{version:"1.8.23"}});var PROP_NAME="datepicker";var dpuuid=new Date().getTime();var instActive;function Datepicker(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){if(this.debug){console.log.apply("",arguments)}},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase();var inline=(nodeName=="div"||nodeName=="span");if(!target.id){this.uuid+=1;target.id="dp"+this.uuid}var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{});if(nodeName=="input"){this._connectDatepicker(target,inst)}else{if(inline){this._inlineDatepicker(target,inst)}}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')))}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return}this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});this._autoSize(inst);$.data(target,PROP_NAME,inst);if(inst.settings.disabled){this._disableDatepicker(target)}},_attachments:function(input,inst){var appendText=this._get(inst,"appendText");var isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove()}if(appendText){inst.append=$('<span class="'+this._appendClass+'">'+appendText+"</span>");input[isRTL?"before":"after"](inst.append)}input.unbind("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove()}var showOn=this._get(inst,"showOn");if(showOn=="focus"||showOn=="both"){input.focus(this._showDatepicker)}if(showOn=="button"||showOn=="both"){var buttonText=this._get(inst,"buttonText");var buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$('<button type="button"></button>').addClass(this._triggerClass).html(buttonImage==""?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput==input[0]){$.datepicker._hideDatepicker()}else{if($.datepicker._datepickerShowing&&$.datepicker._lastInput!=input[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(input[0])}else{$.datepicker._showDatepicker(input[0])}}return false})}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var date=new Date(2009,12-1,20);var dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){var findMax=function(names){var max=0;var maxI=0;for(var i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i}}return maxI};date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))));date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay())}inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return}divSpan.addClass(this.markerClassName).append(inst.dpDiv).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});$.data(target,PROP_NAME,inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target)}inst.dpDiv.css("display","block")},_dialogDatepicker:function(input,date,onSelect,settings,pos){var inst=this._dialogInst;if(!inst){this.uuid+=1;var id="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+id+'" style="position: absolute; top: -100px; width: 0px;"/>');this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],PROP_NAME,inst)}extendRemove(inst.settings,settings||{});date=(date&&date.constructor==Date?this._formatDate(inst,date):date);this._dialogInput.val(date);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){var browserWidth=document.documentElement.clientWidth;var browserHeight=document.documentElement.clientHeight;var scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;var scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],PROP_NAME,inst);return this},_destroyDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();$.removeData(target,PROP_NAME);if(nodeName=="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(nodeName=="div"||nodeName=="span"){$target.removeClass(this.markerClassName).empty()}}},_enableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)})},_disableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)});this._disabledInputs[this._disabledInputs.length]=target},_isDisabledDatepicker:function(target){if(!target){return false}for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]==target){return true}}return false},_getInst:function(target){try{return $.data(target,PROP_NAME)}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var inst=this._getInst(target);if(arguments.length==2&&typeof name=="string"){return(name=="defaults"?$.extend({},$.datepicker._defaults):(inst?(name=="all"?$.extend({},inst.settings):this._get(inst,name)):null))}var settings=name||{};if(typeof name=="string"){settings={};settings[name]=value}if(inst){if(this._curInst==inst){this._hideDatepicker()}var date=this._getDateDatepicker(target,true);var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate)}if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate)}this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst)}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst)}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst)}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault)}return(inst?this._getDate(inst):null)},_doKeyDown:function(event){var inst=$.datepicker._getInst(event.target);var handled=true;var isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:var sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0])}var onSelect=$.datepicker._get(inst,"onSelect");if(onSelect){var dateStr=$.datepicker._formatDate(inst);onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{$.datepicker._hideDatepicker()}return false;break;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target)}handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target)}handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M")}break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D")}handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M")}break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D")}handled=event.ctrlKey||event.metaKey;break;default:handled=false}}else{if(event.keyCode==36&&event.ctrlKey){$.datepicker._showDatepicker(this)}else{handled=false}}if(handled){event.preventDefault();event.stopPropagation()}},_doKeyPress:function(event){var inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){var chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));var chr=String.fromCharCode(event.charCode==undefined?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1)}},_doKeyUp:function(event){var inst=$.datepicker._getInst(event.target);if(inst.input.val()!=inst.lastVal){try{var date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst)}}catch(err){$.datepicker.log(err)}}return true},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!="input"){input=$("input",input.parentNode)[0]}if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput==input){return}var inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!=inst){$.datepicker._curInst.dpDiv.stop(true,true);if(inst&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0])}}var beforeShow=$.datepicker._get(inst,"beforeShow");var beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};if(beforeShowSettings===false){return}extendRemove(inst.settings,beforeShowSettings);inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight}var isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")=="fixed";return !isFixed});if(isFixed&&$.browser.opera){$.datepicker._pos[0]-=document.documentElement.scrollLeft;$.datepicker._pos[1]-=document.documentElement.scrollTop}var offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){var showAnim=$.datepicker._get(inst,"showAnim");var duration=$.datepicker._get(inst,"duration");var postProcess=function(){var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){var borders=$.datepicker._getBorders(inst.dpDiv);cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}};inst.dpDiv.zIndex($(input).zIndex()+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects[showAnim]){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[showAnim||"show"]((showAnim?duration:null),postProcess)}if(!showAnim||!duration){postProcess()}if(inst.input.is(":visible")&&!inst.input.is(":disabled")){inst.input.focus()}$.datepicker._curInst=inst}},_updateDatepicker:function(inst){var self=this;self.maxRows=4;var borders=$.datepicker._getBorders(inst.dpDiv);instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));this._attachHandlers(inst);var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}inst.dpDiv.find("."+this._dayOverClass+" a").mouseover();var numMonths=this._getNumberOfMonths(inst);var cols=numMonths[1];var width=17;inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em")}inst.dpDiv[(numMonths[0]!=1||numMonths[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst==$.datepicker._curInst&&$.datepicker._datepickerShowing&&inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&inst.input[0]!=document.activeElement){inst.input.focus()}if(inst.yearshtml){var origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml)}origyearshtml=inst.yearshtml=null},0)}},_getBorders:function(elem){var convert=function(value){return{thin:1,medium:2,thick:3}[value]||value};return[parseFloat(convert(elem.css("border-left-width"))),parseFloat(convert(elem.css("border-top-width")))]},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth();var dpHeight=inst.dpDiv.outerHeight();var inputWidth=inst.input?inst.input.outerWidth():0;var inputHeight=inst.input?inst.input.outerHeight():0;var viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft());var viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left==inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top==(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight):0);return offset},_findPos:function(obj){var inst=this._getInst(obj);var isRTL=this._get(inst,"isRTL");while(obj&&(obj.type=="hidden"||obj.nodeType!=1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"]}var position=$(obj).offset();return[position.left,position.top]},_hideDatepicker:function(input){var inst=this._curInst;if(!inst||(input&&inst!=$.data(input,PROP_NAME))){return}if(this._datepickerShowing){var showAnim=this._get(inst,"showAnim");var duration=this._get(inst,"duration");var postProcess=function(){$.datepicker._tidyDialog(inst)};if($.effects&&$.effects[showAnim]){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[(showAnim=="slideDown"?"slideUp":(showAnim=="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess)}if(!showAnim){postProcess()}this._datepickerShowing=false;var onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if(!$.datepicker._curInst){return}var $target=$(event.target),inst=$.datepicker._getInst($target[0]);if((($target[0].id!=$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length==0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||($target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=inst)){$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id);var inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return}this._adjustInstDate(inst,offset+(period=="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst)},_gotoToday:function(id){var target=$(id);var inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear}else{var date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear()}this._notifyChange(inst);this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id);var inst=this._getInst(target[0]);inst["selected"+(period=="M"?"Month":"Year")]=inst["draw"+(period=="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target)},_selectDay:function(id,month,year,td){var target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return}var inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear))},_clearDate:function(id){var target=$(id);var inst=this._getInst(target[0]);this._selectDate(target,"")},_selectDate:function(id,dateStr){var target=$(id);var inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(inst.input){inst.input.val(dateStr)}this._updateAlternate(inst);var onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{if(inst.input){inst.input.trigger("change")}}if(inst.inline){this._updateDatepicker(inst)}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof(inst.input[0])!="object"){inst.input.focus()}this._lastInput=null}},_updateAlternate:function(inst){var altField=this._get(inst,"altField");if(altField){var altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");var date=this._getDate(inst);var dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr)})}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""]},iso8601Week:function(date){var checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments"}value=(typeof value=="object"?value.toString():value+"");if(value==""){return null}var shortYearCutoff=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff;shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var year=-1;var month=-1;var day=-1;var doy=-1;var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var getNumber=function(match){var isDoubled=lookAhead(match);var size=(match=="@"?14:(match=="!"?20:(match=="y"&&isDoubled?4:(match=="o"?3:2))));var digits=new RegExp("^\\d{1,"+size+"}");var num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue}iValue+=num[0].length;return parseInt(num[0],10)};var getName=function(match,shortNames,longNames){var names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return -(a[1].length-b[1].length)});var index=-1;$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()==name.toLowerCase()){index=pair[0];iValue+=name.length;return false}});if(index!=-1){return index+1}else{throw"Unknown name at position "+iValue}};var checkLiteral=function(){if(value.charAt(iValue)!=format.charAt(iFormat)){throw"Unexpected literal at position "+iValue}iValue++};var iValue=0;for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{checkLiteral()}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":var date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":var date=new Date((getNumber("!")-this._ticksTo1970)/10000);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral()}else{literal=true}break;default:checkLiteral()}}}if(iValue<value.length){throw"Extra/unparsed characters found in date: "+value.substring(iValue)}if(year==-1){year=new Date().getFullYear()}else{if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+(year<=shortYearCutoff?0:-100)}}if(doy>-1){month=1;day=doy;do{var dim=this._getDaysInMonth(year,month-1);if(day<=dim){break}month++;day-=dim}while(true)}var date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!=year||date.getMonth()+1!=month||date.getDate()!=day){throw"Invalid date"}return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(format,date,settings){if(!date){return""}var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num}}return num};var formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value])};var output="";var literal=false;if(date){for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{output+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*10000+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'"}else{literal=true}break;default:output+=format.charAt(iFormat)}}}}return output},_possibleChars:function(format){var chars="";var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{chars+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'"}else{literal=true}break;default:chars+=format.charAt(iFormat)}}}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()==inst.lastVal){return}var dateFormat=this._get(inst,"dateFormat");var dates=inst.lastVal=inst.input?inst.input.val():null;var date,defaultDate;date=defaultDate=this._getDefaultDate(inst);var settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){this.log(event);dates=(noDefault?"":dates)}inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates?date.getDate():0);inst.currentMonth=(dates?date.getMonth():0);inst.currentYear=(dates?date.getFullYear():0);this._adjustInstDate(inst)},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setDate(date.getDate()+offset);return date};var offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date();var year=date.getFullYear();var month=date.getMonth();var day=date.getDate();var pattern=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;var matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break}matches=pattern.exec(offset)}return new Date(year,month,day)};var newDate=(date==null||date===""?defaultDate:(typeof date=="string"?offsetString(date):(typeof date=="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));newDate=(newDate&&newDate.toString()=="Invalid Date"?defaultDate:newDate);if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0)}return this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){if(!date){return null}date.setHours(date.getHours()>12?date.getHours()+2:0);return date},_setDate:function(inst,date,noChange){var clear=!date;var origMonth=inst.selectedMonth;var origYear=inst.selectedYear;var newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!=inst.selectedMonth||origYear!=inst.selectedYear)&&!noChange){this._notifyChange(inst)}this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst))}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()=="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return startDate},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths");var id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(id,-stepMonths,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(id)},selectDay:function(){window["DP_jQuery_"+dpuuid].datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(id,this,"M");return false},selectYear:function(){window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(id,this,"Y");return false}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var today=new Date();today=this._daylightSavingAdjust(new Date(today.getFullYear(),today.getMonth(),today.getDate()));var isRTL=this._get(inst,"isRTL");var showButtonPanel=this._get(inst,"showButtonPanel");var hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext");var navigationAsDateFormat=this._get(inst,"navigationAsDateFormat");var numMonths=this._getNumberOfMonths(inst);var showCurrentAtPos=this._get(inst,"showCurrentAtPos");var stepMonths=this._get(inst,"stepMonths");var isMultiMonth=(numMonths[0]!=1||numMonths[1]!=1);var currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var drawMonth=inst.drawMonth-showCurrentAtPos;var drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--}if(maxDate){var maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--}}}inst.drawMonth=drawMonth;inst.drawYear=drawYear;var prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)));var prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>"));var nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)));var next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>"));var currentText=this._get(inst,"currentText");var gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));var controls=(!inst.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(inst,"closeText")+"</button>":"");var buttonPanel=(showButtonPanel)?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";var firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=(isNaN(firstDay)?0:firstDay);var showWeek=this._get(inst,"showWeek");var dayNames=this._get(inst,"dayNames");var dayNamesShort=this._get(inst,"dayNamesShort");var dayNamesMin=this._get(inst,"dayNamesMin");var monthNames=this._get(inst,"monthNames");var monthNamesShort=this._get(inst,"monthNamesShort");var beforeShowDay=this._get(inst,"beforeShowDay");var showOtherMonths=this._get(inst,"showOtherMonths");var selectOtherMonths=this._get(inst,"selectOtherMonths");var calculateWeek=this._get(inst,"calculateWeek")||this.iso8601Week;var defaultDate=this._getDefaultDate(inst);var html="";for(var row=0;row<numMonths[0];row++){var group="";this.maxRows=4;for(var col=0;col<numMonths[1];col++){var selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));var cornerClass=" ui-corner-all";var calender="";if(isMultiMonth){calender+='<div class="ui-datepicker-group';if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break}}calender+='">'}calender+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+cornerClass+'">'+(/all|left/.test(cornerClass)&&row==0?(isRTL?next:prev):"")+(/all|right/.test(cornerClass)&&row==0?(isRTL?prev:next):"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var thead=(showWeek?'<th class="ui-datepicker-week-col">'+this._get(inst,"weekHeader")+"</th>":"");for(var dow=0;dow<7;dow++){var day=(dow+firstDay)%7;thead+="<th"+((dow+firstDay+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+dayNames[day]+'">'+dayNamesMin[day]+"</span></th>"}calender+=thead+"</tr></thead><tbody>";var daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear==inst.selectedYear&&drawMonth==inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)}var leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;var curRows=Math.ceil((leadDays+daysInMonth)/7);var numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;var printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(var dRow=0;dRow<numRows;dRow++){calender+="<tr>";var tbody=(!showWeek?"":'<td class="ui-datepicker-week-col">'+this._get(inst,"calculateWeek")(printDate)+"</td>");for(var dow=0;dow<7;dow++){var daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);var otherMonth=(printDate.getMonth()!=drawMonth);var unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);tbody+='<td class="'+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+((printDate.getTime()==selectedDate.getTime()&&drawMonth==inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()==printDate.getTime()&&defaultDate.getTime()==selectedDate.getTime())?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()==currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()==today.getTime()?" ui-datepicker-today":""))+'"'+((!otherMonth||showOtherMonths)&&daySettings[2]?' title="'+daySettings[2]+'"':"")+(unselectable?"":' data-handler="selectDay" data-event="click" data-month="'+printDate.getMonth()+'" data-year="'+printDate.getFullYear()+'"')+">"+(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?'<span class="ui-state-default">'+printDate.getDate()+"</span>":'<a class="ui-state-default'+(printDate.getTime()==today.getTime()?" ui-state-highlight":"")+(printDate.getTime()==currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+'" href="#">'+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate)}calender+=tbody+"</tr>"}drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++}calender+="</tbody></table>"+(isMultiMonth?"</div>"+((numMonths[0]>0&&col==numMonths[1]-1)?'<div class="ui-datepicker-row-break"></div>':""):"");group+=calender}html+=group}html+=buttonPanel+($.browser.msie&&parseInt($.browser.version,10)<7&&!inst.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");inst._keyEvent=false;return html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var changeMonth=this._get(inst,"changeMonth");var changeYear=this._get(inst,"changeYear");var showMonthAfterYear=this._get(inst,"showMonthAfterYear");var html='<div class="ui-datepicker-title">';var monthHtml="";if(secondary||!changeMonth){monthHtml+='<span class="ui-datepicker-month">'+monthNames[drawMonth]+"</span>"}else{var inMinYear=(minDate&&minDate.getFullYear()==drawYear);var inMaxYear=(maxDate&&maxDate.getFullYear()==drawYear);monthHtml+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+='<option value="'+month+'"'+(month==drawMonth?' selected="selected"':"")+">"+monthNamesShort[month]+"</option>"}}monthHtml+="</select>"}if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")}if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+='<span class="ui-datepicker-year">'+drawYear+"</span>"}else{var years=this._get(inst,"yearRange").split(":");var thisYear=new Date().getFullYear();var determineYear=function(value){var year=(value.match(/c[+-].*/)?drawYear+parseInt(value.substring(1),10):(value.match(/[+-].*/)?thisYear+parseInt(value,10):parseInt(value,10)));return(isNaN(year)?thisYear:year)};var year=determineYear(years[0]);var endYear=Math.max(year,determineYear(years[1]||""));year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);inst.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';for(;year<=endYear;year++){inst.yearshtml+='<option value="'+year+'"'+(year==drawYear?' selected="selected"':"")+">"+year+"</option>"}inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null}}html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml}html+="</div>";return html},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period=="Y"?offset:0);var month=inst.drawMonth+(period=="M"?offset:0);var day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period=="D"?offset:0);var date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period=="M"||period=="Y"){this._notifyChange(inst)}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var newDate=(minDate&&date<minDate?minDate:date);newDate=(maxDate&&newDate>maxDate?maxDate:newDate);return newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst])}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths=="number"?[1,numMonths]:numMonths))},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst);var date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()))}return this._isInRange(inst,date)},_isInRange:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");return((!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime()))},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear}var date=(day?(typeof day=="object"?day:this._daylightSavingAdjust(new Date(year,month,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}});function bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.bind("mouseout",function(event){var elem=$(event.target).closest(selector);if(!elem.length){return}elem.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(event){var elem=$(event.target).closest(selector);if($.datepicker._isDisabledDatepicker(instActive.inline?dpDiv.parent()[0]:instActive.input[0])||!elem.length){return}elem.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");elem.addClass("ui-state-hover");if(elem.hasClass("ui-datepicker-prev")){elem.addClass("ui-datepicker-prev-hover")}if(elem.hasClass("ui-datepicker-next")){elem.addClass("ui-datepicker-next-hover")}})}function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null||props[name]==undefined){target[name]=props[name]}}return target}function isArray(a){return(a&&(($.browser.safari&&typeof a=="object"&&a.length)||(a.constructor&&a.constructor.toString().match(/\Array\(\)/))))}$.fn.datepicker=function(options){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv);$.datepicker.initialized=true}var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options=="string"&&(options=="isDisabled"||options=="getDate"||options=="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}if(options=="option"&&arguments.length==2&&typeof arguments[1]=="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}return this.each(function(){typeof options=="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)})};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.8.23";window["DP_jQuery_"+dpuuid]=$})(jQuery);
/*!
 * jQuery UI Progressbar 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Progressbar
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove();a.Widget.prototype.destroy.apply(this,arguments)},value:function(c){if(c===b){return this._value()}this._setOption("value",c);return this},_setOption:function(c,d){if(c==="value"){this.options.value=d;this._refreshValue();if(this._value()===this.options.max){this._trigger("complete")}}a.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var c=this.options.value;if(typeof c!=="number"){c=0}return Math.min(this.options.max,Math.max(this.min,c))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var d=this.value();var c=this._percentage();if(this.oldValue!==d){this.oldValue=d;this._trigger("change")}this.valueDiv.toggle(d>this.min).toggleClass("ui-corner-right",d===this.options.max).width(c.toFixed(0)+"%");this.element.attr("aria-valuenow",d)}});a.extend(a.ui.progressbar,{version:"1.8.23"})})(jQuery);
/*!
 * jQuery UI Effects 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/
 */
jQuery.effects||(function(h,e){h.effects={};h.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(p,o){h.fx.step[o]=function(q){if(!q.colorInit){q.start=n(q.elem,o);q.end=l(q.end);q.colorInit=true}q.elem.style[o]="rgb("+Math.max(Math.min(parseInt((q.pos*(q.end[0]-q.start[0]))+q.start[0],10),255),0)+","+Math.max(Math.min(parseInt((q.pos*(q.end[1]-q.start[1]))+q.start[1],10),255),0)+","+Math.max(Math.min(parseInt((q.pos*(q.end[2]-q.start[2]))+q.start[2],10),255),0)+")"}});function l(p){var o;if(p&&p.constructor==Array&&p.length==3){return p}if(o=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(p)){return[parseInt(o[1],10),parseInt(o[2],10),parseInt(o[3],10)]}if(o=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(p)){return[parseFloat(o[1])*2.55,parseFloat(o[2])*2.55,parseFloat(o[3])*2.55]}if(o=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(p)){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}if(o=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(p)){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}if(o=/rgba\(0, 0, 0, 0\)/.exec(p)){return a.transparent}return a[h.trim(p).toLowerCase()]}function n(q,o){var p;do{p=(h.curCSS||h.css)(q,o);if(p!=""&&p!="transparent"||h.nodeName(q,"body")){break}o="backgroundColor"}while(q=q.parentNode);return l(p)}var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};var f=["add","remove","toggle"],c={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function g(){var s=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,t={},p,q;if(s&&s.length&&s[0]&&s[s[0]]){var o=s.length;while(o--){p=s[o];if(typeof s[p]=="string"){q=p.replace(/\-(\w)/g,function(u,v){return v.toUpperCase()});t[q]=s[p]}}}else{for(p in s){if(typeof s[p]==="string"){t[p]=s[p]}}}return t}function b(p){var o,q;for(o in p){q=p[o];if(q==null||h.isFunction(q)||o in c||(/scrollbar/).test(o)||(!(/color/i).test(o)&&isNaN(parseFloat(q)))){delete p[o]}}return p}function j(o,q){var s={_:0},p;for(p in q){if(o[p]!=q[p]){s[p]=q[p]}}return s}h.effects.animateClass=function(o,p,s,q){if(h.isFunction(s)){q=s;s=null}return this.queue(function(){var w=h(this),t=w.attr("style")||" ",x=b(g.call(this)),v,u=w.attr("class")||"";h.each(f,function(y,z){if(o[z]){w[z+"Class"](o[z])}});v=b(g.call(this));w.attr("class",u);w.animate(j(x,v),{queue:false,duration:p,easing:s,complete:function(){h.each(f,function(y,z){if(o[z]){w[z+"Class"](o[z])}});if(typeof w.attr("style")=="object"){w.attr("style").cssText="";w.attr("style").cssText=t}else{w.attr("style",t)}if(q){q.apply(this,arguments)}h.dequeue(this)}})})};h.fn.extend({_addClass:h.fn.addClass,addClass:function(p,o,s,q){return o?h.effects.animateClass.apply(this,[{add:p},o,s,q]):this._addClass(p)},_removeClass:h.fn.removeClass,removeClass:function(p,o,s,q){return o?h.effects.animateClass.apply(this,[{remove:p},o,s,q]):this._removeClass(p)},_toggleClass:h.fn.toggleClass,toggleClass:function(q,p,o,t,s){if(typeof p=="boolean"||p===e){if(!o){return this._toggleClass(q,p)}else{return h.effects.animateClass.apply(this,[(p?{add:q}:{remove:q}),o,t,s])}}else{return h.effects.animateClass.apply(this,[{toggle:q},p,o,t])}},switchClass:function(o,q,p,t,s){return h.effects.animateClass.apply(this,[{add:q,remove:o},p,t,s])}});h.extend(h.effects,{version:"1.8.23",save:function(p,q){for(var o=0;o<q.length;o++){if(q[o]!==null){p.data("ec.storage."+q[o],p[0].style[q[o]])}}},restore:function(p,q){for(var o=0;o<q.length;o++){if(q[o]!==null){p.css(q[o],p.data("ec.storage."+q[o]))}}},setMode:function(o,p){if(p=="toggle"){p=o.is(":hidden")?"show":"hide"}return p},getBaseline:function(p,q){var s,o;switch(p[0]){case"top":s=0;break;case"middle":s=0.5;break;case"bottom":s=1;break;default:s=p[0]/q.height}switch(p[1]){case"left":o=0;break;case"center":o=0.5;break;case"right":o=1;break;default:o=p[1]/q.width}return{x:o,y:s}},createWrapper:function(o){if(o.parent().is(".ui-effects-wrapper")){return o.parent()}var p={width:o.outerWidth(true),height:o.outerHeight(true),"float":o.css("float")},t=h("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),s=document.activeElement;try{s.id}catch(q){s=document.body}o.wrap(t);if(o[0]===s||h.contains(o[0],s)){h(s).focus()}t=o.parent();if(o.css("position")=="static"){t.css({position:"relative"});o.css({position:"relative"})}else{h.extend(p,{position:o.css("position"),zIndex:o.css("z-index")});h.each(["top","left","bottom","right"],function(u,v){p[v]=o.css(v);if(isNaN(parseInt(p[v],10))){p[v]="auto"}});o.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}return t.css(p).show()},removeWrapper:function(o){var p,q=document.activeElement;if(o.parent().is(".ui-effects-wrapper")){p=o.parent().replaceWith(o);if(o[0]===q||h.contains(o[0],q)){h(q).focus()}return p}return o},setTransition:function(p,s,o,q){q=q||{};h.each(s,function(u,t){var v=p.cssUnit(t);if(v[0]>0){q[t]=v[0]*o+v[1]}});return q}});function d(p,o,q,s){if(typeof p=="object"){s=o;q=null;o=p;p=o.effect}if(h.isFunction(o)){s=o;q=null;o={}}if(typeof o=="number"||h.fx.speeds[o]){s=q;q=o;o={}}if(h.isFunction(q)){s=q;q=null}o=o||{};q=q||o.duration;q=h.fx.off?0:typeof q=="number"?q:q in h.fx.speeds?h.fx.speeds[q]:h.fx.speeds._default;s=s||o.complete;return[p,o,q,s]}function m(o){if(!o||typeof o==="number"||h.fx.speeds[o]){return true}if(typeof o==="string"&&!h.effects[o]){return true}return false}h.fn.extend({effect:function(s,q,u,w){var p=d.apply(this,arguments),t={options:p[1],duration:p[2],callback:p[3]},v=t.options.mode,o=h.effects[s];if(h.fx.off||!o){if(v){return this[v](t.duration,t.callback)}else{return this.each(function(){if(t.callback){t.callback.call(this)}})}}return o.call(this,t)},_show:h.fn.show,show:function(p){if(m(p)){return this._show.apply(this,arguments)}else{var o=d.apply(this,arguments);o[1].mode="show";return this.effect.apply(this,o)}},_hide:h.fn.hide,hide:function(p){if(m(p)){return this._hide.apply(this,arguments)}else{var o=d.apply(this,arguments);o[1].mode="hide";return this.effect.apply(this,o)}},__toggle:h.fn.toggle,toggle:function(p){if(m(p)||typeof p==="boolean"||h.isFunction(p)){return this.__toggle.apply(this,arguments)}else{var o=d.apply(this,arguments);o[1].mode="toggle";return this.effect.apply(this,o)}},cssUnit:function(o){var p=this.css(o),q=[];h.each(["em","px","%","pt"],function(s,t){if(p.indexOf(t)>0){q=[parseFloat(p),t]}});return q}});var k={};h.each(["Quad","Cubic","Quart","Quint","Expo"],function(p,o){k[o]=function(q){return Math.pow(q,p+2)}});h.extend(k,{Sine:function(o){return 1-Math.cos(o*Math.PI/2)},Circ:function(o){return 1-Math.sqrt(1-o*o)},Elastic:function(o){return o===0||o===1?o:-Math.pow(2,8*(o-1))*Math.sin(((o-1)*80-7.5)*Math.PI/15)},Back:function(o){return o*o*(3*o-2)},Bounce:function(s){var o,q=4;while(s<((o=Math.pow(2,--q))-1)/11){}return 1/Math.pow(4,3-q)-7.5625*Math.pow((o*3-2)/22-s,2)}});h.each(k,function(p,o){h.easing["easeIn"+p]=o;h.easing["easeOut"+p]=function(q){return 1-o(1-q)};h.easing["easeInOut"+p]=function(q){return q<0.5?o(q*2)/2:o(q*-2+2)/-2+1}})})(jQuery);
/*!
 * jQuery UI Effects Blind 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Blind
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.blind=function(c){return this.queue(function(){var e=a(this),d=["position","top","bottom","left","right"];var j=a.effects.setMode(e,c.options.mode||"hide");var h=c.options.direction||"vertical";a.effects.save(e,d);e.show();var l=a.effects.createWrapper(e).css({overflow:"hidden"});var f=(h=="vertical")?"height":"width";var k=(h=="vertical")?l.height():l.width();if(j=="show"){l.css(f,0)}var g={};g[f]=j=="show"?k:0;l.animate(g,c.duration,c.options.easing,function(){if(j=="hide"){e.hide()}a.effects.restore(e,d);a.effects.removeWrapper(e);if(c.callback){c.callback.apply(e[0],arguments)}e.dequeue()})})}})(jQuery);
/*!
 * jQuery UI Effects Clip 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Clip
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.clip=function(c){return this.queue(function(){var g=a(this),l=["position","top","bottom","left","right","height","width"];var k=a.effects.setMode(g,c.options.mode||"hide");var m=c.options.direction||"vertical";a.effects.save(g,l);g.show();var d=a.effects.createWrapper(g).css({overflow:"hidden"});var f=g[0].tagName=="IMG"?d:g;var h={size:(m=="vertical")?"height":"width",position:(m=="vertical")?"top":"left"};var e=(m=="vertical")?f.height():f.width();if(k=="show"){f.css(h.size,0);f.css(h.position,e/2)}var j={};j[h.size]=k=="show"?e:0;j[h.position]=k=="show"?0:e/2;f.animate(j,{queue:false,duration:c.duration,easing:c.options.easing,complete:function(){if(k=="hide"){g.hide()}a.effects.restore(g,l);a.effects.removeWrapper(g);if(c.callback){c.callback.apply(g[0],arguments)}g.dequeue()}})})}})(jQuery);
/*!
 * jQuery UI Effects Drop 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Drop
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.drop=function(c){return this.queue(function(){var f=a(this),e=["position","top","bottom","left","right","opacity"];var k=a.effects.setMode(f,c.options.mode||"hide");var j=c.options.direction||"left";a.effects.save(f,e);f.show();a.effects.createWrapper(f);var g=(j=="up"||j=="down")?"top":"left";var d=(j=="up"||j=="left")?"pos":"neg";var l=c.options.distance||(g=="top"?f.outerHeight(true)/2:f.outerWidth(true)/2);if(k=="show"){f.css("opacity",0).css(g,d=="pos"?-l:l)}var h={opacity:k=="show"?1:0};h[g]=(k=="show"?(d=="pos"?"+=":"-="):(d=="pos"?"-=":"+="))+l;f.animate(h,{queue:false,duration:c.duration,easing:c.options.easing,complete:function(){if(k=="hide"){f.hide()}a.effects.restore(f,e);a.effects.removeWrapper(f);if(c.callback){c.callback.apply(this,arguments)}f.dequeue()}})})}})(jQuery);
/*!
 * jQuery UI Effects Fade 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fade
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.fade=function(c){return this.queue(function(){var d=a(this),e=a.effects.setMode(d,c.options.mode||"hide");d.animate({opacity:e},{queue:false,duration:c.duration,easing:c.options.easing,complete:function(){(c.callback&&c.callback.apply(this,arguments));d.dequeue()}})})}})(jQuery);
/*!
 * jQuery UI Effects Highlight 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Highlight
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.highlight=function(c){return this.queue(function(){var e=a(this),d=["backgroundImage","backgroundColor","opacity"],g=a.effects.setMode(e,c.options.mode||"show"),f={backgroundColor:e.css("backgroundColor")};if(g=="hide"){f.opacity=0}a.effects.save(e,d);e.show().css({backgroundImage:"none",backgroundColor:c.options.color||"#ffff99"}).animate(f,{queue:false,duration:c.duration,easing:c.options.easing,complete:function(){(g=="hide"&&e.hide());a.effects.restore(e,d);(g=="show"&&!a.support.opacity&&this.style.removeAttribute("filter"));(c.callback&&c.callback.apply(this,arguments));e.dequeue()}})})}})(jQuery);
/*!
 * jQuery UI Effects Pulsate 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Pulsate
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.pulsate=function(c){return this.queue(function(){var g=a(this),k=a.effects.setMode(g,c.options.mode||"show"),j=((c.options.times||5)*2)-1,h=c.duration?c.duration/2:a.fx.speeds._default/2,d=g.is(":visible"),e=0;if(!d){g.css("opacity",0).show();e=1}if((k=="hide"&&d)||(k=="show"&&!d)){j--}for(var f=0;f<j;f++){g.animate({opacity:e},h,c.options.easing);e=(e+1)%2}g.animate({opacity:e},h,c.options.easing,function(){if(e==0){g.hide()}(c.callback&&c.callback.apply(this,arguments))});g.queue("fx",function(){g.dequeue()}).dequeue()})}})(jQuery);
/*!
 * jQuery UI Effects Scale 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Scale
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.puff=function(c){return this.queue(function(){var g=a(this),h=a.effects.setMode(g,c.options.mode||"hide"),f=parseInt(c.options.percent,10)||150,e=f/100,d={height:g.height(),width:g.width()};a.extend(c.options,{fade:true,mode:h,percent:h=="hide"?f:100,from:h=="hide"?d:{height:d.height*e,width:d.width*e}});g.effect("scale",c.options,c.duration,c.callback);g.dequeue()})};a.effects.scale=function(c){return this.queue(function(){var h=a(this);var e=a.extend(true,{},c.options);var l=a.effects.setMode(h,c.options.mode||"effect");var j=parseInt(c.options.percent,10)||(parseInt(c.options.percent,10)==0?0:(l=="hide"?0:100));var k=c.options.direction||"both";var d=c.options.origin;if(l!="effect"){e.origin=d||["middle","center"];e.restore=true}var g={height:h.height(),width:h.width()};h.from=c.options.from||(l=="show"?{height:0,width:0}:g);var f={y:k!="horizontal"?(j/100):1,x:k!="vertical"?(j/100):1};h.to={height:g.height*f.y,width:g.width*f.x};if(c.options.fade){if(l=="show"){h.from.opacity=0;h.to.opacity=1}if(l=="hide"){h.from.opacity=1;h.to.opacity=0}}e.from=h.from;e.to=h.to;e.mode=l;h.effect("size",e,c.duration,c.callback);h.dequeue()})};a.effects.size=function(c){return this.queue(function(){var d=a(this),p=["position","top","bottom","left","right","width","height","overflow","opacity"];var o=["position","top","bottom","left","right","overflow","opacity"];var l=["width","height","overflow"];var s=["fontSize"];var m=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];var g=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];var h=a.effects.setMode(d,c.options.mode||"effect");var k=c.options.restore||false;var f=c.options.scale||"both";var q=c.options.origin;var e={height:d.height(),width:d.width()};d.from=c.options.from||e;d.to=c.options.to||e;if(q){var j=a.effects.getBaseline(q,e);d.from.top=(e.height-d.from.height)*j.y;d.from.left=(e.width-d.from.width)*j.x;d.to.top=(e.height-d.to.height)*j.y;d.to.left=(e.width-d.to.width)*j.x}var n={from:{y:d.from.height/e.height,x:d.from.width/e.width},to:{y:d.to.height/e.height,x:d.to.width/e.width}};if(f=="box"||f=="both"){if(n.from.y!=n.to.y){p=p.concat(m);d.from=a.effects.setTransition(d,m,n.from.y,d.from);d.to=a.effects.setTransition(d,m,n.to.y,d.to)}if(n.from.x!=n.to.x){p=p.concat(g);d.from=a.effects.setTransition(d,g,n.from.x,d.from);d.to=a.effects.setTransition(d,g,n.to.x,d.to)}}if(f=="content"||f=="both"){if(n.from.y!=n.to.y){p=p.concat(s);d.from=a.effects.setTransition(d,s,n.from.y,d.from);d.to=a.effects.setTransition(d,s,n.to.y,d.to)}}a.effects.save(d,k?p:o);d.show();a.effects.createWrapper(d);d.css("overflow","hidden").css(d.from);if(f=="content"||f=="both"){m=m.concat(["marginTop","marginBottom"]).concat(s);g=g.concat(["marginLeft","marginRight"]);l=p.concat(m).concat(g);d.find("*[width]").each(function(){var u=a(this);if(k){a.effects.save(u,l)}var t={height:u.height(),width:u.width()};u.from={height:t.height*n.from.y,width:t.width*n.from.x};u.to={height:t.height*n.to.y,width:t.width*n.to.x};if(n.from.y!=n.to.y){u.from=a.effects.setTransition(u,m,n.from.y,u.from);u.to=a.effects.setTransition(u,m,n.to.y,u.to)}if(n.from.x!=n.to.x){u.from=a.effects.setTransition(u,g,n.from.x,u.from);u.to=a.effects.setTransition(u,g,n.to.x,u.to)}u.css(u.from);u.animate(u.to,c.duration,c.options.easing,function(){if(k){a.effects.restore(u,l)}})})}d.animate(d.to,{queue:false,duration:c.duration,easing:c.options.easing,complete:function(){if(d.to.opacity===0){d.css("opacity",d.from.opacity)}if(h=="hide"){d.hide()}a.effects.restore(d,k?p:o);a.effects.removeWrapper(d);if(c.callback){c.callback.apply(this,arguments)}d.dequeue()}})})}})(jQuery);
/*!
 * jQuery UI Effects Shake 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Shake
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.shake=function(c){return this.queue(function(){var f=a(this),m=["position","top","bottom","left","right"];var l=a.effects.setMode(f,c.options.mode||"effect");var o=c.options.direction||"left";var d=c.options.distance||20;var e=c.options.times||3;var h=c.duration||c.options.duration||140;a.effects.save(f,m);f.show();a.effects.createWrapper(f);var g=(o=="up"||o=="down")?"top":"left";var q=(o=="up"||o=="left")?"pos":"neg";var j={},p={},n={};j[g]=(q=="pos"?"-=":"+=")+d;p[g]=(q=="pos"?"+=":"-=")+d*2;n[g]=(q=="pos"?"-=":"+=")+d*2;f.animate(j,h,c.options.easing);for(var k=1;k<e;k++){f.animate(p,h,c.options.easing).animate(n,h,c.options.easing)}f.animate(p,h,c.options.easing).animate(j,h/2,c.options.easing,function(){a.effects.restore(f,m);a.effects.removeWrapper(f);if(c.callback){c.callback.apply(this,arguments)}});f.queue("fx",function(){f.dequeue()});f.dequeue()})}})(jQuery);
/*!
 * jQuery UI Effects Slide 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Slide
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.slide=function(c){return this.queue(function(){var f=a(this),e=["position","top","bottom","left","right"];var k=a.effects.setMode(f,c.options.mode||"show");var j=c.options.direction||"left";a.effects.save(f,e);f.show();a.effects.createWrapper(f).css({overflow:"hidden"});var g=(j=="up"||j=="down")?"top":"left";var d=(j=="up"||j=="left")?"pos":"neg";var l=c.options.distance||(g=="top"?f.outerHeight(true):f.outerWidth(true));if(k=="show"){f.css(g,d=="pos"?(isNaN(l)?"-"+l:-l):l)}var h={};h[g]=(k=="show"?(d=="pos"?"+=":"-="):(d=="pos"?"-=":"+="))+l;f.animate(h,{queue:false,duration:c.duration,easing:c.options.easing,complete:function(){if(k=="hide"){f.hide()}a.effects.restore(f,e);a.effects.removeWrapper(f);if(c.callback){c.callback.apply(this,arguments)}f.dequeue()}})})}})(jQuery);
/*!
 * jQuery UI Effects Transfer 1.8.23
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Transfer
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(a,b){a.effects.transfer=function(c){return this.queue(function(){var g=a(this),j=a(c.options.to),f=j.offset(),h={top:f.top,left:f.left,height:j.innerHeight(),width:j.innerWidth()},e=g.offset(),d=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(c.options.className).css({top:e.top,left:e.left,height:g.innerHeight(),width:g.innerWidth(),position:"absolute"}).animate(h,c.duration,c.options.easing,function(){d.remove();(c.callback&&c.callback.apply(g[0],arguments));g.dequeue()})})}})(jQuery);(function(){var x=this;var k=x._;var F={};var E=Array.prototype,f=Object.prototype,s=Function.prototype;var n=E.slice,B=E.unshift,c=f.toString,h=f.hasOwnProperty;var N=E.forEach,q=E.map,G=E.reduce,b=E.reduceRight,a=E.filter,C=E.every,o=E.some,m=E.indexOf,l=E.lastIndexOf,u=Array.isArray,e=Object.keys,H=s.bind;var O=function(p){return new v(p)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=O}exports._=O}else{x._=O}O.VERSION="1.3.3";var K=O.each=O.forEach=function(T,S,R){if(T==null){return}if(N&&T.forEach===N){T.forEach(S,R)}else{if(T.length===+T.length){for(var Q=0,p=T.length;Q<p;Q++){if(Q in T&&S.call(R,T[Q],Q,T)===F){return}}}else{for(var P in T){if(O.has(T,P)){if(S.call(R,T[P],P,T)===F){return}}}}}};O.map=O.collect=function(R,Q,P){var p=[];if(R==null){return p}if(q&&R.map===q){return R.map(Q,P)}K(R,function(U,S,T){p[p.length]=Q.call(P,U,S,T)});if(R.length===+R.length){p.length=R.length}return p};O.reduce=O.foldl=O.inject=function(S,R,p,Q){var P=arguments.length>2;if(S==null){S=[]}if(G&&S.reduce===G){if(Q){R=O.bind(R,Q)}return P?S.reduce(R,p):S.reduce(R)}K(S,function(V,T,U){if(!P){p=V;P=true}else{p=R.call(Q,p,V,T,U)}});if(!P){throw new TypeError("Reduce of empty array with no initial value")}return p};O.reduceRight=O.foldr=function(S,R,p,Q){var P=arguments.length>2;if(S==null){S=[]}if(b&&S.reduceRight===b){if(Q){R=O.bind(R,Q)}return P?S.reduceRight(R,p):S.reduceRight(R)}var T=O.toArray(S).reverse();if(Q&&!P){R=O.bind(R,Q)}return P?O.reduce(T,R,p,Q):O.reduce(T,R)};O.find=O.detect=function(R,Q,P){var p;A(R,function(U,S,T){if(Q.call(P,U,S,T)){p=U;return true}});return p};O.filter=O.select=function(R,Q,P){var p=[];if(R==null){return p}if(a&&R.filter===a){return R.filter(Q,P)}K(R,function(U,S,T){if(Q.call(P,U,S,T)){p[p.length]=U}});return p};O.reject=function(R,Q,P){var p=[];if(R==null){return p}K(R,function(U,S,T){if(!Q.call(P,U,S,T)){p[p.length]=U}});return p};O.every=O.all=function(R,Q,P){Q||(Q=O.identity);var p=true;if(R==null){return p}if(C&&R.every===C){return R.every(Q,P)}K(R,function(U,S,T){if(!(p=p&&Q.call(P,U,S,T))){return F}});return !!p};var A=O.some=O.any=function(R,Q,P){Q||(Q=O.identity);var p=false;if(R==null){return p}if(o&&R.some===o){return R.some(Q,P)}K(R,function(U,S,T){if(p||(p=Q.call(P,U,S,T))){return F}});return !!p};O.include=O.contains=function(Q,P){var p=false;if(Q==null){return p}if(m&&Q.indexOf===m){return Q.indexOf(P)!=-1}p=A(Q,function(R){return R===P});return p};O.invoke=function(P,Q){var p=n.call(arguments,2);return O.map(P,function(R){return(O.isFunction(Q)?Q||R:R[Q]).apply(R,p)})};O.pluck=function(P,p){return O.map(P,function(Q){return Q[p]})};O.max=function(R,Q,P){if(!Q&&O.isArray(R)&&R[0]===+R[0]){return Math.max.apply(Math,R)}if(!Q&&O.isEmpty(R)){return -Infinity}var p={computed:-Infinity};K(R,function(V,S,U){var T=Q?Q.call(P,V,S,U):V;T>=p.computed&&(p={value:V,computed:T})});return p.value};O.min=function(R,Q,P){if(!Q&&O.isArray(R)&&R[0]===+R[0]){return Math.min.apply(Math,R)}if(!Q&&O.isEmpty(R)){return Infinity}var p={computed:Infinity};K(R,function(V,S,U){var T=Q?Q.call(P,V,S,U):V;T<p.computed&&(p={value:V,computed:T})});return p.value};O.shuffle=function(Q){var p=[],P;K(Q,function(T,R,S){P=Math.floor(Math.random()*(R+1));p[R]=p[P];p[P]=T});return p};O.sortBy=function(Q,R,p){var P=O.isFunction(R)?R:function(S){return S[R]};return O.pluck(O.map(Q,function(U,S,T){return{value:U,criteria:P.call(p,U,S,T)}}).sort(function(V,U){var T=V.criteria,S=U.criteria;if(T===void 0){return 1}if(S===void 0){return -1}return T<S?-1:T>S?1:0}),"value")};O.groupBy=function(Q,R){var p={};var P=O.isFunction(R)?R:function(S){return S[R]};K(Q,function(U,S){var T=P(U,S);(p[T]||(p[T]=[])).push(U)});return p};O.sortedIndex=function(T,S,Q){Q||(Q=O.identity);var p=0,R=T.length;while(p<R){var P=(p+R)>>1;Q(T[P])<Q(S)?p=P+1:R=P}return p};O.toArray=function(p){if(!p){return[]}if(O.isArray(p)){return n.call(p)}if(O.isArguments(p)){return n.call(p)}if(p.toArray&&O.isFunction(p.toArray)){return p.toArray()}return O.values(p)};O.size=function(p){return O.isArray(p)?p.length:O.keys(p).length};O.first=O.head=O.take=function(Q,P,p){return(P!=null)&&!p?n.call(Q,0,P):Q[0]};O.initial=function(Q,P,p){return n.call(Q,0,Q.length-((P==null)||p?1:P))};O.last=function(Q,P,p){if((P!=null)&&!p){return n.call(Q,Math.max(Q.length-P,0))}else{return Q[Q.length-1]}};O.rest=O.tail=function(Q,p,P){return n.call(Q,(p==null)||P?1:p)};O.compact=function(p){return O.filter(p,function(P){return !!P})};O.flatten=function(P,p){return O.reduce(P,function(Q,R){if(O.isArray(R)){return Q.concat(p?R:O.flatten(R))}Q[Q.length]=R;return Q},[])};O.without=function(p){return O.difference(p,n.call(arguments,1))};O.uniq=O.unique=function(S,R,Q){var p=Q?O.map(S,Q):S;var P=[];if(S.length<3){R=true}O.reduce(p,function(T,V,U){if(R?O.last(T)!==V||!T.length:!O.include(T,V)){T.push(V);P.push(S[U])}return T},[]);return P};O.union=function(){return O.uniq(O.flatten(arguments,true))};O.intersection=O.intersect=function(P){var p=n.call(arguments,1);return O.filter(O.uniq(P),function(Q){return O.every(p,function(R){return O.indexOf(R,Q)>=0})})};O.difference=function(P){var p=O.flatten(n.call(arguments,1),true);return O.filter(P,function(Q){return !O.include(p,Q)})};O.zip=function(){var p=n.call(arguments);var R=O.max(O.pluck(p,"length"));var Q=new Array(R);for(var P=0;P<R;P++){Q[P]=O.pluck(p,""+P)}return Q};O.indexOf=function(S,Q,R){if(S==null){return -1}var P,p;if(R){P=O.sortedIndex(S,Q);return S[P]===Q?P:-1}if(m&&S.indexOf===m){return S.indexOf(Q)}for(P=0,p=S.length;P<p;P++){if(P in S&&S[P]===Q){return P}}return -1};O.lastIndexOf=function(Q,P){if(Q==null){return -1}if(l&&Q.lastIndexOf===l){return Q.lastIndexOf(P)}var p=Q.length;while(p--){if(p in Q&&Q[p]===P){return p}}return -1};O.range=function(T,R,S){if(arguments.length<=1){R=T||0;T=0}S=arguments[2]||1;var P=Math.max(Math.ceil((R-T)/S),0);var p=0;var Q=new Array(P);while(p<P){Q[p++]=T;T+=S}return Q};var I=function(){};O.bind=function d(R,P){var Q,p;if(R.bind===H&&H){return H.apply(R,n.call(arguments,1))}if(!O.isFunction(R)){throw new TypeError}p=n.call(arguments,2);return Q=function(){if(!(this instanceof Q)){return R.apply(P,p.concat(n.call(arguments)))}I.prototype=R.prototype;var T=new I;var S=R.apply(T,p.concat(n.call(arguments)));if(Object(S)===S){return S}return T}};O.bindAll=function(P){var p=n.call(arguments,1);if(p.length==0){p=O.functions(P)}K(p,function(Q){P[Q]=O.bind(P[Q],P)});return P};O.memoize=function(Q,P){var p={};P||(P=O.identity);return function(){var R=P.apply(this,arguments);return O.has(p,R)?p[R]:(p[R]=Q.apply(this,arguments))}};O.delay=function(P,Q){var p=n.call(arguments,2);return setTimeout(function(){return P.apply(null,p)},Q)};O.defer=function(p){return O.delay.apply(O,[p,1].concat(n.call(arguments,1)))};O.throttle=function(Q,R){var P,T,U,V,S,W;var p=O.debounce(function(){S=V=false},R);return function(){P=this;T=arguments;var X=function(){U=null;if(S){Q.apply(P,T)}p()};if(!U){U=setTimeout(X,R)}if(V){S=true}else{W=Q.apply(P,T)}p();V=true;return W}};O.debounce=function(P,R,p){var Q;return function(){var U=this,T=arguments;var S=function(){Q=null;if(!p){P.apply(U,T)}};if(p&&!Q){P.apply(U,T)}clearTimeout(Q);Q=setTimeout(S,R)}};O.once=function(Q){var p=false,P;return function(){if(p){return P}p=true;return P=Q.apply(this,arguments)}};O.wrap=function(p,P){return function(){var Q=[p].concat(n.call(arguments,0));return P.apply(this,Q)}};O.compose=function(){var p=arguments;return function(){var P=arguments;for(var Q=p.length-1;Q>=0;Q--){P=[p[Q].apply(this,P)]}return P[0]}};O.after=function(P,p){if(P<=0){return p()}return function(){if(--P<1){return p.apply(this,arguments)}}};O.keys=e||function(Q){if(Q!==Object(Q)){throw new TypeError("Invalid object")}var P=[];for(var p in Q){if(O.has(Q,p)){P[P.length]=p}}return P};O.values=function(p){return O.map(p,O.identity)};O.functions=O.methods=function(Q){var P=[];for(var p in Q){if(O.isFunction(Q[p])){P.push(p)}}return P.sort()};O.extend=function(p){K(n.call(arguments,1),function(P){for(var Q in P){p[Q]=P[Q]}});return p};O.pick=function(P){var p={};K(O.flatten(n.call(arguments,1)),function(Q){if(Q in P){p[Q]=P[Q]}});return p};O.defaults=function(p){K(n.call(arguments,1),function(P){for(var Q in P){if(p[Q]==null){p[Q]=P[Q]}}});return p};O.clone=function(p){if(!O.isObject(p)){return p}return O.isArray(p)?p.slice():O.extend({},p)};O.tap=function(P,p){p(P);return P};function L(R,Q,P){if(R===Q){return R!==0||1/R==1/Q}if(R==null||Q==null){return R===Q}if(R._chain){R=R._wrapped}if(Q._chain){Q=Q._wrapped}if(R.isEqual&&O.isFunction(R.isEqual)){return R.isEqual(Q)}if(Q.isEqual&&O.isFunction(Q.isEqual)){return Q.isEqual(R)}var U=c.call(R);if(U!=c.call(Q)){return false}switch(U){case"[object String]":return R==String(Q);case"[object Number]":return R!=+R?Q!=+Q:(R==0?1/R==1/Q:R==+Q);case"[object Date]":case"[object Boolean]":return +R==+Q;case"[object RegExp]":return R.source==Q.source&&R.global==Q.global&&R.multiline==Q.multiline&&R.ignoreCase==Q.ignoreCase}if(typeof R!="object"||typeof Q!="object"){return false}var V=P.length;while(V--){if(P[V]==R){return true}}P.push(R);var T=0,p=true;if(U=="[object Array]"){T=R.length;p=T==Q.length;if(p){while(T--){if(!(p=T in R==T in Q&&L(R[T],Q[T],P))){break}}}}else{if("constructor" in R!="constructor" in Q||R.constructor!=Q.constructor){return false}for(var S in R){if(O.has(R,S)){T++;if(!(p=O.has(Q,S)&&L(R[S],Q[S],P))){break}}}if(p){for(S in Q){if(O.has(Q,S)&&!(T--)){break}}p=!T}}P.pop();return p}O.isEqual=function(P,p){return L(P,p,[])};O.isEmpty=function(P){if(P==null){return true}if(O.isArray(P)||O.isString(P)){return P.length===0}for(var p in P){if(O.has(P,p)){return false}}return true};O.isElement=function(p){return !!(p&&p.nodeType==1)};O.isArray=u||function(p){return c.call(p)=="[object Array]"};O.isObject=function(p){return p===Object(p)};O.isArguments=function(p){return c.call(p)=="[object Arguments]"};if(!O.isArguments(arguments)){O.isArguments=function(p){return !!(p&&O.has(p,"callee"))}}O.isFunction=function(p){return c.call(p)=="[object Function]"};O.isString=function(p){return c.call(p)=="[object String]"};O.isNumber=function(p){return c.call(p)=="[object Number]"};O.isFinite=function(p){return O.isNumber(p)&&isFinite(p)};O.isNaN=function(p){return p!==p};O.isBoolean=function(p){return p===true||p===false||c.call(p)=="[object Boolean]"};O.isDate=function(p){return c.call(p)=="[object Date]"};O.isRegExp=function(p){return c.call(p)=="[object RegExp]"};O.isNull=function(p){return p===null};O.isUndefined=function(p){return p===void 0};O.has=function(P,p){return h.call(P,p)};O.noConflict=function(){x._=k;return this};O.identity=function(p){return p};O.times=function(R,Q,P){for(var p=0;p<R;p++){Q.call(P,p)}};O.escape=function(p){return(""+p).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};O.result=function(p,Q){if(p==null){return null}var P=p[Q];return O.isFunction(P)?P.call(p):P};O.mixin=function(p){K(O.functions(p),function(P){y(P,O[P]=p[P])})};var z=0;O.uniqueId=function(p){var P=z++;return p?p+P:P};O.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var w=/.^/;var g={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(var J in g){g[g[J]]=J}var j=/\\|'|\r|\n|\t|\u2028|\u2029/g;var D=/\\(\\|'|r|n|t|u2028|u2029)/g;var M=function(p){return p.replace(D,function(P,Q){return g[Q]})};O.template=function(T,S,Q){Q=O.defaults(Q||{},O.templateSettings);var R="__p+='"+T.replace(j,function(U){return"\\"+g[U]}).replace(Q.escape||w,function(U,V){return"'+\n_.escape("+M(V)+")+\n'"}).replace(Q.interpolate||w,function(U,V){return"'+\n("+M(V)+")+\n'"}).replace(Q.evaluate||w,function(U,V){return"';\n"+M(V)+"\n;__p+='"})+"';\n";if(!Q.variable){R="with(obj||{}){\n"+R+"}\n"}R="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+R+"return __p;\n";var P=new Function(Q.variable||"obj","_",R);if(S){return P(S,O)}var p=function(U){return P.call(this,U,O)};p.source="function("+(Q.variable||"obj")+"){\n"+R+"}";return p};O.chain=function(p){return O(p).chain()};var v=function(p){this._wrapped=p};O.prototype=v.prototype;var t=function(P,p){return p?O(P).chain():P};var y=function(p,P){v.prototype[p]=function(){var Q=n.call(arguments);B.call(Q,this._wrapped);return t(P.apply(O,Q),this._chain)}};O.mixin(O);K(["pop","push","reverse","shift","sort","splice","unshift"],function(p){var P=E[p];v.prototype[p]=function(){var Q=this._wrapped;P.apply(Q,arguments);var R=Q.length;if((p=="shift"||p=="splice")&&R===0){delete Q[0]}return t(Q,this._chain)}});K(["concat","join","slice"],function(p){var P=E[p];v.prototype[p]=function(){return t(P.apply(this._wrapped,arguments),this._chain)}});v.prototype.chain=function(){this._chain=true;return this};v.prototype.value=function(){return this._wrapped}}).call(this);(function(aU){function aT(d,c){return function(a){return aK(d.call(this,a),c)}}function aS(d,c){return function(a){return this.lang().ordinal(d.call(this,a),c)}}function aR(){}function aO(b){av(b),aM(this,b)}function aN(u){var t=aB(u),s=t.year||0,q=t.month||0,p=t.week||0,o=t.day||0,n=t.hour||0,m=t.minute||0,l=t.second||0,k=t.millisecond||0;this._input=u,this._milliseconds=+k+1000*l+60000*m+3600000*n,this._days=+o+7*p,this._months=+q+12*s,this._data={},this._bubble()}function aM(e,d){for(var f in d){d.hasOwnProperty(f)&&(e[f]=d[f])}return d.hasOwnProperty("toString")&&(e.toString=d.toString),d.hasOwnProperty("valueOf")&&(e.valueOf=d.valueOf),e}function aL(b){return 0>b?Math.ceil(b):Math.floor(b)}function aK(e,d){for(var f=e+"";f.length<d;){f="0"+f}return f}function aH(s,q,p,o){var n,m,l=q._milliseconds,k=q._days,j=q._months;l&&s._d.setTime(+s._d+l*p),(k||j)&&(n=s.minute(),m=s.hour()),k&&s.date(s.date()+k*p),j&&s.month(s.month()+j*p),l&&!o&&a8.updateOffset(s),(k||j)&&(s.minute(n),s.hour(m))}function aG(b){return"[object Array]"===Object.prototype.toString.call(b)}function aF(b){return"[object Date]"===Object.prototype.toString.call(b)||b instanceof Date}function aE(j,h,o){var n,m=Math.min(j.length,h.length),l=Math.abs(j.length-h.length),k=0;for(n=0;m>n;n++){(o&&j[n]!==h[n]||!o&&az(j[n])!==az(h[n]))&&k++}return k+l}function aD(d){if(d){var c=d.toLowerCase().replace(/(.)s$/,"$1");d=am[d]||ag[c]||c}return d}function aB(f){var e,h,g={};for(h in f){f.hasOwnProperty(h)&&(e=aD(h),e&&(g[e]=f[h]))}return g}function aA(a){var f,e;if(0===a.indexOf("week")){f=7,e="day"}else{if(0!==a.indexOf("month")){return}f=12,e="month"}a8[a]=function(m,l){var k,d,c=a8.fn._lang[a],b=[];if("number"==typeof m&&(l=m,m=aU),d=function(h){var g=a8().utc().set(e,h);return c.call(a8.fn._lang,g,m||"")},null!=l){return d(l)}for(k=0;f>k;k++){b.push(d(k))}return b}}function az(e){var d=+e,f=0;return 0!==d&&isFinite(d)&&(f=d>=0?Math.floor(d):Math.ceil(d)),f}function ay(d,c){return new Date(Date.UTC(d,c+1,0)).getUTCDate()}function ax(b){return aw(b)?366:365}function aw(b){return 0===b%4&&0!==b%100||0===b%400}function av(d){var c;d._a&&-2===d._pf.overflow&&(c=d._a[by]<0||d._a[by]>11?by:d._a[bg]<1||d._a[bg]>ay(d._a[bG],d._a[by])?bg:d._a[aI]<0||d._a[aI]>23?aI:d._a[aj]<0||d._a[aj]>59?aj:d._a[ad]<0||d._a[ad]>59?ad:d._a[bI]<0||d._a[bI]>999?bI:-1,d._pf._overflowDayOfYear&&(bG>c||c>bg)&&(c=bg),d._pf.overflow=c)}function au(b){b._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function at(b){return null==b._isValid&&(b._isValid=!isNaN(b._d.getTime())&&b._pf.overflow<0&&!b._pf.empty&&!b._pf.invalidMonth&&!b._pf.nullInput&&!b._pf.invalidFormat&&!b._pf.userInvalidated,b._strict&&(b._isValid=b._isValid&&0===b._pf.charsLeftOver&&0===b._pf.unusedTokens.length)),b._isValid}function ar(b){return b?b.toLowerCase().replace("_","-"):b}function aq(d,c){return c.abbr=d,bA[d]||(bA[d]=new aR),bA[d].set(c),bA[d]}function ap(b){delete bA[b]}function bu(j){var h,o,n,m,l=0,k=function(d){if(!bA[d]&&bn){try{require("./lang/"+d)}catch(c){}}return bA[d]};if(!j){return a8.fn._lang}if(!aG(j)){if(o=k(j)){return o}j=[j]}for(;l<j.length;){for(m=ar(j[l]).split("-"),h=m.length,n=ar(j[l+1]),n=n?n.split("-"):null;h>0;){if(o=k(m.slice(0,h).join("-"))){return o}if(n&&n.length>=h&&aE(m,n,!0)>=h-1){break}h--}l++}return a8.fn._lang}function bs(b){return b.match(/\[[\s\S]/)?b.replace(/^\[|\]$/g,""):b.replace(/\\/g,"")}function br(f){var e,h,g=f.match(bK);for(e=0,h=g.length;h>e;e++){g[e]=aW[g[e]]?aW[g[e]]:bs(g[e])}return function(b){var a="";for(e=0;h>e;e++){a+=g[e] instanceof Function?g[e].call(b,f):g[e]}return a}}function bq(d,c){return d.isValid()?(c=bp(c,d.lang()),bL[c]||(bL[c]=br(c)),bL[c](d)):d.lang().invalidDate()}function bp(f,e){function h(b){return e.longDateFormat(b)||b}var g=5;for(bD.lastIndex=0;g>=0&&bD.test(f);){f=f.replace(bD,h),bD.lastIndex=0,g-=1}return f}function bm(e,d){var f;switch(e){case"DDDD":return an;case"YYYY":case"GGGG":case"gggg":return ah;case"YYYYY":case"GGGGG":case"ggggg":return aa;case"S":case"SS":case"SSS":case"DDD":return aV;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return bw;case"a":case"A":return bu(d._l)._meridiemParse;case"X":return bh;case"Z":case"ZZ":return bH;case"T":return bz;case"SSSS":return bF;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"ww":case"W":case"WW":case"e":case"E":return bt;default:return f=new RegExp(bc(bd(e.replace("\\","")),"i"))}}function bl(f){var e=(bH.exec(f)||[])[0],h=(e+"").match(bB)||["-",0,0],g=+(60*h[1])+az(h[2]);return"+"===h[0]?-g:g}function bk(g,f,k){var j,h=k._a;switch(g){case"M":case"MM":null!=f&&(h[by]=az(f)-1);break;case"MMM":case"MMMM":j=bu(k._l).monthsParse(f),null!=j?h[by]=j:k._pf.invalidMonth=f;break;case"D":case"DD":null!=f&&(h[bg]=az(f));break;case"DDD":case"DDDD":null!=f&&(k._dayOfYear=az(f));break;case"YY":h[bG]=az(f)+(az(f)>68?1900:2000);break;case"YYYY":case"YYYYY":h[bG]=az(f);break;case"a":case"A":k._isPm=bu(k._l).isPM(f);break;case"H":case"HH":case"h":case"hh":h[aI]=az(f);break;case"m":case"mm":h[aj]=az(f);break;case"s":case"ss":h[ad]=az(f);break;case"S":case"SS":case"SSS":case"SSSS":h[bI]=az(1000*("0."+f));break;case"X":k._d=new Date(1000*parseFloat(f));break;case"Z":case"ZZ":k._useUTC=!0,k._tzm=bl(f);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":g=g.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":g=g.substr(0,2),f&&(k._w=k._w||{},k._w[g]=f)}}function bj(y){var x,w,v,u,t,s,q,p,o,n,m=[];if(!y._d){for(v=bf(y),y._w&&null==y._a[bg]&&null==y._a[by]&&(t=function(a){return a?a.length<3?parseInt(a,10)>68?"19"+a:"20"+a:a:null==y._a[bG]?a8().weekYear():y._a[bG]},s=y._w,null!=s.GG||null!=s.W||null!=s.E?q=a0(t(s.GG),s.W||1,s.E,4,1):(p=bu(y._l),o=null!=s.d?a4(s.d,p):null!=s.e?parseInt(s.e,10)+p._week.dow:0,n=parseInt(s.w,10)||1,null!=s.d&&o<p._week.dow&&n++,q=a0(t(s.gg),n,o,p._week.doy,p._week.dow)),y._a[bG]=q.year,y._dayOfYear=q.dayOfYear),y._dayOfYear&&(u=null==y._a[bG]?v[bG]:y._a[bG],y._dayOfYear>ax(u)&&(y._pf._overflowDayOfYear=!0),w=a5(u,0,y._dayOfYear),y._a[by]=w.getUTCMonth(),y._a[bg]=w.getUTCDate()),x=0;3>x&&null==y._a[x];++x){y._a[x]=m[x]=v[x]}for(;7>x;x++){y._a[x]=m[x]=null==y._a[x]?2===x?1:0:y._a[x]}m[aI]+=az((y._tzm||0)/60),m[aj]+=az((y._tzm||0)%60),y._d=(y._useUTC?a5:a6).apply(null,m)}}function bi(d){var c;d._d||(c=aB(d._i),d._a=[c.year,c.month,c.day,c.hour,c.minute,c.second,c.millisecond],bj(d))}function bf(d){var c=new Date;return d._useUTC?[c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()]:[c.getFullYear(),c.getMonth(),c.getDate()]}function be(u){u._a=[],u._pf.empty=!0;var t,s,q,p,o,n=bu(u._l),m=""+u._i,l=m.length,k=0;for(q=bp(u._f,n).match(bK)||[],t=0;t<q.length;t++){p=q[t],s=(bm(p,u).exec(m)||[])[0],s&&(o=m.substr(0,m.indexOf(s)),o.length>0&&u._pf.unusedInput.push(o),m=m.slice(m.indexOf(s)+s.length),k+=s.length),aW[p]?(s?u._pf.empty=!1:u._pf.unusedTokens.push(p),bk(p,s,u)):u._strict&&!s&&u._pf.unusedTokens.push(p)}u._pf.charsLeftOver=l-k,m.length>0&&u._pf.unusedInput.push(m),u._isPm&&u._a[aI]<12&&(u._a[aI]+=12),u._isPm===!1&&12===u._a[aI]&&(u._a[aI]=0),bj(u),av(u)}function bd(b){return b.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(g,f,k,j,h){return f||k||j||h})}function bc(b){return b.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ba(h){var g,m,l,k,j;if(0===h._f.length){return h._pf.invalidFormat=!0,h._d=new Date(0/0),void 0}for(k=0;k<h._f.length;k++){j=0,g=aM({},h),au(g),g._f=h._f[k],be(g),at(g)&&(j+=g._pf.charsLeftOver,j+=10*g._pf.unusedTokens.length,g._pf.score=j,(null==l||l>j)&&(l=j,m=g))}aM(h,m||g)}function a9(f){var e,h=f._i,g=aJ.exec(h);if(g){for(f._pf.iso=!0,e=4;e>0;e--){if(g[e]){f._f=ae[e-1]+(g[6]||" ");break}}for(e=0;4>e;e++){if(bJ[e][1].exec(h)){f._f+=bJ[e][0];break}}bH.exec(h)&&(f._f+="Z"),be(f)}else{f._d=new Date(h)}}function a7(a){var f=a._i,e=aP.exec(f);f===aU?a._d=new Date:e?a._d=new Date(+e[1]):"string"==typeof f?a9(a):aG(f)?(a._a=f.slice(0),bj(a)):aF(f)?a._d=new Date(+f):"object"==typeof f?bi(a):a._d=new Date(f)}function a6(k,j,q,p,o,n,m){var l=new Date(k,j,q,p,o,n,m);return 1970>k&&l.setFullYear(k),l}function a5(d){var c=new Date(Date.UTC.apply(null,arguments));return 1970>d&&c.setUTCFullYear(d),c}function a4(d,c){if("string"==typeof d){if(isNaN(d)){if(d=c.weekdaysParse(d),"number"!=typeof d){return null}}else{d=parseInt(d,10)}}return d}function a3(g,f,k,j,h){return h.relativeTime(f||1,!!k,g,j)}function a2(s,q,p){var o=ac(Math.abs(s)/1000),n=ac(o/60),m=ac(n/60),l=ac(m/24),k=ac(l/365),j=45>o&&["s",o]||1===n&&["m"]||45>n&&["mm",n]||1===m&&["h"]||22>m&&["hh",m]||1===l&&["d"]||25>=l&&["dd",l]||45>=l&&["M"]||345>l&&["MM",ac(l/30)]||1===k&&["y"]||["yy",k];return j[2]=q,j[3]=s>0,j[4]=p,a3.apply({},j)}function a1(h,g,m){var l,k=m-g,j=m-h.day();return j>k&&(j-=7),k-7>j&&(j+=7),l=a8(h).add("d",j),{week:Math.ceil(l.dayOfYear()/7),year:l.year()}}function a0(k,j,q,p,o){var n,m,l=new Date(Date.UTC(k,0)).getUTCDay();return q=null!=q?q:o,n=o-l+(l>p?7:0),m=7*(j-1)+(q-o)+n+1,{year:m>0?k:k-1,dayOfYear:m>0?m:ax(k-1)+m}}function aZ(e){var d=e._i,f=e._f;return"undefined"==typeof e._pf&&au(e),null===d?a8.invalid({nullInput:!0}):("string"==typeof d&&(e._i=d=bu().preparse(d)),a8.isMoment(d)?(e=aM({},d),e._d=new Date(+d._d)):f?aG(f)?ba(e):be(e):a7(e),new aO(e))}function aY(d,c){a8.fn[d]=a8.fn[d+"s"]=function(b){var e=this._isUTC?"UTC":"";return null!=b?(this._d["set"+e+c](b),a8.updateOffset(this),this):this._d["get"+e+c]()}}function bC(b){a8.duration.fn[b]=function(){return this._data[b]}}function aX(d,c){a8.duration.fn["as"+d]=function(){return +this/c}}function bx(e){var d=!1,f=a8;"undefined"==typeof ender&&(this.moment=e?function(){return !d&&console&&console.warn&&(d=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),f.apply(null,arguments)}:a8)}for(var a8,aC,ai="2.4.0",ac=Math.round,bG=0,by=1,bg=2,aI=3,aj=4,ad=5,bI=6,bA={},bn="undefined"!=typeof module&&module.exports,aP=/^\/?Date\((\-?\d+)/i,al=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,af=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,bK=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,bD=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,bt=/\d\d?/,aV=/\d{1,3}/,an=/\d{3}/,ah=/\d{1,4}/,aa=/[+\-]?\d{1,6}/,bF=/\d+/,bw=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,bH=/Z|[\+\-]\d\d:?\d\d/i,bz=/T/i,bh=/[\+\-]?\d+(\.\d{1,3})?/,aJ=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d:?\d\d|Z)?)?$/,ak="YYYY-MM-DDTHH:mm:ssZ",ae=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],bJ=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],bB=/([\+\-]|\d\d)/gi,bo="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),aQ={Milliseconds:1,Seconds:1000,Minutes:60000,Hours:3600000,Days:86400000,Months:2592000000,Years:31536000000},am={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},ag={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},bL={},bE="DDD w W M D d".split(" "),bv="M D H h m s w W".split(" "),aW={M:function(){return this.month()+1},MMM:function(b){return this.lang().monthsShort(this,b)},MMMM:function(b){return this.lang().months(this,b)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(b){return this.lang().weekdaysMin(this,b)},ddd:function(b){return this.lang().weekdaysShort(this,b)},dddd:function(b){return this.lang().weekdays(this,b)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return aK(this.year()%100,2)},YYYY:function(){return aK(this.year(),4)},YYYYY:function(){return aK(this.year(),5)},gg:function(){return aK(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return aK(this.weekYear(),5)},GG:function(){return aK(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return aK(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return az(this.milliseconds()/100)},SS:function(){return aK(az(this.milliseconds()/10),2)},SSS:function(){return aK(this.milliseconds(),3)},SSSS:function(){return aK(this.milliseconds(),3)},Z:function(){var d=-this.zone(),c="+";return 0>d&&(d=-d,c="-"),c+aK(az(d/60),2)+":"+aK(az(d)%60,2)},ZZ:function(){var d=-this.zone(),c="+";return 0>d&&(d=-d,c="-"),c+aK(az(10*d/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}},ao=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];bE.length;){aC=bE.pop(),aW[aC+"o"]=aS(aW[aC],aC)}for(;bv.length;){aC=bv.pop(),aW[aC+aC]=aT(aW[aC],2)}for(aW.DDDD=aT(aW.DDD,3),aM(aR.prototype,{set:function(e){var d,f;for(f in e){d=e[f],"function"==typeof d?this[f]=d:this["_"+f]=d}},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(b){return this._months[b.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(b){return this._monthsShort[b.month()]},monthsParse:function(f){var e,h,g;for(this._monthsParse||(this._monthsParse=[]),e=0;12>e;e++){if(this._monthsParse[e]||(h=a8.utc([2000,e]),g="^"+this.months(h,"")+"|^"+this.monthsShort(h,""),this._monthsParse[e]=new RegExp(g.replace(".",""),"i")),this._monthsParse[e].test(f)){return e}}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(b){return this._weekdays[b.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(b){return this._weekdaysShort[b.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(b){return this._weekdaysMin[b.day()]},weekdaysParse:function(f){var e,h,g;for(this._weekdaysParse||(this._weekdaysParse=[]),e=0;7>e;e++){if(this._weekdaysParse[e]||(h=a8([2000,1]).day(e),g="^"+this.weekdays(h,"")+"|^"+this.weekdaysShort(h,"")+"|^"+this.weekdaysMin(h,""),this._weekdaysParse[e]=new RegExp(g.replace(".",""),"i")),this._weekdaysParse[e].test(f)){return e}}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(d){var c=this._longDateFormat[d];return !c&&this._longDateFormat[d.toUpperCase()]&&(c=this._longDateFormat[d.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(b){return b.slice(1)}),this._longDateFormat[d]=c),c},isPM:function(b){return"p"===(b+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,d,f){return e>11?f?"pm":"PM":f?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,d){var f=this._calendar[e];return"function"==typeof f?f.apply(d):f},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(g,f,k,j){var h=this._relativeTime[k];return"function"==typeof h?h(g,f,k,j):h.replace(/%d/i,g)},pastFuture:function(e,d){var f=this._relativeTime[e>0?"future":"past"];return"function"==typeof f?f(d):f.replace(/%s/i,d)},ordinal:function(b){return this._ordinal.replace("%d",b)},_ordinal:"%d",preparse:function(b){return b},postformat:function(b){return b},week:function(b){return a1(b,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),a8=function(a,h,g,f){return"boolean"==typeof g&&(f=g,g=aU),aZ({_i:a,_f:h,_l:g,_strict:f,_isUTC:!1})},a8.utc=function(a,k,j,h){var g;return"boolean"==typeof j&&(h=j,j=aU),g=aZ({_useUTC:!0,_isUTC:!0,_l:j,_i:a,_f:k,_strict:h}).utc()},a8.unix=function(b){return a8(1000*b)},a8.duration=function(s,q){var p,o,n,m=a8.isDuration(s),l="number"==typeof s,k=m?s._input:l?{}:s,f=null;return l?q?k[q]=s:k.milliseconds=s:(f=al.exec(s))?(p="-"===f[1]?-1:1,k={y:0,d:az(f[bg])*p,h:az(f[aI])*p,m:az(f[aj])*p,s:az(f[ad])*p,ms:az(f[bI])*p}):(f=af.exec(s))&&(p="-"===f[1]?-1:1,n=function(d){var c=d&&parseFloat(d.replace(",","."));return(isNaN(c)?0:c)*p},k={y:n(f[2]),M:n(f[3]),d:n(f[4]),h:n(f[5]),m:n(f[6]),s:n(f[7]),w:n(f[8])}),o=new aN(k),m&&s.hasOwnProperty("_lang")&&(o._lang=s._lang),o},a8.version=ai,a8.defaultFormat=ak,a8.updateOffset=function(){},a8.lang=function(e,d){var f;return e?(d?aq(ar(e),d):null===d?(ap(e),e="en"):bA[e]||bu(e),f=a8.duration.fn._lang=a8.fn._lang=bu(e),f._abbr):a8.fn._lang._abbr},a8.langData=function(b){return b&&b._lang&&b._lang._abbr&&(b=b._lang._abbr),bu(b)},a8.isMoment=function(b){return b instanceof aO},a8.isDuration=function(b){return b instanceof aN},aC=ao.length-1;aC>=0;--aC){aA(ao[aC])}for(a8.normalizeUnits=function(b){return aD(b)},a8.invalid=function(d){var c=a8.utc(0/0);return null!=d?aM(c._pf,d):c._pf.userInvalidated=!0,c},a8.parseZone=function(b){return a8(b).parseZone()},aM(a8.fn=aO.prototype,{clone:function(){return a8(this)},valueOf:function(){return +this._d+60000*(this._offset||0)},unix:function(){return Math.floor(+this/1000)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return bq(a8(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var b=this;return[b.year(),b.month(),b.date(),b.hours(),b.minutes(),b.seconds(),b.milliseconds()]},isValid:function(){return at(this)},isDSTShifted:function(){return this._a?this.isValid()&&aE(this._a,(this._isUTC?a8.utc(this._a):a8(this._a)).toArray())>0:!1},parsingFlags:function(){return aM({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(d){var c=bq(this,d||a8.defaultFormat);return this.lang().postformat(c)},add:function(e,d){var f;return f="string"==typeof e?a8.duration(+d,e):a8.duration(e,d),aH(this,f,1),this},subtract:function(e,d){var f;return f="string"==typeof e?a8.duration(+d,e):a8.duration(e,d),aH(this,f,-1),this},diff:function(j,h,o){var n,m,l=this._isUTC?a8(j).zone(this._offset||0):a8(j).local(),k=60000*(this.zone()-l.zone());return h=aD(h),"year"===h||"month"===h?(n=43200000*(this.daysInMonth()+l.daysInMonth()),m=12*(this.year()-l.year())+(this.month()-l.month()),m+=(this-a8(this).startOf("month")-(l-a8(l).startOf("month")))/n,m-=60000*(this.zone()-a8(this).startOf("month").zone()-(l.zone()-a8(l).startOf("month").zone()))/n,"year"===h&&(m/=12)):(n=this-l,m="second"===h?n/1000:"minute"===h?n/60000:"hour"===h?n/3600000:"day"===h?(n-k)/86400000:"week"===h?(n-k)/604800000:n),o?m:aL(m)},from:function(d,c){return a8.duration(this.diff(d)).lang(this.lang()._abbr).humanize(!c)},fromNow:function(b){return this.from(a8(),b)},calendar:function(){var d=this.diff(a8().zone(this.zone()).startOf("day"),"days",!0),c=-6>d?"sameElse":-1>d?"lastWeek":0>d?"lastDay":1>d?"sameDay":2>d?"nextDay":7>d?"nextWeek":"sameElse";return this.format(this.lang().calendar(c,this))},isLeapYear:function(){return aw(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(d){var c=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=d?(d=a4(d,this.lang()),this.add({d:d-c})):c},month:function(e){var d,f=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&(e=this.lang().monthsParse(e),"number"!=typeof e)?this:(d=this.date(),this.date(1),this._d["set"+f+"Month"](e),this.date(Math.min(d,this.daysInMonth())),a8.updateOffset(this),this):this._d["get"+f+"Month"]()},startOf:function(b){switch(b=aD(b)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===b?this.weekday(0):"isoWeek"===b&&this.isoWeekday(1),this},endOf:function(b){return b=aD(b),this.startOf(b).add("isoWeek"===b?"week":b,1).subtract("ms",1)},isAfter:function(d,c){return c="undefined"!=typeof c?c:"millisecond",+this.clone().startOf(c)>+a8(d).startOf(c)},isBefore:function(d,c){return c="undefined"!=typeof c?c:"millisecond",+this.clone().startOf(c)<+a8(d).startOf(c)},isSame:function(d,c){return c="undefined"!=typeof c?c:"millisecond",+this.clone().startOf(c)===+a8(d).startOf(c)},min:function(b){return b=a8.apply(null,arguments),this>b?this:b},max:function(b){return b=a8.apply(null,arguments),b>this?this:b},zone:function(d){var c=this._offset||0;return null==d?this._isUTC?c:this._d.getTimezoneOffset():("string"==typeof d&&(d=bl(d)),Math.abs(d)<16&&(d=60*d),this._offset=d,this._isUTC=!0,c!==d&&aH(this,a8.duration(c-d,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(b){return b=b?a8(b).zone():0,0===(this.zone()-b)%60},daysInMonth:function(){return ay(this.year(),this.month())},dayOfYear:function(d){var c=ac((a8(this).startOf("day")-a8(this).startOf("year"))/86400000)+1;return null==d?c:this.add("d",d-c)},weekYear:function(d){var c=a1(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==d?c:this.add("y",d-c)},isoWeekYear:function(d){var c=a1(this,1,4).year;return null==d?c:this.add("y",d-c)},week:function(d){var c=this.lang().week(this);return null==d?c:this.add("d",7*(d-c))},isoWeek:function(d){var c=a1(this,1,4).week;return null==d?c:this.add("d",7*(d-c))},weekday:function(d){var c=(this.day()+7-this.lang()._week.dow)%7;return null==d?c:this.add("d",d-c)},isoWeekday:function(b){return null==b?this.day()||7:this.day(this.day()%7?b:b-7)},get:function(b){return b=aD(b),this[b]()},set:function(d,c){return d=aD(d),"function"==typeof this[d]&&this[d](c),this},lang:function(a){return a===aU?this._lang:(this._lang=bu(a),this)}}),aC=0;aC<bo.length;aC++){aY(bo[aC].toLowerCase().replace(/s$/,""),bo[aC])}aY("year","FullYear"),a8.fn.days=a8.fn.day,a8.fn.months=a8.fn.month,a8.fn.weeks=a8.fn.week,a8.fn.isoWeeks=a8.fn.isoWeek,a8.fn.toJSON=a8.fn.toISOString,aM(a8.duration.fn=aN.prototype,{_bubble:function(){var j,h,p,o,n=this._milliseconds,m=this._days,l=this._months,k=this._data;k.milliseconds=n%1000,j=aL(n/1000),k.seconds=j%60,h=aL(j/60),k.minutes=h%60,p=aL(h/60),k.hours=p%24,m+=aL(p/24),k.days=m%30,l+=aL(m/30),k.months=l%12,o=aL(l/12),k.years=o},weeks:function(){return aL(this.days()/7)},valueOf:function(){return this._milliseconds+86400000*this._days+2592000000*(this._months%12)+31536000000*az(this._months/12)},humanize:function(e){var d=+this,f=a2(d,!e,this.lang());return e&&(f=this.lang().pastFuture(d,f)),this.lang().postformat(f)},add:function(e,d){var f=a8.duration(e,d);return this._milliseconds+=f._milliseconds,this._days+=f._days,this._months+=f._months,this._bubble(),this},subtract:function(e,d){var f=a8.duration(e,d);return this._milliseconds-=f._milliseconds,this._days-=f._days,this._months-=f._months,this._bubble(),this},get:function(b){return b=aD(b),this[b.toLowerCase()+"s"]()},as:function(b){return b=aD(b),this["as"+b.charAt(0).toUpperCase()+b.slice(1)+"s"]()},lang:a8.fn.lang,toIsoString:function(){var h=Math.abs(this.years()),g=Math.abs(this.months()),m=Math.abs(this.days()),l=Math.abs(this.hours()),k=Math.abs(this.minutes()),j=Math.abs(this.seconds()+this.milliseconds()/1000);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(h?h+"Y":"")+(g?g+"M":"")+(m?m+"D":"")+(l||k||j?"T":"")+(l?l+"H":"")+(k?k+"M":"")+(j?j+"S":""):"P0D"}});for(aC in aQ){aQ.hasOwnProperty(aC)&&(aX(aC,aQ[aC]),bC(aC.toLowerCase()))}aX("Weeks",604800000),a8.duration.fn.asMonths=function(){return(+this-31536000000*this.years())/2592000000+12*this.years()},a8.lang("en",{ordinal:function(e){var d=e%10,f=1===az(e%100/10)?"th":1===d?"st":2===d?"nd":3===d?"rd":"th";return e+f}}),function(b){b(a8)}(function(b){return b.lang("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:"ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_S".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},ordinal:"%d",week:{dow:1,doy:4}})}),function(b){b(a8)}(function(d){function c(f,e,h,g){return g||e?"paari sekundi":"paar sekundit"}return d.lang("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:c,m:"minut",mm:"%d minutit",h:"tund",hh:"%d tundi",d:"pev",dd:"%d peva",M:"kuu",MM:"%d kuud",y:"aasta",yy:"%d aastat"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(b){b(a8)}(function(b){return b.lang("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(c){return c+(1===c?"er":"")},week:{dow:1,doy:4}})}),function(b){b(a8)}(function(e){var d={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},f={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.lang("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(b){return b.replace(/[]/g,function(c){return f[c]})},postformat:function(b){return b.replace(/\d/g,function(c){return d[c]})},meridiem:function(b){return 4>b?"":10>b?"":17>b?"":20>b?"":""},week:{dow:0,doy:6}})}),function(b){b(a8)}(function(b){return b.lang("it",{months:"Gennaio_Febbraio_Marzo_Aprile_Maggio_Giugno_Luglio_Agosto_Settembre_Ottobre_Novembre_Dicembre".split("_"),monthsShort:"Gen_Feb_Mar_Apr_Mag_Giu_Lug_Ago_Set_Ott_Nov_Dic".split("_"),weekdays:"Domenica_Luned_Marted_Mercoled_Gioved_Venerd_Sabato".split("_"),weekdaysShort:"Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"),weekdaysMin:"D_L_Ma_Me_G_V_S".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:"[lo scorso] dddd [alle] LT",sameElse:"L"},relativeTime:{future:function(c){return(/^[0-9].+$/.test(c)?"tra":"in")+" "+c},past:"%s fa",s:"secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:"%d",week:{dow:1,doy:4}})}),function(b){b(a8)}(function(e){var d="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),f="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_");return e.lang("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(b,c){return/-MMM-/.test(c)?f[b.month()]:d[b.month()]},weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),longDateFormat:{LT:"HH:mm",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},ordinal:function(b){return b+(1===b||8===b||b>=20?"ste":"de")},week:{dow:1,doy:4}})}),function(b){b(a8)}(function(b){return b.lang("pt",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Dom_2_3_4_5_6_Sb".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrs",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinal:"%d",week:{dow:1,doy:4}})}),function(b){b(a8)}(function(b){return b.lang("ro",{months:"Ianuarie_Februarie_Martie_Aprilie_Mai_Iunie_Iulie_August_Septembrie_Octombrie_Noiembrie_Decembrie".split("_"),monthsShort:"Ian_Feb_Mar_Apr_Mai_Iun_Iul_Aug_Sep_Oct_Noi_Dec".split("_"),weekdays:"Duminic_Luni_Mari_Miercuri_Joi_Vineri_Smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",m:"un minut",mm:"%d minute",h:"o or",hh:"%d ore",d:"o zi",dd:"%d zile",M:"o lun",MM:"%d luni",y:"un an",yy:"%d ani"},week:{dow:1,doy:7}})}),function(b){b(a8)}(function(h){function g(e,d){var f=e.split("_");return 1===d%10&&11!==d%100?f[0]:d%10>=2&&4>=d%10&&(10>d%100||d%100>=20)?f[1]:f[2]}function m(b,o,n){var f={mm:"__",hh:"__",dd:"__",MM:"__",yy:"__"};return"m"===n?o?"":"":b+" "+g(f[n],+b)}function l(f,e){var o={nominative:"___________".split("_"),accusative:"___________".split("_")},n=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(e)?"accusative":"nominative";return o[n][f.month()]}function k(f,e){var o={nominative:"___________".split("_"),accusative:"___________".split("_")},n=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(e)?"accusative":"nominative";return o[n][f.month()]}function j(f,e){var o={nominative:"______".split("_"),accusative:"______".split("_")},n=/\[ ?[] ?(?:|)? ?\] ?dddd/.test(e)?"accusative":"nominative";return o[n][f.day()]}return h.lang("ru",{months:l,monthsShort:k,weekdays:j,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:[/^/i,/^/i,/^/i,/^/i,/^[|]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., LT",LLLL:"dddd, D MMMM YYYY ., LT"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return 2===this.day()?"[] dddd [] LT":"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT";case 3:case 5:case 6:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:m,mm:m,h:"",hh:m,d:"",dd:m,M:"",MM:m,y:"",yy:m},meridiem:function(b){return 4>b?"":12>b?"":17>b?"":""},ordinal:function(d,c){switch(c){case"M":case"d":case"DDD":return d+"-";case"D":return d+"-";case"w":case"W":return d+"-";default:return d}},week:{dow:1,doy:7}})}),function(b){b(a8)}(function(b){return b.lang("zh",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"Ahmm",L:"YYYYMMMD",LL:"YYYYMMMD",LLL:"YYYYMMMDLT",LLLL:"YYYYMMMDddddLT",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMDLT",llll:"YYYYMMMDddddLT"},meridiem:function(e,d){var f=100*e+d;return 600>f?"":900>f?"":1130>f?"":1230>f?"":1800>f?"":""},calendar:{sameDay:function(){return 0===this.minutes()?"[]Ah[]":"[]LT"},nextDay:function(){return 0===this.minutes()?"[]Ah[]":"[]LT"},lastDay:function(){return 0===this.minutes()?"[]Ah[]":"[]LT"},nextWeek:function(){var a,d;return a=b().startOf("week"),d=this.unix()-a.unix()>=604800?"[]":"[]",0===this.minutes()?d+"dddAh":d+"dddAhmm"},lastWeek:function(){var a,d;return a=b().startOf("week"),d=this.unix()<a.unix()?"[]":"[]",0===this.minutes()?d+"dddAh":d+"dddAhmm"},sameElse:"L"},ordinal:function(d,c){switch(c){case"d":case"D":case"DDD":return d+"";case"M":return d+"";case"w":case"W":return d+"";default:return d}},relativeTime:{future:"%s",past:"%s",s:"",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"},week:{dow:1,doy:4}})}),a8.lang("en"),bn?(module.exports=a8,bx(!0)):"function"==typeof define&&define.amd?define("moment",function(a,f,e){return e.config().noGlobal!==!0&&bx(e.config().noGlobal===aU),a8}):bx()}).call(this);if(!blist){var blist={}}if(!blist.namespace){blist.namespace={}}blist.namespace.fetch=function(d){var c=d.split(".");var a=window;for(var b=0;b<c.length;b++){var e=c[b];if(!a[e]){a[e]={}}a=a[e]}return a};blist.inBrowser=true;(function(a){a.support.borderRadius=false;_.each(["BorderRadius","MozBorderRadius","WebkitBorderRadius","OBorderRadius","KhtmlBorderRadius"],function(c){if(document.body.style[c]!==undefined){a.support.borderRadius=true}});a.support.linearGradient=false;var b=document.createElement("div");b.style.cssText=["background-image:-webkit-gradient(linear, 0% 0%, 0% 100%, from(red), to(blue));","background-image:-moz-linear-gradient(top left, bottom right, from(red), to(blue));","background-image:-moz-linear-gradient(left, red, blue);"].join("");a.support.svg=window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");if(b.style.backgroundImage){a.support.linearGradient=true}a.device=a.device||{};if(navigator.userAgent.match(/iPad/i)!=null){a.device.ipad=true}if(navigator.userAgent.match(/(iPhone|iPod)/i)!=null){a.device.iphone=true}if(navigator.userAgent.match(/Android/i)!=null){a.device.android=true}if(a.device.iphone||a.device.android){a.device.mobile=true}if(!_.isFunction(Array.prototype.map)){Array.prototype.map=function(d,c){return _.map(c||this,d)}}if(!_.isFunction(Array.prototype.forEach)){Array.prototype.forEach=function(d,c){return _.each(c||this,d)}}if(!_.isFunction(Array.prototype.every)){Array.prototype.every=function(d,c){return _.all(c||this,d)}}if(typeof CSSStyleDeclaration!=="undefined"){if(!_.isFunction(CSSStyleDeclaration.prototype.getProperty)){CSSStyleDeclaration.prototype.getProperty=function(c){return this.getAttribute(c)}}if(!_.isFunction(CSSStyleDeclaration.prototype.setProperty)){CSSStyleDeclaration.prototype.setProperty=function(d,c){return this.setAttribute(d,c)}}if(!_.isFunction(CSSStyleDeclaration.prototype.removeProperty)){CSSStyleDeclaration.prototype.removeProperty=function(c){return this.removeAttribute(c)}}}else{}if(!window.getComputedStyle){window.getComputedStyle=function(c,d){this.el=c;this.getPropertyValue=function(f){var e=/(\-([a-z]){1})/g;if(f=="float"){f="styleFloat"}if(e.test(f)){f=f.replace(e,function(){return arguments[2].toUpperCase()})}return c.currentStyle[f]?c.currentStyle[f]:null};return this}}if(!Object.create){Object.create=(function(){var c=function(){};return function(d){if(arguments.length!=1){throw new Error("Object.create implementation only accepts one parameter.")}c.prototype=d;return new c()}})()}})(jQuery);$(function(){var a;if(a=/Chrome\/([0-9.]+)/.exec(navigator.userAgent)){$.browser.chrome=true;$.browser.safari=false;$.browser.version=a[1]}else{if(/Safari\//.exec(navigator.userAgent)&&!($.device.ipad||$.device.mobile)){a=/Version\/([0-9.]+)/.exec(navigator.userAgent);$.browser.version=a[1]}else{if(a=/Trident.*rv:([\w.]+)/.exec(navigator.userAgent)){$.browser.msie=true;delete $.browser.mozilla;$.browser.version=a[1]}}}$.browser.majorVersion=parseInt($.browser.version);if($.browser.msie){$("html").addClass("ie ie"+$.browser.version.slice(0,1));$("a.button").each(function(){$.tag({tagName:"span","class":"left"}).prependTo($(this))})}if($.support.borderRadius===false){$("html").addClass("noBorderRadius")}if($.support.linearGradient===false){$("html").addClass("noLinearGradient")}if(($.support.borderRadius===false)&&($.support.linearGradient===false)){$("html").addClass("noCss3")}});(function(){var b=false,c=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;var a=function(){};a.extend=function(j){var h=this.prototype;b=true;var f=new this();b=false;var d=function(n,l,m){for(var k in l){n[k]=typeof l[k]=="function"&&typeof m[k]=="function"&&c.test(l[k])?(function(o,p){return function(){var t=this._super;var q=m[o];this._super=(q==g)?undefined:q;var s=p.apply(this,arguments);this._super=t;return s}})(k,l[k]):l[k]}};var g=function(){console.error("Pure virtual call");throw new Error("Pure virtual call")};d(f,j,h);function e(){this.Class=e;if(!b&&this._init){this._init.apply(this,arguments)}}e.prototype=f;e.constructor=e;e.extend=arguments.callee;e.addProperties=d;e.pureVirtual=g;return e};if(typeof blist!=="undefined"){this.Class=a}else{module.exports=a}})();(function(a){var b={};a.fn.isControlClass=function(c){return !!(a(this[0]).data("controlClass")||{})[c]};a.Control={extend:function(d,k,h,g,f){if(a.isBlank(g)){g="Control"}var c=b[g];if(a.isBlank(c)){throw"Unrecognized parent "+g+" for "+d}var e=c.model.extend(k);var j=a.extend(true,{},c.defaults,h);b[d]={defaults:j,model:e,name:c.name+"."+d};if(!f){a.fn[d]=function(l){var o=a(this[0]);var m=o.data(d);if(a.isBlank(m)){m=new e(l,this[0],b[d]);o.data(d,m);var n=o.data("controlClass")||{};_.each(b[d].name.split("."),function(p){n[p]=true});o.data("controlClass",n)}return m}}return e},registerMixin:function(f,e,h,g,d){if(a.isBlank(g)){g="Control"}var c=b[g];if(a.isBlank(c)){throw"Unrecognized parent "+g+" for mixin "+f}c.mixins=c.mixins||{};c.mixins[f]={model:e,defaults:h,dependsOn:d}}};b.Control={defaults:{},model:Class.extend({_init:function(d,j,e){var h=a.extend(true,{},e.defaults);var g=this;var f={};var c=function(l){if(!f[l]&&a.subKeyDefined(e.mixins,l)){var k=e.mixins[l];_.each(a.makeArray(k.dependsOn),c);e.model.addProperties(g,k.model,a.extend({},g));f[l]=true;a.extend(true,h,k.defaults)}};_.each(g._getMixins(d)||[],c);g.settings=a.extend(h,d);g.currentDom=j;g._initMixins()},_getMixins:function(c){return[]},_initMixins:function(){},$dom:function(){if(!this._$dom){this._$dom=a(this.currentDom)}return this._$dom}}),name:"Control"}})(jQuery);(function(b){b.fn.loadingSpinner=function(d){var e=b(this[0]).data("loadingSpinner");if(!e){e=new a(d,this[0])}return e};var a=function(d,e){this.settings=b.extend({},a.defaults,d);this.currentDom=e;this.init()};b.extend(a,{defaults:{minimal:false,model:null,metric:null,overlay:false,showInitially:false},prototype:{init:function(){var d=this;d.$dom().data("loadingSpinner",d);d.setMetric(d.settings.metric);d.showHide(d.settings.showInitially);d.setModel(d.settings.model)},setModel:function(d){var e=this;if(!b.isBlank(e._model)){e._model.unbind(null,null,e)}if(!b.isBlank(d)){d.bind("request_start",function(){e.showHide(true)},e);d.bind("request_status",function(){e.setMessage.apply(e,arguments)},e);d.bind("request_finish",function(){e.showHide(false)},e);e._model=d}},$dom:function(){if(!this._$dom){this._$dom=b(this.currentDom)}return this._$dom},$content:function(){if(b.isBlank(this._$content)){this._$content=b.tag({tagName:"div","class":"loadingSpinnerContainer"});this._$content.append(b.tag({tagName:"div","class":["loadingSpinner",{value:"minimal",onlyIf:this.settings.minimal}]}));this._$content.append(b.tag({tagName:"div","class":"loadingMessage"}));this._$content.append(b.tag({tagName:"div","class":["loadingCountdown","hide"],contents:["Checking",{tagName:"span","class":"secondsSection",contents:[" in ",{tagName:"span","class":"seconds"}," seconds"]},"..."]}));this.$dom().append(this._$content);if(this.settings.overlay){var d=b.tag({tagName:"div","class":"loadingOverlay"});this.$dom().append(d);this._$content=this._$content.add(d)}}return this._$content},setMetric:function(d){if(this.metric&&!d){b.metrics.stopwatch("domain-intern","js-spinner-"+this.metric+"-time","clear")}this.metric=d},showHide:function(d){this.$content().toggleClass("hide",!d);if(!d){this.$content().find(".loadingMessage, .loadingCountdown").addClass("hide");c(this)}if(!b.isBlank(this.metric)){b.metrics.stopwatch("domain-intern","js-spinner-"+this.metric+"-time",d?"start":"end")}},setMessage:function(f,d){var e=this;if(!b.isBlank(f)){e.$content().find(".loadingMessage").removeClass("hide").html(f.plainTextToHtml())}if(!b.isBlank(d)){var g=e.$content().find(".loadingCountdown").removeClass("hide").find(".secondsSection").removeClass("hide").find(".seconds").text(d);c(e);e._countdownTimer=setInterval(function(){d--;g.text(d);if(d<1){c(e);e.$content().find(".secondsSection").addClass("hide")}},1000)}}}});var c=function(d){if(!b.isBlank(d._countdownTimer)){clearInterval(d._countdownTimer);delete d._countdownTimer}}})(jQuery);blist.namespace.fetch("blist.util");blist.namespace.fetch("blist.util.patterns");window.Sizzle=jQuery.find;String.prototype.startsWith=function(a){return this.indexOf(a)==0};String.prototype.endsWith=function(a){return this.length>=a.length&&this.lastIndexOf(a)==(this.length-a.length)};String.prototype.format=function(){var a=this,b=arguments.length;while(b--){a=a.replace(new RegExp("\\{"+b+"\\}","gm"),arguments[b])}return a};String.prototype.visualSize=function(b){var a=$("#ruler");if(a.length<1){$("body").append('<span class="ruler" id="ruler"></span>');a=$("#ruler")}if(!b){b=""}a.css("font-size",b);a.text(this+"");return{width:a.width(),height:a.height()}};String.prototype.visualHeight=function(a){return this.visualSize(a).height};String.prototype.visualLength=function(a){return this.visualSize(a).width};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.substring(1)};String.prototype.displayable=function(){return $.map(this.replace(/(\S)([A-Z])/g,"$1 $2").replace(/_/g," ").split(" "),$.capitalize).join(" ")};String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};String.prototype.clean=function(){return this.replace(/\xa0/g," ")};String.prototype.camelize=function(){return _.map(this.split(/[\W_]/),function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}).join("")};String.prototype.plainTextToHtml=function(){return("<p>"+this.replace(/\n/g,"</p><p>")+"</p>").replace(/<p><\/p>/g,"<p>&nbsp;</p>")};String.prototype.levenshtein=function(b){var c=this.length,a=b.length;if(Math.min(c,a)===0){return Math.max(c,a)}var f=0,e=0,g=[];for(f=0;f<=c;f++){g[f]=[];g[f][0]=f}for(e=0;e<=a;e++){g[0][e]=e}for(f=1;f<=c;f++){for(e=1;e<=a;e++){g[f][e]=Math.min(g[f-1][e]+1,g[f][e-1]+1,g[f-1][e-1]+(this.charAt(f-1)===b.charAt(e-1)?0:1))}}return g[c][a]};String.prototype.heuristicDistance=function(a){if($.isBlank(a)){return NaN}return this.replace(/^[a-z0-9]/ig,"").toLowerCase().levenshtein(a.replace(/^[a-z0-9]/ig,"").toLowerCase())};Function.prototype.curry=function(){var b=this;var a=Array.prototype.slice.call(arguments);return function(){return b.apply(this,a.concat(Array.prototype.slice.call(arguments)))}};String.prototype.linkify=function(a){if($.isBlank(this)){return""}if($.isBlank(a)){a=""}var c,e,d,b;e=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;c=this.replace(e,'<a href="$1" '+a+">$1</a>");d=/(^|[^\/])(www\.[\S]+(\b|$))/gim;c=c.replace(d,'$1<a href="http://$2" '+a+">$2</a>");b=/(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/gim;c=c.replace(b,'<a href="mailto:$1">$1</a>');return c};(function(a){a.mixpanelMeta=function(){var g="Not Logged In",l="Not Logged In",h="n/a",f="n/a",d="n/a",k="n/a",j="n/a";if(!_.isUndefined(blist.currentUser)){g=blist.currentUserId;l=_.any(blist.currentUser.flags,function(m){return m=="admin"});if(!_.isUndefined(blist.currentUser.roleName)){h=blist.currentUser.roleName}}if(!_.isUndefined(blist.dataset)){d=blist.dataset.displayName;k=blist.dataset.id;f=blist.dataset.owner.id;if(!_.isUndefined(blist.currentUser)){j=blist.dataset.owner.id==blist.currentUserId}}var c=window.location.hostname;var e=window.location.pathname;var b=Math.round(new Date().getTime()/1000)-blist.pageOpened;mixpanel.register({"User Id":g,"Socrata Employee":l,"User Role Name":h,"Dataset Owner":f,"User Owns Dataset":j,"View Id":k,"View Type":d,Domain:c,"On Page":e,"Time Since Page Opened (sec)":b});g=_.isUndefined(blist.currentUser)?mixpanel.get_distinct_id():g;mixpanel.identify(g)};a.hashHref=function(b){return b.slice(b.indexOf("#")+1)};a.urlParam=function(c,b,f){var e=new RegExp("([\\?#&]"+b+"=)([^&#]*)");if(f!==undefined&&f!==null){return c.replace(e,"$1"+f)}var d=e.exec(c);if(d){return d[2]||0}else{return 0}};a.toParam=function(b){return _.map(b,function(d,c){return escape(c)+"="+escape(d)}).join("&")};a.escapeQuotes=function(b){if(typeof b!=="string"){return b}return a.htmlEscape(b).replace(/'/,"&apos;")};a.unescapeQuotes=function(b){if(typeof b!=="string"){return b}return a.htmlUnescape(b).replace(/&apos;/g,"'").replace(/&#x27;/g,"'")};a.htmlEscape=function(b){if(typeof b!=="string"){return b}return b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};a.htmlUnescape=function(b){if(typeof b!=="string"){return b}return b.replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")};a.unescapeObject=function(c){if(c===null||c===undefined){return c}else{if(typeof c=="string"){return a.htmlUnescape(c)}else{if(typeof c=="object"){var b=c instanceof Array?[]:{};a.each(c,function(e,d){b[e]=a.unescapeObject(d)});return b}else{return c}}}};a.htmlStrip=function(c){try{return c.replace(/<[^>]*>/g,"")}catch(b){return""}};a.urlSafe=function(c){var b=c.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9_\-]/g,"-").replace(/\-+/g,"-");if(b.length<1){b="-"}return b.slice(0,50)};a.capitalize=function(b){b+="";return b.charAt(0).toUpperCase()+b.substring(1)};a.live=function(b,d,c){var e=a([]);e.context=document;e.selector=b;e.live(d,c);return e};a.t=function(b,c){return a.tNull(b,c)||"(no translation available)"};a.tNull=function(c,d){if(blist.locale=="nyan"){return"nyan"}if(!a.subKeyDefined(blist.translations,c)){return null}var b=a.deepGetStringField(blist.translations,c);if(a.isPlainObject(b)&&_.has(d,"count")){if(d.count==1){b=b.one}else{b=b.other}if(!b){return null}}b=b.replace(/%{[^}]+}/g,function(e){return(d||{})[e.slice(2,-1)]||""});return c.endsWith("_html")?b:a.htmlStrip(b)};a.rootPath=function(){return(blist.locale==blist.defaultLocale)?"":("/"+blist.locale)};a.path=function(b){return a.rootPath()+(b||"")};a.localize=function(b){if(!a.isPlainObject(b)){return b}return a.subKeyDefined(b,blist.locale)?b[blist.locale]:""};a.deepCompact=function(c){if(_.isArray(c)){return _(c).chain().map(function(d){return a.deepCompact(d)}).reject(function(d){return a.isBlank(d)}).value()}if(!a.isPlainObject(c)){return c}var b={};_.each(c,function(e,d){if(!a.isBlank(e)){b[d]=a.deepCompact(e)}});return b};a.compareValues=function(e,c){if(e===c){return true}if(e===null||e===undefined){if(c===null||c===undefined){return true}return false}if(c===null||c===undefined){return false}if(!(e instanceof Object)||!(c instanceof Object)){return false}var b=function(j,h,g){if(!j.hasOwnProperty(g)||!h.hasOwnProperty(g)){return false}return a.compareValues(j[g],h[g])};for(var f in e){if(!b(e,c,f)){return false}}for(var d in c){if(!b(c,e,d)){return false}}return true};a.syncObjects=function(b,c){a.extend(b,c);_.each(b,function(e,d){if(_.isUndefined(c[d])){delete b[d]}})};a.flattenChildren=function(d,b){var b=b||"children";var c=function(e){return _.map(e,function(f){if(_.isUndefined(f[b])){return f}else{return[f,c(f[b])]}})};return _.flatten(c(d))};a.unwrapHtml=function(b){return b.replace(/^\s*<[^<>]+>/i,"").replace(/<\/[^<>]+>\s*$/i,"")};a.renderTemplate=function(c,d,g,f){var b=a("#templates > ."+c);if(b.length<1){throw"No template found: "+c}if(_.isUndefined(d)){return !!f?b.html():b.clone().children()}else{var e=a(b[0].cloneNode(true));e.appendTo(a("<div/>"));if(a.isBlank(e[0].parentNode)){throw"templateCopy has no parent!"}var h=e.render(d,g);return !!f?h.innerHTML:a(h).children()}};a.compileTemplate=function(b,e){var d=a("#templates > ."+b).clone();if(d.length<1){throw"No template found: "+b}d.appendTo(a("<div/>"));var c=d.compile(e);return function(f){return a.unwrapHtml(c(f))}};a.isBlank=function(b){return _.isUndefined(b)||_.isNull(b)||b===""};a.isPresent=function(b){return !a.isBlank(b)};a.arrayify=function(b){return !_.isArray(b)?[b]:b};a.objectify=function(d,c){if(!a.isPlainObject(d)){var b={};b[c]=d;return b}return d};a.numericalSanitize=function(b){return(b||"").replace(/[^0-9\.\+\-]/,"")};a.arrayToObjKeys=function(b,c){var d={};_.each(a.makeArray(b),function(e){d[e]=c});return d};a.addItemsToObject=function(f,b,c){b=a.makeArray(b);var e=b.length;var d={};_.each(f,function(h,g){g=parseInt(g);if(g>=c){if(!a.isBlank(h.index)){h.index=g+e}d[g+e]=h;delete f[g]}});a.extend(f,d);_.each(b,function(g,h){h=parseInt(h);if(!a.isBlank(g.index)){g.index=c+h}f[c+h]=g})};a.removeItemsFromObject=function(f,b,e){for(var d=0;d<e;d++){delete f[b+d]}var c={};_.each(f,function(h,g){g=parseInt(g);if(g>b){if(!a.isBlank(h.index)){h.index=g-e}c[g-e]=h;delete f[g]}});a.extend(f,c)};a.keyValueToObject=function(c,d){var b={};b[c]=d;return b};a.deepGet=function(){var n=0;var j=false;if(arguments[0]===true){n++;j=true}var h=arguments[n++];for(;n<arguments.length;n++){var o=arguments[n];if(_.isArray(h)){var c=o.match(/^\[(\w*)=?(\w*)\]$/);if(!a.isBlank(c)){var f=c[1];var l=c[2];var b=!a.isBlank(f)&&!a.isBlank(l);var q;var d=a.makeArray(arguments).slice(n+1);for(var g=0;g<h.length;g++){var p=h[g];if(b&&p[f]!=l){continue}q=a.deepGet.apply(a,_.compact([j?true:null,p]).concat(d));if(!j&&!a.isBlank(q)){break}}return q}}if(_.isString(h)){try{h=JSON.parse(h)}catch(k){}}if(h[o]==null){if(!j){return undefined}else{h[o]={}}}if(_.isFunction(h[o])){h=h[o].apply(h)}else{h=h[o]}}return h};a.deepSet=function(){var e=arguments[0];var d=arguments[1];for(var c=2;c<arguments.length-1;c++){var b=arguments[c];if(_.isUndefined(e[b])){e[b]={}}e=e[b]}e[_.last(arguments)]=d};a.deepGetStringField=function(c,b){return a.deepGet.apply(a,[c].concat(b.split(".")))};a.deepPluck=function(c,b){return _.map(c,function(d){return a.deepGetStringField(d,b)})};a.subKeyDefined=function(e,b){if(a.isBlank(e)||!_.isString(b)){return false}var c=e;var d=b.split(".");while(d.length>0){c=c[d[0]];if(a.isBlank(c)){return false}d.shift()}return true};a.isSubKeyEqual=function(g,f,b){if(a.isBlank(g)||a.isBlank(f)||!_.isString(b)){return _.isEqual(g,f)}var e=g,d=f;var c=b.split(".");while(c.length>0){e=e[c[0]];d=d[c[0]];if(a.isBlank(e)||a.isBlank(d)){return _.isEqual(e,d)}c.shift()}return _.isEqual(e,d)};a.safeId=function(b){return b.replace(/(\.|\:)/g,"\\$1")};a.arrayToSentence=function(c,b,e,d){return c.length<3?c.join((d?e:"")+" "+b+" "):c.slice(0,-1).join(e+" ")+e+" "+b+" "+c[c.length-1]};a.wordify=function(c){var d=function(e){return a.t("core.numbers."+e)};var b={"0":d("num_zero"),"1":d("num_one"),"2":d("num_two"),"3":d("three"),"4":d("four"),"5":d("five"),"6":d("six"),"7":d("seven"),"8":d("eight"),"9":d("nine")};return b[c.toString()]||c};a.commaify=function(b){b=b+"";var c=b.indexOf(".");if(c==-1){c=b.length}c-=3;while(c>0&&b.charAt(c-1)>="0"&&b.charAt(c-1)<="9"){b=b.substring(0,c)+","+b.substring(c);c-=3}return b};a.humanify=function(d,c,e){var b=Math.abs(e);return b>=1000?blist.util.toHumaneNumber(e,d):(b-Math.floor(b)>0?e.toFixed(c):e)};a.pluralize=function(c,d,b){if(_.isUndefined(b)){var b;if(d.match(/[oiu]$/i)){b=d+"es"}else{if(d.match(/y$/i)){b=d.substring(0,d.length-1)+"ies"}else{b=d+"s"}}}return c+" "+((c===1)?d:b)};a.addAppToken=function(b){return b+((b.indexOf("?")==-1)?"?":"&")+"app_token="+blist.configuration.appToken};a.jsonIntToFloat=function(b){if(b.toString().indexOf(".")<0){return parseFloat(b.toString()+".000001")}return b};a.clamp=function(c,b){return c<b[0]?b[0]:c>b[1]?b[1]:c};a.union=function(){return _.reduce(_.flatten(arguments),function(b,c){if(_.all(b,function(d){return !_.isEqual(c,d)})){b.push(c)}return b},[])};a.fn.tagName=function(){return this.get(0).tagName.toLowerCase()};a.fn.isInputType=function(b){return(this.tagName()=="input")&&(this.attr("type")==b)};a.fn.renderWidth=function(){return this[0].clientWidth-(this.innerWidth()-this.width())};a.fn.renderHeight=function(){return this[0].clientHeight-(this.innerHeight()-this.height())};a.fn.lockScroll=function(c){var b=this;if(c===true){this.on("mousewheel.lockScroll DOMMouseScroll.lockScroll",function(e){var d=null;if(e.type=="mousewheel"){d=(e.originalEvent.wheelDelta*-0.5)}else{if(e.type=="DOMMouseScroll"){d=20*e.originalEvent.detail}}if(d){a(this).scrollTop(d+a(this).scrollTop());e.preventDefault()}})}else{this.off("mousewheel.lockScroll DOMMouseScroll.lockScroll")}};a.batchProcess=function(h,b,d,c,g){if(!_.isArray(h)){return}h=_.clone(h);var f=h.splice(0,b);var e=_.map(f,d);if(_.isFunction(c)){c(e)}if(h.length===0){if(_.isFunction(g)){g()}}else{setTimeout(function(){a.batchProcess(h,b,d,c,g)},10)}};a.extract=function(c,d){var b={};_.each(c,function(f,e){b[e]=f[d]});return b};a.assertThrowOnFail=true;a.assert=function(c,b){if(!c){console.error("Assertion failed: "+b);if(a.assertThrowOnFail){throw b}}};a.parseParams=function(f){var d=/([^&=]+)=?([^&]*)/g;var h=function(e){return decodeURIComponent(e.replace(/\+/g," "))};var j={},g;if(!f){f=window.location.search}if(f.substr(0,1)=="?"){f=f.substr(1)}while(g=d.exec(f)){var c=h(g[1]);var b=h(g[2]);if(j[c]!==undefined){if(!a.isArray(j[c])){j[c]=[j[c]]}j[c].push(b)}else{j[c]=b}}return j};jQuery.fn.quickEach=(function(){var b=jQuery([1]);return function(j){var f=-1,g,d=this.length;try{while(++f<d&&(g=b[0]=this[f])&&j.call(b,f,g)!==false){}}catch(h){delete b[0];throw h}delete b[0];return this}}());a.fn.hasChildren=function(){var b=this.get(0);return(b!=null)&&(b.firstChild!=null)};a.fn.exists=function(){return this.length!==0};a.thunk=function(b){return function(){return b}};blist.util.doAuthedAction=function(b,c){if(!a.isBlank(blist.util.inlineLogin)){blist.util.inlineLogin.verifyUser(function(e,d){if(e){c(d)}},a.t("controls.common.auth_required",{action_phrase:b}))}else{if(!blist.currentUserId){window.location=a.path("/login")}else{c()}}};blist.util.railsFlash=function(d,e){var b=a.cookies.get("js_flash");var c=b?JSON.parse(b):{};c[(e||"notice")]=d;a.cookies.set("js_flash",JSON.stringify(c))};blist.util.patterns.UID=/^\w{4}-\w{4}$/;blist.util.patterns.mobileBrowser=/iPhone|iPod|Android/i;blist.util.isMobile=function(){return blist.util.patterns.mobileBrowser.test(navigator.userAgent)};blist.isMobile=blist.util.isMobile();blist.util.loadCaptcha=function(b){if(a("#"+b).hasClass("placeholder")){blist.util.assetLoading.loadAssets({javascripts:["https://www.google.com/recaptcha/api/js/recaptcha_ajax.js"]},function(){a("#recaptcha_area").parent().addClass("placeholder").empty();a("#"+b).removeClass("placeholder");Recaptcha.create(blist.configuration.reCAPTCHA_PUK,b,{theme:"white",lang:blist.locale})})}}})(jQuery);(function(){blist.translations={};if(blistTranslations){_.each(blistTranslations,function(a){$.extend(true,blist.translations,a())})}blist.locale=$("body").data("locale");blist.defaultLocale=$("body").data("defaultlocale")})();var blistUtilNS=blist.namespace.fetch("blist.util");blistUtilNS.toHumaneNumber=function(g,b){var f=["K","M","B","T"];var e=1000;var d=Math.pow(e,f.length);var h=Math.abs(g);var a;g=parseFloat(g);for(var c=f.length-1;c>=0;c--){if(h>=d){a=(h/d).toFixed(b);if(g<0){a=-a}return a+f[c]}d=d/e}return g.toFixed(b)};blistUtilNS.parseHumaneNumber=function(e){var d=["K","M","B","T"];var c=1000;var b;if($.isBlank(e)){return e}var a=e.charAt(e.length-1);a=a.valueOf().toUpperCase();for(i=d.length-1;i>=0;i--){if(a===d[i]){b=e.slice(0,e.length-1);return parseFloat(b)?b*Math.pow(c,i+1):e}}return e};var humaneUtilNS=blist.namespace.fetch("blist.util.humaneDate");_.each(["minute","hour","day","week","month","year"],function(a){blist.util.humaneDate[a.toUpperCase()]={duration:moment.duration(1,a).as("milliseconds"),translation_key:"current_"+a+"_future"}});blist.util.humaneDate.getFromDate=function(a,e){var d=moment(a);if(!d.isValid()){return $.t("core.forms.none")}if(_.isUndefined(e)){return d.fromNow()}var c=moment(),b=Math.abs(d.diff(c));if(e.duration>=b){return $.t("core.date_time."+e.translation_key)}else{return d.fromNow()}};blist.util.humaneDate.getFromISO=function(a){var b=(""+a).replace(/-/g,"/").replace(/[TZ]/g," ");return humaneUtilNS.getFromDate(new Date(b))};if(typeof jQuery!="undefined"){jQuery.fn.humane_dates=function(){return this.each(function(){var a=moment(this.title);if(a.isValid()){jQuery(this).text(a.fromNow())}})}}(function(a){blist.defaultColors=["#003366","#D95F02","#1B9E77","#e6ab02","#7570b3"];a.colorToObj=function(c){if(c.startsWith("#")||c.match(/^[a-fA-F0-9]{3,6}$/)){return a.hexToRgb(c)}var b=c.match(/rgb\((\d+),\s*(\d+),\s*(\d+)(,\s*\d+\.?\d+)?\)/);return{r:parseInt(b[1]),g:parseInt(b[2]),b:parseInt(b[3])}};a.hexToRgb=function(b){b=b.replace("#","");if(b.length<6){b=b.replace(/([0-9abcdef])/gi,"$1$1")}b=parseInt(b,16);return{r:b>>16,g:(b&65280)>>8,b:(b&255)}};a.rgbToHex=function(b){var c=[b.r.toString(16),b.g.toString(16),b.b.toString(16)];a.each(c,function(d){if(c[d].length==1){c[d]="0"+c[d]}});return c.join("")};a.hsvToRgb=function(l){var n=l.h,k=l.s,u=l.v;if(n==360){n=0}k/=100;u/=100;var c,m,s;if(k==0){c=u,s=u,m=u}else{var h=n/60,j=Math.floor(h),o=h-j;var e=u*(1-k);var d=u*(1-(k*o));var v=u*(1-(k*(1-o)));switch(j){case 0:c=u,m=v,s=e;break;case 1:c=d,m=u,s=e;break;case 2:c=e,m=u,s=v;break;case 3:c=e,m=d,s=u;break;case 4:c=v,m=e,s=u;break;case 5:c=u,m=e,s=d;break}}return{r:Math.round(c*255),g:Math.round(m*255),b:Math.round(s*255)}};a.rgbToHsv=function(j){var c=j.r/255,f=j.g/255,k=j.b/255;var d=Math.min(c,k,f),l=Math.max(c,f,k);var m=l-d;var e=null,n=(l==0)?0:(m/l);if(n==0){e=0}else{if(c==l){e=60*(f-k)/m}else{if(f==l){e=120+60*(k-c)/m}else{e=240+60*(c-f)/m}}if(e<0){e+=360}}return{h:e,s:Math.round(n*100),v:Math.round(l*100)}};a.hslToRgb=function(e){var d=e.h,k=e.s,f=e.l;k/=100;f/=100;while(d<0){d+=360}while(d>=360){d-=360}var j,h,c;if(d<120){j=(120-d)/60,h=d/60,c=0}else{if(d<240){j=0,h=(240-d)/60,c=(d-120)/60}else{j=(d-240)/60,h=0,c=(360-d)/60}}j=2*k*Math.min(j,1)+(1-k);h=2*k*Math.min(h,1)+(1-k);c=2*k*Math.min(c,1)+(1-k);if(f<0.5){j*=f,h*=f,c*=f}else{j=(1-f)*j+2*f-1;h=(1-f)*h+2*f-1;c=(1-f)*c+2*f-1}return{r:Math.round(j*255),g:Math.round(h*255),b:Math.round(c*255)}};a.rgbToHsl=function(k){var c=k.r/255,j=k.g/255,m=k.b/255;var e=Math.min(c,m,j),n=Math.max(c,j,m);var o=n-e;var f=0,p=0,d=(e+n)/2;if(d>0&&d<1){p=o/((d<0.5)?(2*d):(2-2*d))}if(o>0){if(n==c&&n!=j){f+=(j-m)/o}if(n==j&&n!=m){f+=(2+(m-c)/o)}if(n==m&&n!=c){f+=(4+(c-j)/o)}f*=60}return{h:f,s:Math.round(p*100),l:Math.round(d*100)}};a.rgbTosRGB=function(b){_.each(["r","g","b"],function(c){b[c]=(b[c]<=0.03928)?b[c]/12.92:Math.pow(((b[c]+0.055)/1.055),2.4)});return b};a.rotateHue=function(b,d){var c=b.h+d;c+=Math.ceil(-c/360)*360;b.h=c%360;return b};a.rotateRgb=function(b,c){return a.hsvToRgb(a.rotateHue(a.rgbToHsv(b),c))};a.rotateHex=function(b,c){return"#"+a.rgbToHex(a.rotateRgb(a.hexToRgb(b),c))};a.colorContrast=function(d){var c=_.map(_.map(arguments,a.hexToRgb),a.rgbTosRGB);var b=_.map(c,function(e){return 0.2126*e.r+0.7152*e.g+0.0722*e.b});return Math.round((Math.max.apply(null,b)+0.05)/(Math.min.apply(null,b)+0.05)*10)/10};a.addColors=function(d,c){var g=a.hexToRgb(d);var e=a.hexToRgb(c);var f=function(j,h){return Math.min(j+h,255)};return a.rgbToHex({r:f(g.r,e.r),g:f(g.g,e.g),b:f(g.b,e.b)})};a.subtractColors=function(e,d){var g=a.hexToRgb(e);var f=a.hexToRgb(d);var c=function(j,h){return Math.max(j-h,0)};return a.rgbToHex({r:c(g.r,f.r),g:c(g.g,f.g),b:c(g.b,f.b)})};a.gradientString=function(d){var c=[];for(var b=0;b<d.length;b++){if(d[b] instanceof Array){d[b][0]=d[b][0].replace(/#/,"");c.push(d[b].join(":"))}else{d[b]=d[b].replace(/#/,"");c.push(d[b])}}return c.join(",")};a.urlToImageBuilder=function(c,g,e){var b="/ui/box."+((g===undefined)?"png":g)+"?";var d=[];for(var f in c){d.push(f+"="+c[f])}b+=d.join("&");return((e===true)?("url("+b+")"):b)};a.gradient=function(h,c,e){e=e||{maxValue:100};if(!_.isArray(c)){c=[c]}c=_.map(c,function(k){if(!k.r){k=a.hexToRgb(k)}return a.rgbToHsv(k)});var j=c[0];var b=c.length>1?c[1]:{h:j.h,s:j.s>50?0:100,v:j.v>50?0:e.maxValue};var d={h:(j.h-b.h)/(h-1),s:(j.s-b.s)/(h-1),v:(j.v-b.v)/(h-1)};var g=[];for(var f=0;f<h;f++){g[f]=a.hsvToRgb({h:j.h-(f*d.h),s:j.s-(f*d.s),v:j.v-(f*d.v)})}return g.reverse()};a.complementaryGradient=function(g,c){var d=a.rgbToHsv(a.hexToRgb(c));var f=(d.h*2)+137;f=f<360?f:Math.floor(d.h/2)-137;var e=g%2==0?g/2+1:Math.ceil(g/2);var b=g-e+1;var h=a.gradient(e,a.hsvToRgb(a.extend({},d,{h:f}))).reverse();h.pop();return h.concat(a.gradient(b,c))};a.brighten=function(b,c){if(!c){c=10}if(!b.r){b=a.hexToRgb(b)}b=a.rgbToHsv(b);b.v+=c;if(b.v>100){b.v=100}return a.hsvToRgb(b)}})(jQuery);blist.namespace.fetch("blist.events");blist.events.MODAL_SHOWN="modalshown";blist.events.MODAL_HIDDEN="modalhidden";blist.events.DISPLAY_ROW="displayrow";(function(){var a=Class.extend({_init:function(){var e=this;var c={};var d=[];var f={};e._events={};var b=function(g){if(!e._events[g]){throw"Event "+g+" not registered"}};this.getEventNamespace=function(j){if(_.isUndefined(f[j])){var h=[];var g={bind:function(l,m,k){h.push(_.toArray(arguments));return e.bind.apply(e,arguments)},unbind:function(l,m,k){return e.unbind.apply(e,arguments)},unbindAll:function(){_.each(h,function(k){g.unbind.apply(e,k)})}};f[j]=g}return f[j]};this.bind=function(h,j,g){b(h);c[h]=c[h]||[];if(!_.include(c[h],j)&&_.isFunction(j)){c[h].push(j);if(!$.isBlank(g)){d.push({name:h,func:j,model:g})}}return e};this.once=function(g,h){var j=function(){this.unbind(g,j);h.apply(this,arguments)};this.bind(g,j)};this.unbind=function(h,j,g){if(!$.isBlank(h)){b(h)}if(!$.isBlank(j)){c[h]=_.without(c[h]||[],j)}else{if(!$.isBlank(g)){d=_.reject(d,function(k){if(k.model===g&&($.isBlank(h)||h===k.name)){c[k.name]=_.without(c[k.name]||[],k.func);return true}return false})}else{if(!$.isBlank(h)){c[h]=[]}}}return e};this.trigger=function(h,g){b(h);_.each(c[h]||[],function(j){j.apply(e,g||[])});return e};this.availableEvents=function(){return _.keys(e._events).sort()}},registerEvent:function(b){var c=this;_.each($.makeArray(b),function(d){c._events[d]=true});return c},cleanCopy:function(b){var c=this;var d=function(j,g){if(j instanceof a){return j.cleanCopy()}else{if(_.isArray(j)){if(g=="flags"){return j.slice().sort()}else{return _.map(j,function(k){return d(k)})}}else{if($.isPlainObject(j)){var h={};_.each(j,function(m,l){h[l]=d(m,l)});return h}else{return j}}}};if(_.isArray(b)){var f={};_.each(b,function(g){f[g]=true});b=f}var e={};_.each(this,function(h,g){if(!_.isFunction(h)&&!g.startsWith("_")&&c._validKeys[g]&&($.isBlank(b)||b[g])){e[g]=d(h,g)}});return e},clone:function(e){var c=this;var b=function(j,f,g){g=(g||[]).concat([j]);if(j instanceof a){return j.clone(e)}else{if(_.isArray(j)){if(f=="flags"){return j.slice().sort()}else{return _.map(j,function(k){return b(k,undefined,g)})}}else{if($.isPlainObject(j)){var h={};_.each(j,function(m,l){if(!_.include(g,m)){h[l]=b(m,l,g)}});return h}else{return j}}}};e=$.makeArray(e);e.push(c);var d={};_.each(this,function(g,f){if(!_.isFunction(g)&&!c._cloneExclude[f]&&!_.include(e,g)){d[f]=b(g,f)}});return new c.Class(d)},_generateBaseUrl:function(d,b){var e=document.location;var d=$.isBlank(d)?e.hostname:d;if(b){d=d.replace(/www\./,"")}var c=(b?"":(e.protocol+"//"))+d;if(e.port&&e.port!=80){c+=":"+e.port}return c},_validKeys:{},_cloneExclude:{_super:true}});if(blist.inBrowser){this.Model=a}else{module.exports=a}})();(function(){var b=[];var a=Model.extend({_init:function(){this._super();this.registerEvent(["request_start","request_status","request_finish"]);this._reqCount=0;this.accessType="WEBSITE"},setAccessType:function(c){this.accessType=c},makeRequest:function(g){var d=this;var e=g.pageCache;var c=function(h,k,j){return function(p,m,q){var l=((h?q:arguments[0])||{}).status;if(l==202||l==503){var n=g.retryTime||5000;d.trigger("request_status",[((p||{}).details||{}).message||"Our servers are still processing this request. Please be patient while it finishes.",n/1000]);if(_.isFunction(g.pending)){g.pending.apply(this,arguments)}if(!$.isBlank(p)&&!_.isUndefined(p.ticket)){g=$.extend(true,{},g);g.type="get";var o=g.data;g.data={ticket:p.ticket};if(!$.isBlank(o)&&!_.isUndefined(o.method)){g.data=o.method}}setTimeout(function(){e?$.Tache.Get(g):$.ajax(g)},n);return}else{if(l>=500&&l<600){throw new Error("There was a problem with our servers")}}if(d.displayName==="dataset"||d.displayName==="working copy"){d._captureSodaServerHeaders(q)}d._finishRequest();if(_.isFunction(j)){j.apply(this,arguments)}if(_.isFunction(k)){k.apply(this,arguments)}}};d._startRequest();g=$.extend({contentType:"application/json",dataType:"json"},g,{error:c(false,g.error,g.allComplete),success:c(true,g.success,g.allComplete)});if(!g.isSODA){if(!$.isBlank(d.accessType)){g.params=$.extend({accessType:d.accessType},g.params)}else{$.debug("making call without accessType!",g)}}if(!$.isBlank(g.params)){g.url+=(g.url.indexOf("?")>=0?"&":"?")+$.param(g.params)}var f=function(){delete g.batch;delete g.pageCache;delete g.params;delete g.isSODA;delete g.anonymous};if(g.anonymous){g.headers=$.extend(g.headers,{"X-Socrata-Auth":"unauthenticated"})}if(g.pageCache){f();$.Tache.Get(g)}else{if(g.batch||a._inBatch){f();b.push(g)}else{f();$.ajax(g)}}},_startRequest:function(){if(this._reqCount<1){this.trigger("request_start")}this._reqCount++},_finishRequest:function(){this._reqCount--;if(this._reqCount<1){this.trigger("request_finish")}}});a.startBatch=function(){a._inBatch=true};a.sendBatch=function(d,f,k){a._inBatch=false;if(b.length<1){if(_.isFunction(d)){d()}return}if(b.length==1){var g=b.shift();$.ajax($.extend({},g,{complete:function(){if(_.isFunction(g.complete)){g.complete()}if(_.isFunction(k)){k()}},error:function(o){var n=JSON.parse(o.responseText);if(_.isFunction(g.error)){g.error(n.message)}if(_.isFunction(f)){f(n.message)}},success:function(n){if(_.isFunction(g.success)){g.success(n)}if(_.isFunction(d)){d()}}}));return}var l=[];var m=b;b=[];var e=[];var h=m[0].headers||{};m=_.reject(m,function(n){if(_.isEmpty(h)&&_.isEmpty(n.headers)||_.isEqual(h,n.headers)){return false}else{e.push(n);return true}});var j=_.after(e.length>0?2:1,function(){if(_.isFunction(d)){d()}});var c=_.after(e.length>0?2:1,function(){if(_.isFunction(k)){k()}});_.each(m,function(n){l.push({url:n.url,requestType:n.type,body:n.data})});$.ajax({url:"/api/batches",dataType:"json",contentType:"application/json",headers:h,type:"POST",data:JSON.stringify({requests:l}),success:function(o){var n=false;_.each(o,function(q,p){if(q.error){n=true;if(_.isFunction(m[p].error)){m[p].error(q.errorMessage)}}else{if(_.isFunction(m[p].success)){m[p].success(JSON.parse(q.response||'""'))}}});if(n){if(_.isFunction(f)){f()}}else{j()}},complete:function(){_.each(m,function(n){if(_.isFunction(n.complete)){n.complete()}});c()},error:function(o){var n=JSON.parse(o.responseText);_.each(m,function(p){if(_.isFunction(p.error)){p.error(n.message)}});if(_.isFunction(f)){f(n.message)}}});if(e.length>0){b=b.concat(e);a.sendBatch(j,f,c)}};if(blist.inBrowser){this.ServerModel=a;$.socrataServer=new a()}else{module.exports=a}})();(function(){this.Page=ServerModel.extend({_init:function(a){this._super();$.extend(this,a)},update:function(a){if($.subKeyDefined(a,"path")&&a.path!=this.path){this._pathDirty=true;this._oldPath=this.path}$.extend(this,a)},save:function(b,c){var f=this;var d="PUT";if($.isBlank(f.uid)){delete f.owner;delete f.flags;f.permission="public";d="POST"}var a=function(h){var g={};if(f._pathDirty){g.oldPath=f._oldPath}f.update(h);f._pathDirty=false;delete f._oldPath;if(_.isFunction(b)){b(f,g)}};var e=function(){f.makeRequest({type:d,success:function(g){if(f._pathDirty){f.makeRequest({type:"POST",url:"/api/id/pages",data:JSON.stringify([{path:f._oldPath,":deleted":true}]),complete:function(){a(g)}})}else{a(g)}},error:c})};if(f._pathDirty){Page.checkUnique(f.path,e,function(){if(_.isFunction(c)){c({duplicatePath:true})}})}else{e()}},saveCopy:function(d,a,b){var c=$.extend(this.cleanCopy(),d);_.each(["uid","version","createdAt","updatedAt"],function(e){delete c[e]});this.makeRequest({type:"POST",data:JSON.stringify(c),success:function(e){if(_.isFunction(a)){a(new Page(e))}},error:b})},makeRequest:function(a){if($.isBlank(a.url)){if(a.type=="POST"){a.url="/api/pages.json"}else{if(a.type=="PUT"){a.url="/api/pages/"+this.uid+".json"}}a.data=a.data||JSON.stringify(this.cleanCopy())}this._super(a)},_validKeys:{uid:true,path:true,name:true,format:true,privateData:true,status:true,category:true,grouping:true,version:true,permission:true,content:true,data:true,metadata:true,cacheInfo:true}});Page.createFromId=function(c,d,a,b){if(_.isFunction(d)){b=a;a=d;d=null}$.Tache.Get({url:$.isBlank(c)?"/api/id/pages.json?path="+d:"/api/pages/"+c+".json",success:function(e){if(_.isArray(e)){e=_.first(e)}if(_.isFunction(a)){a(new Page(e))}},error:b})};Page.deleteById=function(c,d,a,b){if(_.isFunction(d)){b=a;a=d;d=null}var e=_.after(2,a);if(!$.isBlank(c)){$.socrataServer.makeRequest({type:"DELETE",url:"/api/pages/"+c+".json",error:b,success:e})}else{e()}if(!$.isBlank(d)){$.socrataServer.makeRequest({type:"POST",url:"/api/id/pages",data:JSON.stringify([{path:d,":deleted":true}]),error:b,success:e})}else{e()}};Page.checkUnique=function(c,a,b){var d=_.after(2,a);$.socrataServer.makeRequest({type:"GET",cache:false,url:"/api/pages.json?method=isPathAvailable",params:{path:c},success:function(e){if(e){d()}else{b()}}});$.socrataServer.makeRequest({type:"GET",cache:false,url:"/api/id/pages",isSODA:true,params:{path:c},success:function(e){if(_.isEmpty(e)){d()}else{b()}},error:function(){d()}})};Page.uniquePath=function(g,e,a){if($.isBlank(g)){g="unnamed"}if($.isBlank(e)){e="/"}if(!e.startsWith("/")){e="/"+e}var f=e+$.urlSafe(g);var b=f;var d=1;var c=function(){Page.checkUnique(b,function(){a(b)},function(){b=f+"-"+d;d++;c()})};c()}})();(function(a){a.caretTo=function(d,c){if(d.createTextRange){var b=d.createTextRange();b.move("character",c);b.select()}else{if(d.selectionStart!=null){d.focus();d.setSelectionRange(c,c)}}};a.fn.caretTo=function(b,c){return this.queue(function(e){if(isNaN(b)){var d=a(this).val().indexOf(b);if(c===true){d+=b.length}else{if(c){d+=c}}a.caretTo(this,d)}else{a.caretTo(this,b)}e()})};a.fn.caretToStart=function(){return this.caretTo(0)};a.fn.caretToEnd=function(){return this.queue(function(b){a.caretTo(this,a(this).val().length);b()})}}(jQuery));(function(c){c.tag=function(g,h){g=d(g);if(g===false){return null}if(_.isArray(g)){var f=_.map(g,function(j){return c.tag(j,true)}).join("");return(h===true)?f:c(f)}if(_.isString(g)){return g}var e="<"+g.tagName.toLowerCase();_.each(g,function(m,l){var j=l.toLowerCase();if(l=="tagName"||l=="contents"){return}else{if((m===true)&&(j=="checked"||j=="selected"||j=="disabled"||j=="readonly"||j=="multiple"||j=="ismap"||j=="defer"||j=="declare"||j=="noresize"||j=="nowrap"||j=="noshade"||j=="compact")){e+=b(l,l)}else{if(m===false){return}else{if(l=="style"){var o=[];_.each(m,function(p,k){var q=d(p);if(q!==false){o.push(k+":"+q)}});e+=b(l,o.join(";"))}else{if(l=="data"){_.each(m,function(q,p){e+=b("data-"+p,q)})}else{if(_.isArray(m)){var o=[];_.each(m,function(k){var p=d(k);if(p!==false){o.push(p)}});e+=b(l,o.join(" "))}else{if(_.isString(m)){e+=b(l,m)}else{var n=d(m);if(n!==false){e+=b(l,n)}}}}}}}}});if(g.tagName=="input"||g.tagName=="img"||g.tagName=="link"||g.tagName=="meta"){e+="/>"}else{if(!c.isBlank(g.contents)){e+=">";e+=a(g.contents);e+="</"+g.tagName+">"}else{e+="></"+g.tagName+">"}}if(h===true){return e}else{return c(e)}};var b=function(e,f){return" "+e+'="'+f+'"'};var d=function(e){if(c.isBlank(e)){return false}else{if(c.isBlank(e.tagName)&&(!_.isUndefined(e.value)||!c.isBlank(e.onlyIf))){if(e.onlyIf===true){return e.value}else{return false}}else{return e}}};var a=function(e){e=c.makeArray(e);return _.reject(_.map(e,function(f){if(c.isPlainObject(f)){f=c.tag(f,true)}if(_.isArray(f)){f=a(f)}return f}),function(f){return c.isBlank(f)}).join("")};c.button=function(f,e){if(_.isString(f)){f={text:f,href:"#"+c.urlSafe(f)}}return c.tag(c.extend(f.customAttrs,{tagName:"a",href:f.href||"#","class":_.flatten(["button",f.className,f.iconClass]),contents:[{value:{tagName:"span","class":"icon"},onlyIf:!c.isBlank(f.iconClass)},f.text]}),e)}})(jQuery);$(function(){$("#jqmAlert, #jqmConfirm").jqm({trigger:false});window.alert=function(a){$("#jqmAlert").jqmShow().find(".alertMessage").text(a)};window.prettyConfirm=function(c,b,a){$("#jqmConfirm").jqmShow().find(".confirmMessage").text(c).end().find(".button.yes").click(b).end().find(".button.no").click(a).end()}});jQuery.analytics={trackEvent:function(b,d,a,c){if((b===undefined)||(d===undefined)){return false}if(window._gaq===undefined){return false}_gaq.push(["_trackEvent",b,d,a,c])}};if(mixpanel){$(document).ready(function(){});mixpanel.delegate_links=function(c,a,d,b,e){$(c||document.body).on("click",a,function(h){try{var f=_.isFunction(e)?e(h.currentTarget):{};var k=h.which===2||h.metaKey||h.currentTarget.target==="_blank";f.url=h.currentTarget.href;var g=h.isDefaultPrevented();var l=function(){if(!k&&!g&&(f.url!=null)){window.location=f.url}};if(!k&&!b){h.preventDefault()}$.mixpanelMeta();mixpanel.track(d,f,l)}catch(j){if(!g&&(h.currentTarget.href!=null)){window.location=h.currentTarget.href}throw j}})};mixpanel.delegate_links("#siteHeader","a","Clicked Header Item",false,function(b){var a=(b.title!="")?b.title:b.text;return{"Header Item Type":a}});mixpanel.delegate_links("#siteFooter","a","Clicked Footer Item",false,function(b){var a=(b.title!="")?a=b.title:b.text;return{"Footer Item Type":a}});mixpanel.delegate_links(".featuredViews .featuredView","a","Clicked Featured View",false);mixpanel.delegate_links(".gridList .titleLine","a","Clicked Catalog Result",false,function(b){var d=parseFloat($(b).closest(".item").find(".index .value").text());var c=$(b).closest(".browseList").find(".pagination .active").text();var a=(c=="")?1:parseFloat(c);return{"Result Number":d,"Page Number":a}});mixpanel.delegate_links(".facetSection","a","Used Search Facets",false,function(a){facetType=$(a).closest(".facetSection").find("> .title").text();var b=a.text;return{"Facet Type":facetType,"Facet Type Name":b}});mixpanel.delegate_links("#sidebarOptions","a","Clicked Sidebar Option",false,function(a){return{"Sidebar Name":a.title}});mixpanel.delegate_links("#gridSidebar","a.headerLink","Clicked Pane in Sidebar",false,function(a){return{"Pane Name":a.text}});mixpanel.delegate_links("#gridSidebar",".radioBlock .radioLine","Chose Visualization Type",true,function(a){return{"Visualization Type":a.outerText}});mixpanel.delegate_links("#renderTypeOptions","a","Changed Render Type Options",false,function(a){return{"Render Type":a.title}});mixpanel.delegate_links("#janus",".goalBox .pull.down","Opened Goal Chart",false,function(){return{}});mixpanel.delegate_links("#janus",".goalBox .progressViewChart .viewChart","Opened Goal Chart",false,function(){return{}})}(function(){this.User=ServerModel.extend({_init:function(a){this._super();$.extend(this,a)},isCurrentUser:function(){return this.id==blist.currentUserId},isMember:function(){return(this.rights||[]).length>0},isAdmin:function(){return _.include(this.flags,"admin")},nameAndOrEmail:function(){var a="";if(this.displayName){a=this.displayName}if(this.email){if(a==""){a=this.email}else{a+=" ("+this.email+")"}}return a},hasRight:function(a){return _.include(this.rights,a)},getDatasets:function(b){var a=this;if($.isBlank(a._datasets)){a.makeRequest({url:"/users/"+a.id+"/views.json",type:"GET",cache:false,pageCache:true,success:function(c){a._datasets=_.map(c,function(e){return new Dataset(e)});b(a._datasets)}})}else{b(a._datasets)}},addEmailInterest:function(a,c,d){var b=this;b.makeRequest({url:"/users/"+b.id+"/email_interests.json",data:JSON.stringify({eventTag:a.toUpperCase(),extraInfo:c}),type:"POST",success:d})},getEmailInterest:function(a,c,d){var b=this;b.makeRequest({url:"/users/"+b.id+"/email_interests/"+a.toUpperCase(),params:{extraInfo:c},type:"GET",cache:false,pageCache:true,success:d})},removeEmailInterest:function(a,c,d){var b=this;b.makeRequest({url:"/users/"+b.id+"/email_interests/"+a.toUpperCase(),params:{extraInfo:c},type:"DELETE",pageCache:false,success:d})},getProfileImageUrl:function(b){var a=this;b=b.toLowerCase();return a["profileImageUrl"+b.capitalize()]||"/images/"+b+"-profile.png"},getProfileUrl:function(){var a=this;return $.path("/profile/"+$.urlSafe(a.displayName||"-")+"/"+a.id)}});User.createFromUserId=function(c,a,b){$.Tache.Get({url:"/api/users/"+c+".json",success:function(d){if(_.isFunction(a)){a(new User(d))}},error:b})}})();(function(){var a=ServerModel.extend({_init:function(b){this._super();$.extend(this,b);this._translateProperties()},_translateProperties:function(){var b=this;if($.isBlank(b.rawProperties)&&!$.isBlank(b.properties)){b.rawProperties=b.properties;b.properties={};_.each(b.rawProperties,function(c){$.deepSet.apply($,[b.properties,c.value].concat(c.name.split(".")))})}},_validKeys:{"default":true,domainCName:true,id:true,name:true,properties:true,type:true}});a.findByType=function(e,d,b,c){var f=$.extend({merge:true},d,{type:e});$.socrataServer.makeRequest({pageCache:true,url:"/admin/configuration.json",params:f,success:function(g){if(_.isFunction(b)){b(new a(g))}},error:c})};if(blist.inBrowser){this.Configuration=a}else{module.exports=a}})();(function(){var a=function(n,s,p){var q={};var u={};var f={};var c={};var e=n.capitalize();var l=n+"s";var k=l.capitalize();var t=function(v,w){return v[n+"ForID"](w)};var g=function(v,w){return v[n+"ForTCID"](w)};var o=function(v,w){return v[n+"ForFieldName"](w)};var m=function(v,w){return v[n+"ForIdentifier"](w)};var h=function(x,y,w,v){return x["update"+k](y,w,v)};var d=function(v){return v["real"+k]};var j=function(v){return v["visible"+k]};var b={};b[n+"ForID"]=function(v){return q[parseInt(v)||v]};b[n+"ForTCID"]=function(v){return u[parseInt(v)]};b[n+"ForFieldName"]=function(v){return f[v.toString()]};b[n+"ForIdentifier"]=function(v){if($.isBlank(v)){return null}return _.isNumber(v)||(v||"").match(/^\d+$/)?(t(this,v)||g(this,v)):(o(this,v)||t(this,v))};b["meta"+e+"ForName"]=function(v){return c[v.toString()]};b["clear"+e]=function(v){if(!$.isBlank(this._super)){this._super(v)}this[l]=_.without(this[l],v);delete q[v.id];delete q[v.lookup];delete u[v.tableColumnId];delete f[v.fieldName];if(v.isMeta){delete c[v.name]}h(this);this.trigger("columns_changed",["removed"])};b[l+"ForType"]=function(w,v){var x=v?d(this):j(this);if(!$.isBlank(w)){x=_.select(x,function(y){return _.include($.makeArray(w),y.renderTypeName)})}return x};b["add"+e]=function(y,w,x,B){if(!$.isBlank(this._super)&&this._super(arguments)){return true}var v=this;var A=function(C){v[l].push(C);h(v);v.trigger("columns_changed",["added"]);if(_.isFunction(w)){w(t(v,C.id))}};var z={url:p+".json",type:"POST",success:A,error:x};if(!$.isBlank(y)){z.data=JSON.stringify(new Column(y,v).cleanCopy())}if(!$.isBlank(B)){z.params=B}this.makeRequest(z)};b["remove"+k]=function(x,w,y){var v=this;_.each($.makeArray(x),function(A){var B=t(v,A);B.remove(null,y,true)});var z=function(){h(v);if(_.isFunction(w)){w()}};ServerModel.sendBatch(z)};b["setVisible"+k]=function(x,B,v){var D=this;if(_.isEqual(x,_.pluck(j(D),"id"))){if(_.isFunction(B)){B()}return}if(!$.isBlank(D["_adjustVisible"+k])){x=D["_adjustVisible"+k](x)}var A=-1;var z=_.any(x,function(F){var E=t(D,F);if(E.position<=A){return true}A=E.position;return false});var w=false;var y=[];_.each(x,function(G,F){var E=t(D,G);if(!$.isBlank(E)){w=E.show(null,null,true)||w;if(z){E.update({position:F+1})}var H=E.cleanCopy();if(!$.isBlank(H.childColumns)){H.childColumns=_.reject(H.childColumns,function(I){return _.include(I.flags||[],"hidden")})}y.push(H)}});_.each(d(D),function(E){if($.isBlank(_.detect(y,function(F){return F.id==E.id}))){w=E.hide(null,null,true)||w}});h(D,y,false,z);if(!z&&w){_.defer(function(){(D.view||D).trigger("columns_changed",["visibility"])})}if((D.view||D).canUpdate()&&!v){if(z){var C={};C[l]=y;this.makeRequest({url:s,type:"PUT",data:JSON.stringify(C),batch:true})}ServerModel.sendBatch(function(){if(_.isFunction(B)){B()}})}else{(D.view||D)._markTemporary((D.view||D).isUnpublished()||(D.view||D).newBackend);if(_.isFunction(B)){B()}}};b.cleanCopy=function(v){var w=this._super(v);if(!_.isUndefined(w[l])){w[l]=_(w[l]).chain().reject(function(x){return x.id==-1}).sortBy(function(x){return x.position}).value()}return w};b.clone=function(){this._cloneExclude["real"+k]=true;this._cloneExclude["visible"+k]=true;return this._super.apply(this,arguments)};b.setAccessType=function(v){this._super(v);_.each(this[l]||[],function(w){w.setAccessType(v)})};b["update"+k]=function(B,z,y,x){if($.isBlank(this[l])&&$.isBlank(B)){return}var w=this;var v;if(!$.isBlank(B)){if($.isBlank(w[l])){w[l]=B;v="fullSet"}else{var A={};_.each(B,function(F,D){var E=F.dataTypeName!="meta_data"?m(w,F.fieldName||F.id):_.detect(w[l],function(G){return G.dataTypeName=="meta_data"&&G.name==F.name});var C=_.indexOf(w[l],E);if($.isBlank(E)){if(y){w[l].splice(D,0,F)}else{w[l].push(F)}v="added"}else{if(y&&C!=D){w[l].splice(C,1);w[l].splice(D,0,E);v="moved"}E.update(F,z,y)}A[F.id]=true});if(x){w[l]=_.reject(w[l],function(C){if(!A[C.id]){w["clear"+e](C);return true}return false})}}}q={};u={};f={};c={};this[l]=_.map(this[l],function(D,C){if(!(D instanceof Column)){D=new Column(D,w)}else{if($.isBlank(D.view)){D.setParent(w)}}q[D.id]=D;if(D.lookup!=D.id){q[D.lookup]=D}u[D.tableColumnId]=D;f[D.fieldName]=D;if(D.isMeta){c[D.name]=D}if(!$.isBlank(w.accessType)){D.setAccessType(w.accessType)}return D});this["real"+k]=_.reject(this[l],function(C){return C.isMeta});this["visible"+k]=_(d(this)).chain().reject(function(C){return C.hidden}).sortBy(function(C){return C.position}).value();if(_.any(this[l],function(C){return C.renderType.soda1Only})){(w.view||w)._useSODA2=false}if(!$.isBlank(v)){_.defer(function(){(w.view||w).trigger("columns_changed",[v])})}};return b};if(blist&&blist.inBrowser){this.ColumnContainer=a}else{module.exports=a}})();(function(){var a=ServerModel.extend({_init:function(d,b){this._super();$.extend(this,d);this.setParent(b);this.aggregates=this.aggregates||{};$.extend(this._cloneExclude,{_ntInit:true})},baseUrl:function(){if(this.renderTypeName=="geospatial"){return"/api/views/"+this.view.id+"/geometry/"}else{return"/views/"+this.view.id+"/"+(this.renderTypeName.endsWith("_obsolete")?"obsolete_":"")+"files/"}},getSummary:function(b,c){var d=this;c=c||100;var e=function(f){d._summary={};d._summaryLimit=c;_(f.columnSummaries||[]).chain().select(function(g){return g.columnId==d.id}).each(function(g){if((g.topFrequencies||[]).length>0){d._summary[g.subColumnType]=g}});if(_.isFunction(b)){b(d._summary)}};if($.isBlank(d._summary)||c>d._summaryLimit){d.view.makeRequest({inline:true,params:{method:"getSummary",columnId:d.id,limit:c},success:e})}else{if(_.isFunction(b)){b(d._summary)}}},invalidateData:function(){delete this._summary;delete this._summaryLimit},canUpdate:function(){return(this.view.isUnpublished()||!this.view.isDefault())&&this.view.hasRight("update_column")},save:function(b,c){var d=this;var e=function(f){d.update(f,true);if(!$.isBlank(d.parentColumn)){d.parentColumn.updateChildColumns()}else{d.view.updateColumns()}if(_.isFunction(b)){b(d)}};if(d.canUpdate()){this.makeRequest({url:"/views/"+this.view.id+"/columns/"+this.id+".json",type:"PUT",data:JSON.stringify(this.cleanCopy()),success:e,error:c});return true}else{if(!$.isBlank(d.parentColumn)){d.parentColumn.updateChildColumns()}else{d.view.updateColumns()}d.view._markTemporary();return false}},show:function(b,c,d){return this.setVisible(true,b,c,d)},hide:function(b,c,d,e){return this.setVisible(false,b,c,d,e)},setVisible:function(c,b,d,f,g){var e=this;if(e.hidden!==c){return false}e.hidden=!c;if(c){e.flags=_.without(e.flags||[],"hidden")}else{e.flags=e.flags||[];e.flags.push("hidden")}if(!f){if(!$.isBlank(e.parentColumn)){e.parentColumn.updateChildColumns()}else{e.view.updateColumns()}}if(e.canUpdate()&&!g){this.makeRequest({url:"/views/"+this.view.id+"/columns/"+this.id+".json",type:"PUT",data:JSON.stringify({hidden:!c}),batch:f,success:b,error:d})}else{e.view._markTemporary()}return true},update:function(f,e,g){var c=this;f.id=c.id;var b=c.width;var d=c.format.aggregate;if(e){_.each(c._validKeys,function(j,h){if(h!="childColumns"){delete c[h]}})}_.each(f,function(j,h){if(h!="childColumns"&&c._validKeys[h]){c[h]=j}});if(!$.isBlank(f.renderTypeName)){c.renderTypeName=f.renderTypeName}if(!$.isBlank(f.subColumnTypes)){c.subColumnTypes=f.subColumnTypes}this.updateChildColumns(f.childColumns,e,g);if(!$.isBlank(f.dropDown)){c.dropDown=f.dropDown}this._setUpColumn();if(b!==c.width){c.view.trigger("column_resized",[c])}if($.subKeyDefined(f,"updatedAggregate.value")){c.aggregates[f.updatedAggregate.name]=parseFloat(f.updatedAggregate.value);c.view.aggregatesChanged(true)}else{if(d!==c.format.aggregate){c.view.aggregatesChanged()}}},setParent:function(b){if(b instanceof a){this.parentColumn=b;this.view=b.view}else{this.view=b}this._setUpColumn();this.updateChildColumns()},filter:function(g,j,b){var c=this;if($.isBlank(g)){c.clearFilter();return}var f=$.extend(true,{},c.view.metadata);var e=f.jsonQuery;c._clearFilterData(e);var h={columnFieldName:c.fieldName};if(!$.isBlank(j)&&_.isString(j)){if(c.view._useSODA2){h.subColumn=j.toLowerCase()}else{h.subColumn=j.toUpperCase()}}if(c.renderTypeName=="location"&&!$.isBlank(j)&&$.isPlainObject(g)){g=JSON.stringify(g)}var d=$.extend({operator:b||"EQUALS",value:g},h);e.namedFilters=e.namedFilters||{};e.namedFilters["col"+c.id]={where:d};c.currentFilter={value:g,viewFilter:d};c.view.update({metadata:f})},clearFilter:function(){var b=this;var c=$.extend(true,{},b.view.metadata);b._clearFilterData(c.jsonQuery);b.view.update({metadata:c})},remove:function(b,c,f){var e=this;var d=function(){if(!$.isBlank(e.parentColumn)){e.parentColumn.clearChildColumn(e)}else{e.view.clearColumn(e)}if(!f){if(!$.isBlank(e.parentColumn)){e.parentColumn.updateChildColumns()}else{e.view.updateColumns()}}if(_.isFunction(b)){b(e)}};e.makeRequest({url:"/views/"+e.view.id+"/columns/"+e.id+".json",type:"DELETE",batch:f,success:d,error:c})},convert:function(e,b,c){var d=this;var f=function(g){d.id=g.id;d.tableColumnId=g.tableColumnId;d.update(g,true);d.invalidateData();if(!$.isBlank(d.parentColumn)){d.parentColumn.updateChildColumns()}else{d.view.updateColumns()}d.view.reload(true);if(_.isFunction(b)){b(d)}};this.makeRequest({url:"/views/"+this.view.id+"/columns/"+this.id+".json",params:{method:"convert",type:e},type:"POST",success:f,error:c})},cleanCopy:function(){var b=this._super();if(_.include(["dataset_link","picklist"],b.dataTypeName)){delete b.dropDownList}return b},_setUpColumn:function(){var b=this;this.format=this.format||{};this.metadata=this.metadata||{};if(!$.isBlank(this.dropDown)){this.dropDownList=this.dropDown}delete this.dropDown;this.hidden=_.include(this.flags||[],"hidden");this.dataType=blist.datatypes[this.dataTypeName]||{};this.renderType=blist.datatypes[this.renderTypeName]||{};this.isMeta=this.dataTypeName=="meta_data";if(!$.isBlank(b.view)){b.lookup=b.view._useSODA2?b.fieldName:(b.isMeta?b.name:b.id);if(!b.view._useSODA2&&b.isMeta&&b.name=="sid"){b.lookup="id"}else{if(!b.view._useSODA2&&b.isMeta&&b.name=="id"){b.lookup="uuid"}}}this.minWidth=50;this.width=Math.max(this.minWidth,this.width||100);if(!$.isBlank(this.format.grouping_aggregate)&&!$.isBlank(this.format.drill_down)){delete this.format.drill_down;this.width-=30}if(!$.isBlank(this.currentFilter)&&$.isBlank(((this.view.metadata.jsonQuery||{}).namedFilters||{})["col"+this.id])){delete this.currentFilter}if(this.dataTypeName=="nested_table"&&!this._ntInit&&!$.isBlank(this.view)){var c="/views/"+this.view.id+"/columns/"+this.id;a.addProperties(this,ColumnContainer("childColumn",c+".json",c+"/sub_columns"),a.prototype);this._ntInit=true}},updateChildColumns:function(){},isLinked:function(){var b=this;return(b.format&&b.format.linkedKey!=null)},underscoreName:function(e){var c=this;var d;var f;var b=a.sanitizeName(c.name);for(var g=0;g<e.columns.length;g++){d=e.columns[g];if(d.id==c.id){continue}f=a.sanitizeName(d.name);if(b==f){b+="_"+c.position;break}}return b},_clearFilterData:function(c){var b=this;if($.isBlank(b.currentFilter)){return}delete c.namedFilters["col"+b.id];delete b.currentFilter},canBeDatasetLink:function(){if(this.dataTypeName!="text"){return false}if(this.format&&this.format.drill_down==true){return false}if(this.hidden){return false}return true},canBeLinkSource:function(){if(_.include(["dataset_link","nested_table","drop_down_list"],this.dataTypeName)){return false}if(this.hidden){return false}if(this.dataTypeName.indexOf("obsolete")>=0){return false}return true},fieldNameForRollup:function(b){return b?b+"("+this.fieldName+")":this.fieldName},isText:function(){switch(this.dataTypeName){case"text":case"html":return true;default:return false}},_validKeys:{childColumns:true,dataTypeName:true,defaultValues:true,description:true,dropDownList:true,fieldName:true,flags:true,format:true,id:true,metadata:true,name:true,position:true,tableColumnId:true,width:true}});a.sanitizeName=function(c){var b=c.toLowerCase();b=b.replace(/^[^A-z]+/gi,"_");b=b.replace(/[^A-z0-9]+/gi,"_");b=b.replace(/^xml/gi,"_");b=b.replace(/_+/gi,"_");return b};a.closestViewFormat=function(d,c){var b=_.isString(c)||$.isBlank(c)?c:c.format.group_function;if(b!=d.format.group_function){var e=d.renderType.viewTypes;if(_.isFunction(e)){e=e(b,true)}if(!_.any(e,function(f){return f.value==d.format.view})){if($.isBlank(d.format.view)){return _.first(e).value}return _.first(_.sortBy(_.map(e,function(f){return{value:f.value,distance:f.value.startsWith(d.format.view)?1/d.format.view.length:d.format.view.startsWith(f.value)?1/f.value.length:d.format.view.heuristicDistance(f.value)}}),"distance")).value}}return null};if(blist.inBrowser){this.Column=a}else{module.exports=a}})();(function(){var d=ServerModel.extend({_init:function(m,j,l,k,g){this._super();this._dataset=m;this.registerEvent(["row_change","row_count_change","metadata_update"]);this._rows={};this._rowIDLookup={};this._rowsLoading={};this._pendingRowReqs=[];this._parent=k;this._query=l||{};this._jsonQuery=j||{};this._loadedCount=0;this._isComplete=false;this._matchesExpr={where:blist.filter.matchesExpression(this._jsonQuery.where,this._dataset),having:blist.filter.matchesExpression(this._jsonQuery.having,this._dataset)};if(!_.isEmpty(g)){this._addRows(g.rows,g.start);if(!$.isBlank(g.total)){this._totalCount=g.total}}this.formattingChanged();var h=this;this._dataset.bind("columns_changed",function(n,o){if(n=="lookupChange"){h.lookupsChanged(o)}})},getKey:function(){if($.isBlank(this._key)){this._key=d.getQueryKey(this._jsonQuery)}return this._key},rowForID:function(g){return this._rowIDLookup[parseInt(g)||g]},rowForIndex:function(g){return this._rows[g]},rowIndex:function(k,g){var h=this;if(!$.isBlank(h.rowForID(k))){g(h.rowForID(k).index)}else{var j=function(l){g(l[k])};if(h._dataset._useSODA2){g(0)}else{h.makeRequest({inline:true,params:{method:"getByIds",indexesOnly:true,ids:k},success:j})}}},childRowForID:function(k,h,j){var g=h.data[j.lookup];return _.detect(g||{},function(l){return l.id==k})},getTotalRows:function(g,j){var h=this;if($.isBlank(h._totalCount)){h.getRows(0,1,g,j)}else{if(_.isFunction(g)){g()}}},totalRows:function(){return this._totalCount},getRows:function(m,z,h,l){var n=this;if(n._dataset.resourceName!=="datasets"&&!n._isComplete&&(n._parent||{})._isComplete&&n._jsonQuery.search==n._parent._jsonQuery.search&&_.isEmpty(n._jsonQuery.group)&&_.isEmpty(n._parent._jsonQuery.group)){var B=_.map(_.select(n._parent._rows,function(G){return n._doesBelong(G)}),function(G){return $.extend({},G)});n._totalCount=B.length;var u=_.map(B,function(G){return{sorts:[G.id],row:G}});_.each((n._jsonQuery.order||[]).slice().reverse(),function(G){var H=n._dataset.columnForIdentifier(G.columnFieldName);if($.isBlank(H)){return}_.each(u,function(I){var J=I.row.data[H.lookup];if($.isBlank(J)){J=null}else{if(_.isFunction(H.renderType.matchValue)){J=H.renderType.matchValue(J,H)}}I.sorts.unshift(J)})});var q=(n._jsonQuery.order||[]).slice();q.push({ascending:true});B=_.pluck(u.sort(function(I,K){var H=I.sorts;var G=K.sorts;var J=0;while(J<H.length&&H[J]==G[J]){J++}if($.isBlank(H[J])){return 1}if($.isBlank(G[J])){return -1}return(J==H.length?0:((H[J]<G[J]?-1:1)*(q[J].ascending?1:-1)))}),"row");n._addRows(B,0,true)}var w;var k;if(_.isNumber(m)&&_.isNumber(z)){k=m}else{if(_.isArray(m)){w=m}else{if(_.isFunction(l)){l({message:"Missing start and length or ids"})}return}}var C=100;var A=[];var s;var j;var v=k+z-1;var x=[];var F=[];var g=new Date().getTime();var D=function(){if(x.length>0||n._totalCount==0){if(_.isFunction(h)){h(x)}x=[]}};if(z&&!$.isBlank(k)){while(k<=v&&($.isBlank(n._totalCount)||k<n._totalCount)){var o=n._rows[k];if(!$.isBlank(o)&&o.pending&&g>o.expires){delete n._rows[o.index];delete n._rowIDLookup[o.id];F.push(o);o=null}if($.isBlank(o)){D();if(n._rowsLoading[k]){if(!$.isBlank(s)){A.push(s);s=null}if($.isBlank(j)){j={start:k,length:1,successCallback:h,errorCallback:l}}else{j.length++}}else{if(!$.isBlank(j)){n._pendingRowReqs.push(j);j=null}if($.isBlank(s)){s={start:k,finish:k}}else{if(k-s.start+1>C){A.push(s);s={start:k}}else{s.finish=k}}}}else{if(!$.isBlank(s)){A.push(s);s=null}if(!$.isBlank(j)){n._pendingRowReqs.push(j);j=null}x.push(o)}k++}}else{w=_.reject(w||[],function(H){var G=n._rowIDLookup[H];if(G){return x.push(G)}});for(var y=0;y<w.length;y+=100){A.push({ids:w.slice(y,y+100)})}}D();if(F.length>0){n.trigger("row_change",[F,true])}if(!$.isBlank(s)){if(_.isUndefined(s.finish)){s.finish=s.start}A.push(s);s=null}if(!$.isBlank(j)){n._pendingRowReqs.push(j);j=null}if(A.length>0){var p=function(){if($.isBlank(n._totalCount)){if(_.isFunction(l)){l({cancelled:true})}return}_.each(A,function(G){var H;if(G.finish&&!$.isBlank(G.start)){if(G.start>=n._totalCount){return}if(G.finish>=n._totalCount){G.finish=n._totalCount-1}H=G.finish-G.start+1}n._loadRows(G.ids||G.start,H,h,l)})};if($.isBlank(n._totalCount)||n._rerequestMeta){var t=A.shift();var E;if(!$.isBlank(t.finish)&&!$.isBlank(t.start)){E=t.finish-t.start+1}n._loadRows(t.ids||t.start,E,function(G){if(_.isFunction(h)){h(G)}p()},l,true);delete n._rerequestMeta}else{p()}}},getAllRows:function(g,j){var h=this;h.getTotalRows(function(){var k=0;h.getRows(0,h._totalCount,function(l){k+=l.length;if(k>=h._totalCount){h.getRows(0,h._totalCount,g,j)}},j)},j)},loadedRows:function(){return this._rows},addRow:function(h,g){if(!this._doesBelong(h)){return}var j=$.extend({},h);j.index=$.isBlank(g)?this._totalCount:g;this._setRowFormatting(j);$.addItemsToObject(this._rows,j,j.index);this._rowIDLookup[j.id]=j;delete this._aggCache;this._loadedCount++;this._totalCount++;this.trigger("row_count_change")},updateRow:function(j,h){var g=this._rowIDLookup[$.isBlank(h)?j.id:h];$.extend(g,j,{index:g.index});this._setRowFormatting(g);delete this._aggCache;if(!$.isBlank(h)){this._rowIDLookup[g.id]=g;delete this._rowIDLookup[h]}if(!this._doesBelong(g)){this.removeRow(g)}},removeRow:function(g){var h=this.rowForID(g.id);if($.isBlank(h)){return}$.removeItemsFromObject(this._rows,h.index,1);delete this._rowIDLookup[h.id];delete this._aggCache;this._loadedCount--;this._totalCount--},markRow:function(j,h,g){var k=this.rowForID((g||{}).id);if($.isBlank(k)||(k.sessionMeta||{})[j]==h){return}k.sessionMeta=k.sessionMeta||{};k.sessionMeta[j]=h},reload:function(g,j){var h=this;delete h._totalCount;delete h._rows;delete h._rowIDLookup;delete h._aggCache;h._loadRows(0,1,g,j,true,true)},getAggregates:function(s,p){var j=this;var h=[];var k=function(){s(h)};var m=function(u){j._aggCache=j._aggCache||{};_.each(u,function(v){j._aggCache[v.columnIdent]=j._aggCache[v.columnIdent]||{};j._aggCache[v.columnIdent][v.name]=v.value;h.push(v)})};j._aggCache=j._aggCache||{};var n={params:{method:"getAggregates"},inline:true};var l=false;var t=[];if(!$.isBlank(p)){var o=[];_.each(p,function(v,u){var w=j._dataset.columnForIdentifier(u);if($.isBlank(w)){return}_.each($.makeArray(v),function(x,z){if($.subKeyDefined(j._aggCache,w.fieldName+"."+x)){h.push({columnIdent:w.fieldName,name:x,value:j._aggCache[w.fieldName][x]})}else{if(j._isComplete){m([{columnIdent:w.fieldName,name:x,value:j._calculateAggregate(w.fieldName,x)}])}else{if(j._dataset._useSODA2){t.push({method:blist.datatypes.soda2Aggregate(x),column:w.fieldName})}else{l=true;if($.isBlank(o[z])){o[z]=j._dataset.cleanCopy()}var y=_.detect(o[z].columns,function(A){return A.fieldName==w.fieldName});y.format.aggregate=x}}}})});if(!j._dataset._useSODA2){if(l){n.success=function(u){m(_.map(u,function(v){return{columnIdent:v.fieldName,name:v.name,value:v.value}}))};_.each(o,function(u){if($.isBlank(u)){return}var w=$.extend({},n,{data:u,batch:true});j.makeRequest(w)});ServerModel.sendBatch(k)}else{k()}}}else{var q=function(u){if($.subKeyDefined(u,"format.aggregate")){if($.subKeyDefined(j._aggCache,u.fieldName+"."+u.format.aggregate)){h.push({columnIdent:u.fieldName,name:u.format.aggregate,value:j._aggCache[u.fieldName][u.format.aggregate]})}else{if(j._isComplete){m([{columnIdent:u.fieldName,name:u.format.aggregate,value:j._calculateAggregate(u.fieldName,u.format.aggregate)}])}else{if(j._dataset._useSODA2){t.push({method:blist.datatypes.soda2Aggregate(u.format.aggregate),column:u.fieldName})}else{l=true}}}}};_.each(j._dataset.realColumns,function(u){q(u);_.each(u.realChildColumns,function(v){q(v)})});if(!j._dataset._useSODA2){if(l){h=[];n.success=function(u){m(u);m(_.map(u,function(v){return{columnIdent:v.fieldName,name:v.name,value:v.value}}));k()};j.makeRequest(n)}else{k()}}}if(t.length>0){var g=_.map(t,function(u){return u.method+"("+u.column+")"}).join(",");j.makeRequest({params:{"$select":g},success:function(u){m(_.map(u[0],function(x,w){var y=w.indexOf("_");return{columnIdent:w.slice(y+1),name:blist.datatypes.aggregateFromSoda2(w.slice(0,y)),value:x}}));k()}})}else{if(j._dataset._useSODA2){k()}}},activate:function(){var g=this;g._isActive=true;g.trigger("row_change",[_.values(g._rows),true]);_.defer(function(){g.trigger("row_count_change")})},deactivate:function(){this._isActive=false;var g=this._pendingRowReqs;this._pendingRowReqs=[];_.each(g,function(h){if(_.isFunction(h.errorCallback)){h.errorCallback({cancelled:true})}});delete this._curMetaReq;delete this._curMetaReqMeta;this.trigger("row_change",[_.values(this._rows),true])},invalidate:function(k,g){var j=_.values(this._rows);this._rows={};this._rowsLoading={};var h=this._pendingRowReqs;this._pendingRowReqs=[];_.each(h,function(l){if(_.isFunction(l.errorCallback)){l.errorCallback({cancelled:true})}});delete this._curMetaReq;delete this._curMetaReqMeta;this._rowIDLookup={};this._loadedCount=0;this._isComplete=false;delete this._aggCache;if(k){delete this._totalCount}if(g){this._columnsInvalid=true}_.each(this._dataset.columns||[],function(l){l.invalidateData()});this.trigger("row_change",[j,true])},invalidateMeta:function(){this._rerequestMeta=true},formattingChanged:function(g){var h=this;var j=g||($.subKeyDefined(h,"_dataset.metadata.conditionalFormatting")&&h._dataset.metadata.conditionalFormatting);if(!_.isArray(j)){h._condFmt=null}else{h._condFmt=_.map(j,function(k){return $.extend({},k,{matches:blist.filter.matchesExpression(k.condition,h._dataset)})})}_.each(h._rows,function(k){h._setRowFormatting(k)})},lookupsChanged:function(g){var h=this;_.each(h._rows,function(j){_.each(g,function(l,k){_.each(["data","changed","error","invalid"],function(m){j[m][l]=j[m][k]})})})},canDerive:function(g){return a(e(this._jsonQuery.where,true),e(g.where,true))&&a(e(this._jsonQuery.having,true),e(g.having,true))&&_.isEqual(this._jsonQuery.group,g.group)},makeRequest:function(h){h.headers=$.extend(h.headers,{"X-Socrata-Federation":"Honey Badger"});var g=this;if(g._dataset._useSODA2){g._makeSODA2Request(h)}else{if(h.inline){var j;if(!$.isBlank(h.data)){j=_.isString(h.data)?JSON.parse(h.data):h.data}else{j=g._dataset.cleanCopy()}if(!_.isEmpty(g._query)){j.query=j.query||{};j.query.orderBys=g._query.orderBys;j.query.groupBys=g._query.groupBys;j.query.filterCondition=g._query.filterCondition}if($.subKeyDefined(j,"metadata.jsonQuery.select")){_.each(j.metadata.jsonQuery.select,function(l){var k=_.detect(j.columns,function(m){l.columnFieldName==m.fieldName});if($.isBlank(k)){return}if(k instanceof Column){k=k.cleanCopy()}if(!$.isBlank(l.aggregate)){k.format=k.format||{};k.format.grouping_aggregate=blist.datatypes.aggregateFromSoda2(l.aggregate)}})}h.data=JSON.stringify(j)}g._dataset.makeRequest(h)}},_makeSODA2Request:function(n){var j=this;if($.isBlank(j._dataset._queryBase)){j._dataset.getQueryBase(function(){j._makeSODA2Request(n)});return}n.isSODA=true;n.url=n.url||"/api/id/"+j._dataset._queryBase.id+".json";n.params=n.params||{};n.params["$$version"]="2.0";var p=j._dataset._queryBase.metadata.jsonQuery;var h=j._jsonQuery.search==p.search?"":j._jsonQuery.search;if(!$.isBlank(h)){n.params["$search"]=h}if(!_.isEmpty(j._jsonQuery.order)){n.params["$order"]=_.compact(_.map(j._jsonQuery.order,function(q){var s=j._dataset.columnForIdentifier(q.columnFieldName);if($.isBlank(s)){return null}var t=Dataset.translateColumnToQueryBase(s,j._dataset);if($.isBlank(t)){return null}return t.fieldNameForRollup(Dataset.aggregateForColumn(t.fieldName,j._jsonQuery))+(q.ascending?"":" desc")})).join(",");if($.isBlank(n.params["$order"])){delete n.params["$order"]}}if(!_.isEmpty(j._jsonQuery.where)){if(_.isEmpty(p.group)){var k=blist.filter.generateSOQLWhere(blist.filter.subtractQueries(Dataset.translateFilterColumnsToBase(j._jsonQuery.where,j._dataset),p.where),j._dataset._queryBase);n.params["$where"]=!$.isBlank(n.params["$where"])?(n.params["$where"]+" and "+k):k}}if(!_.isEmpty(j._jsonQuery.having)){var l=blist.filter.generateSOQLWhere(blist.filter.subtractQueries(Dataset.translateFilterColumnsToBase(j._jsonQuery.having,j._dataset),p.having),j._dataset._queryBase);n.params["$having"]=!$.isBlank(n.params["$having"])?(n.params["$having"]+" and "+l):l}if(!_.isEmpty(j._jsonQuery.group)&&_.isEmpty(p.group)){var o=[];var m=[];_.each(j._jsonQuery.group,function(t){var s=Dataset.translateColumnToQueryBase(t.columnFieldName,j._dataset);if($.isBlank(s)){return}if($.isBlank(t.groupFunction)){o.push(s);m.push(s)}else{var q=s+"__"+t.groupFunction;o.push(q);m.push(t.groupFunction+"("+s+") as "+q)}});o=_.uniq(o).join(",");n.params["$group"]=!$.isBlank(n.params["$group"])?(n.params["$group"]+","+o):o;m=_.uniq(m.concat(_.compact(_.map(j._jsonQuery.select,function(t){if(!$.isBlank(t.aggregate)){var q=Dataset.translateColumnToQueryBase(t.columnFieldName,j._dataset);if($.isBlank(q)){return null}return t.aggregate+"("+q+")"}return null})))).join(",");var g=(n.params["$select"]||"").replace(/:\*,\*/,"");n.params["$select"]=!$.isBlank(g)?(g+","+m):m}j._dataset.makeRequest(n)},clone:function(){return new d(this._dataset,this._jsonQuery,this._query,this._parent)},_loadRows:function(v,q,j,n,u,g){var l=this;var k=l._dataset.newBackend?{"$select":":*,*"}:l._dataset._useSODA2?{"$$exclude_system_fields":false}:{method:"getByIds",asHashes:true};var h;if(_.isNumber(v)&&_.isNumber(q)){h=v;$.extend(k,l._dataset._useSODA2?{"$offset":h,"$limit":q}:{start:h,length:q})}else{if(_.isArray(v)){if(l._dataset._useSODA2){k["$where"]="any_of(:id,"+v.join(",")+")"}else{k.ids=v}}else{if(_.isFunction(n)){n({message:"Missing start and length, or ids"})}return}}var t=l._dataset.cleanCopy();if(!_.isEmpty(l._query)){t.query=t.query||{};t.query.orderBys=l._query.orderBys;t.query.groupBys=l._query.groupBys;t.query.filterCondition=l._query.filterCondition}if((g||(u||$.isBlank(l._totalCount)||l._columnsInvalid)&&!_.isEqual(t,l._curMetaReqMeta))&&!l._dataset._useSODA2){k.meta=true}if($.isBlank(l._totalCount)&&l._dataset._useSODA2){k["$$row_count"]="approximate"}var p=_.uniqueId();var o=function(K,B,I){if(q&&!$.isBlank(h)){for(var A=0;A<q;A++){delete l._rowsLoading[A+h]}}var G=l._totalCount;if(!$.isBlank(K.meta)){if(l._curMetaReq!=p){if(_.isFunction(n)){_.defer(function(){n({cancelled:true})})}return}delete l._curMetaReq;delete l._curMetaReqMeta;l._totalCount=K.meta.totalRows;delete l._columnsInvalid;var C;if(l._dataset._useSODA2){C={columns:K.meta.view.columns};if(l._dataset.isGrouped()){C.columns=_.reject(C.columns,function(N){if($.subKeyDefined(N,"format.grouping_aggregate")){return true}var L=N.fieldName.indexOf("__");var M;if(!$.isBlank(M=l._dataset.columnForFieldName(N.fieldName.slice(0,L)))&&M.format.group_function==blist.datatypes.groupFunctionFromSoda2(N.fieldName.slice(L+2))){return true}return false})}}else{C=K.meta.view}if(!g&&!l._dataset._useSODA2){C.query.filterCondition=l._dataset.query.filterCondition;if(!$.isBlank(l._dataset.query.namedFilters)){C.query.namedFilters=l._dataset.query.namedFilters}C.metadata=l._dataset.metadata}l.trigger("metadata_update",[C,!l._dataset._useSODA2,!l._dataset._useSODA2])}else{if(l._dataset._useSODA2){var F=JSON.parse(I.getResponseHeader("X-SODA2-Row-Count")||"null");if(_.isNumber(F)){l._totalCount=F}var D=JSON.parse(I.getResponseHeader("X-SODA2-Fields"));var z=_.map(D,function(L){var M=l._dataset.findColumnForServerName(L);if($.isBlank(M)){if(L.startsWith(":")){M={id:-1,name:L.slice(1),fieldName:L,dataTypeName:"meta_data",renderTypeName:"meta_data"}}else{$.debug("!!!!!!!!!!!! Unknown column: "+L)}}return M});if(!_.any(z,function(L){return L.fieldName==":id"})&&$.isBlank(l._dataset.metaColumnForName("id"))){z.push({id:-1,name:"id",fieldName:":id",dataTypeName:"meta_data",renderTypeName:"meta_data"})}l.trigger("metadata_update",[{columns:z}])}else{if($.isBlank(l._totalCount)){if(_.isFunction(n)){_.defer(function(){n({cancelled:true})})}return}}}var J;if(K.pending&&q&&!$.isBlank(h)){J=[];var w=[];var y=new Date().getTime()+30000;for(var A=0;A<q;A++){var H={invalid:{},error:{},changed:{},index:A+h,pending:true,expires:y,id:"pending_"+_.uniqueId()};if(!$.isBlank(l._rows[H.index])){var E=l._rows[H.index];w.push(E);delete l._rowIDLookup[E.id]}l._rows[H.index]=H;l._rowIDLookup[H.id]=H;J.push(H)}if(w.length>0){l.trigger("row_change",[w,true])}}else{J=l._addRows(K.data||K,h)}if(G!==l._totalCount){l.trigger("row_count_change")}if(!l._isActive){if(_.isFunction(n)){_.defer(function(){n({cancelled:true})})}return}if(_.isFunction(j)){j(J)}var x=l._pendingRowReqs;l._pendingRowReqs=[];_.each(x,function(L){l.getRows(L.start,L.length,L.successCallback,L.errorCallback)})};if(q&&!$.isBlank(h)){for(var m=0;m<q;m++){l._rowsLoading[m+h]=true}}if($.browser.safari&&!l._dataset._useSODA2){k.safariCacheBust=Math.random().toString().slice(2)}var s={success:o,params:k,inline:!l._dataset._useSODA2&&!g,type:l._dataset._useSODA2||g?"GET":"POST"};if(!l._dataset._useSODA2&&g){s.url="/views/"+l._dataset.id+"/rows.json"}if(k.meta){l._curMetaReq=p;l._curMetaReqMeta=t}if(l._dataset._useSODA2&&$.parseParams().$$store){s.params["$$store"]=$.parseParams().$$store}l.makeRequest(s)},_addRows:function(l,n,k){var j=this;var h=[];var m=[];var g=!$.isBlank(n);_.each(l,function(s,q){var p=k?s:d.translateRow(s,j._dataset,j);var t;if(g){t=n+q}if(g){if(!$.isBlank(j._rows[t])&&($.isBlank(p)||p.id!=j._rows[t].id)){var o=j._rows[t];m.push(o);delete j._rows[t];delete j._rowIDLookup[o.id];j._loadedCount--}}else{var o=j._rowIDLookup[p.id];if(!$.isBlank(o)){m.push(o);delete j._rowIDLookup[o.id];j._loadedCount--}}if($.isBlank(p)){return}if(g){p.index=t;j._rows[p.index]=p}j._rowIDLookup[p.id]=p;j._loadedCount++;h.push(p)});j._isComplete=j._totalCount==j._loadedCount;if(m.length>0){j.trigger("row_change",[m,true])}return h},_doesBelong:function(g){return(this._dataset.isGrouped()?true:this._matchesExpr.where(g))&&this._matchesExpr.having(g)},_calculateAggregate:function(h,n){var j=this;var l=j._dataset.columnForIdentifier(h);var m;if($.isBlank(l)){_.any(j._dataset.columnsForType("nested_table",true),function(o){l=o.childColumnForID(h);if(!$.isBlank(l)){m=o;return true}return false})}if($.isBlank(l)){return null}var g=_.detect(l.renderType.aggregates,function(o){return blist.datatypes.aggregateFromSoda2(o.value)==n});if($.isBlank(g)){return null}var k=function(o){var p=function(s,u,q,t){if(u.invalid[l.lookup]!==true){if(!$.isBlank(m)&&t===o){_.reduce(u.data[m.lookup],p,s)}else{s.push(u.data[l.lookup])}}return s};return _.reduce(o,p,[])};return g.calculate(k(j._rows))},_setRowFormatting:function(j){var h=this;j.color=j.icon=null;if(!_.isArray(h._condFmt)){return null}var g=_.detect(h._condFmt,function(k){return k.matches(j)})||{};if(g.color){j.color=g.color}if(g.icon){j.icon=g.icon}}});d.translateRow=function(j,l,h,k,m){var g={invalid:{},changed:{},error:{},sessionMeta:{},data:{},metadata:{}};if(_.any(j,function(p,s){var o=p;var q=l.findColumnForServerName(s,k);if($.isBlank(q)){return !m}if(q.isMeta&&q.name=="meta"&&_.isString(o)){o=JSON.parse(o||"null")}if($.isPlainObject(o)){if(_.all(o,function(t){return $.isBlank(t)||_.isBoolean(t)})){o=null}}if(l._useSODA2&&$.subKeyDefined(q,"renderType.fromSoQLValue")){o=q.renderType.fromSoQLValue(o,q)}if(q.renderTypeName=="checkbox"&&o===false||q.renderTypeName=="stars"&&o===0){o=null}if(q.renderTypeName=="geospatial"&&j[l._useSODA2?":id":"sid"]){o=$.extend({},o,{row_id:j[l._useSODA2?":id":"sid"]})}if(q.dataTypeName=="nested_table"&&_.isArray(o)){o=_.map(o,function(t){return d.translateRow(t,l,h,q)});if(_.any(o,function(t){return _.isNull(t)})){return true}}if(!_.isUndefined(o)){g.data[q.lookup]=o;if(q.isMeta){g.metadata[q.lookup.startsWith(":")?q.lookup.slice(1):q.lookup]=o}}return false})){return null}if($.isBlank(g.metadata.id)){g.metadata.id="jsrowid-"+_.uniqueId();var n=l.metaColumnForName("id");if(!$.isBlank(n)){g.data[n.lookup]=g.metadata.id}}g.id=g.metadata.id;_.each((g.metadata.meta||{}).invalidCells||{},function(p,o){if(!$.isBlank(p)){var q=!$.isBlank(k)?k.childColumnForIdentifier(o):l.columnForIdentifier(o);if(!$.isBlank(q)&&$.isBlank(g.data[q.lookup])){g.invalid[q.lookup]=true;g.data[q.lookup]=p}}});delete (g.metadata.meta||{}).invalidCells;_.each((l._commentLocations||{})[g.id]||{},function(o,p){var q=l.columnForTCID(p);if(!$.isBlank(q)){g.annotations=g.annotations||{};g.annotations[q.lookup]="comments"}});if(!$.isBlank(h)){h._setRowFormatting(g);if($.subKeyDefined(l,"highlights."+g.id)){h.markRow("highlight",true,g)}}return g};d.getQueryKey=function(g){return c(g.order)+"/"+f(g.group)+"/"+blist.filter.getFilterKey(g.where)+"/"+blist.filter.getFilterKey(g.having)+"/"+b(g.select)+"/"+g.search};function c(g){if(_.isEmpty(g)){return""}return"("+_.map(g,function(h){return h.columnFieldName+":"+h.ascending}).join("|")+")"}function f(g){if(_.isEmpty(g)){return""}return"("+_.map(_.sortBy(g,"columnFieldName"),function(h){return h.columnFieldName+":"+h.groupFunction}).join("|")+")"}function b(g){if(_.isEmpty(g)){return""}return"("+_.map(_.sortBy(g,"columnFieldName"),function(h){return h.columnFieldName+":"+h.aggregate}).join("|")+")"}function e(g,h){if(h){g=$.extend(true,{},g)}_.each(g.children,function(j){j._parent=g;e(j)});return g}function a(k,h){if(_.isEmpty(k)){return true}if(_.isEmpty(h)){return false}var m=[];var g=function(p){if(_.isArray(p.children)){_.each(p.children,g)}else{if($.isBlank(p._key)){p._key=blist.filter.getFilterKey(p)}m.push(p)}};g(k);var o=[];var j={};var l=function(s){if(_.isArray(s.children)){var q=_.select(s.children,l);if(q.length==s.children.length){return true}else{if(q.length>0){o=o.concat(q);return false}}}if($.isBlank(s._key)){s._key=blist.filter.getFilterKey(s)}var p;m=_.reject(m,function(t){if(t._key==s._key){var v=t._parent==k&&s._parent==h&&k.operator==h.operator||$.isBlank(t._parent)&&$.isBlank(s._parent)||$.isBlank(t._parent)&&s._parent.operator.toLowerCase()=="and"||$.isBlank(s._parent)&&t._parent.operator.toLowerCase()=="or";var u;if(!v){if($.isBlank(t._parent)||$.isBlank(s._parent)||t._parent.operator!=s._parent.operator){return false}if($.isBlank(t._parent._key)){t._parent._key=blist.filter.getFilterKey(t._parent)}if($.isBlank(s._parent._key)){s._parent._key=blist.filter.getFilterKey(s._parent)}u=t._parent._key+"::"+s._parent._key;if($.isBlank(j[u])){j[u]=a(t._parent,s._parent)}}if(v||j[u]){p=t;return true}}return false});return $.isBlank(p)};if(l(h)){return false}var n=function(s){var q=[];var t=false;while(s.length>0){var w=s[0];if($.isBlank(w._parent)){q.push(s.shift());continue}var v=w._parent;var u=[];s=_.reject(s,function(p){if(p._parent==v){u.push(p);return true}return false});if(u.length==v.children.length){q.push(v);t=true}else{q=q.concat(u)}}return t?n(q):q};m=n(m);return _.all(m,function(p){return !$.isBlank(p._parent)&&p._parent.operator.toLowerCase()=="or"})&&_.all(o,function(p){return $.isBlank(p._parent)||p._parent.operator.toLowerCase()=="and"})}if(blist.inBrowser){this.RowSet=d}else{module.exports=d}})();(function(){var a=ServerModel.extend({_init:function(o){this._super();this.registerEvent(["columns_changed","valid","query_change","set_temporary","clear_temporary","row_change","blob_change","row_count_change","column_resized","displayformat_change","displaytype_change","column_totals_changed","removed","permissions_changed","new_comment","reloaded","conditionalformatting_change","saved","dataset_last_modified"]);var q=this;_.each(o,function(t,s){if(!_.isFunction(q[s])){q[s]=t}});if(!(blist.sharedDatasetCache[this.id] instanceof a)){blist.sharedDatasetCache[this.id]=this}if(!$.isBlank(this.resourceName)&&!(blist.sharedDatasetCache[this.resourceName] instanceof a)){blist.sharedDatasetCache[this.resourceName]=this}var p="/views/"+this.id;a.addProperties(this,ColumnContainer("column",p+".json",p+"/columns"),$.extend({},this));if(!$.isBlank(this.approvalHistory)){a.addProperties(this,a.modules.approvalHistory,$.extend({},this))}this.updateColumns(this.initialMetaColumns,false,true);delete this.initialMetaColumns;this._adjustProperties();var n=this._getQueryGrouping();this._syncQueries(n.oldJsonQuery,n.oldQuery,n.oldGroupings,n.oldGroupAggs);this.temporary=false;this.minorChange=true;this.valid=this._checkValidity();var m=q.cleanJsonFilters();q._savedRowSet=new RowSet(q,$.extend({},q.metadata.jsonQuery,{where:m.where,having:m.having,namedFilters:null}),{orderBys:(q.query||{}).orderBys,filterCondition:q.cleanFilters(),groupBys:(q.query||{}).groupBys,groupFuncs:q._getGroupedFunctions()},null,q.initialRows);delete q.initialRows;q._activateRowSet(q._savedRowSet);this._pendingRowEdits={};this._pendingRowDeletes={};this._aggregatesStale=true;this._origObj=this.cleanCopy();this._commentCache={};this._commentByID={};if(!$.isBlank(blist.snapshot)&&blist.snapshot.takeSnapshot){this.snapshotting=true;if(!$.isBlank(blist.snapshot.forcedTimeout)){this._setupDefaultSnapshotting(blist.snapshot.forcedTimeout*1000)}else{if(_.isFunction(this.supportsSnapshotting)&&this.supportsSnapshotting()){if(_.isFunction(this._setupSnapshotting)){this._setupSnapshotting()}}else{this._setupDefaultSnapshotting(5000)}}}},rowForID:function(m){return this._activeRowSet.rowForID(m)},rowForIndex:function(m){return this._activeRowSet.rowForIndex(m)},rowIndex:function(n,m){this._activeRowSet.rowIndex(n,m)},totalRows:function(){return this._activeRowSet.totalRows()},isDefault:function(){return _.include(this.flags||[],"default")},isPublic:function(){var m=this;return _.any(this.grants||[],function(n){return _.include(n.flags||[],"public")&&((m.type=="form"&&n.type=="contributor")||m.type!="form")})},isAnonymous:function(m){if(!$.isBlank(m)){this._isAnon=m}if($.isBlank(this._isAnon)){this._isAnon=false}return this._isAnon},hasRight:function(m){return _.include(this.rights,m)},canEdit:function(){return(this.hasRight("write")||this.hasRight("add")||this.hasRight("delete"))&&!this.isGrouped()&&!this.isAPI()},canUpdate:function(){return(this.isUnpublished()||!this.isDefault())&&this.hasRight("update_view")},isGrid:function(){return this.metadata.renderTypeConfig.visible.table},isAltView:function(){return !_.isEqual(["table","fatrow","page"],this.metadata.availableDisplayTypes)},isGrouped:function(){return !_.isEmpty((this.metadata.jsonQuery||{}).group)},isFederated:function(){return !$.isBlank(this.domainCName)},isArcGISDataset:function(){if(this.metadata&&this.metadata.custom_fields&&this.metadata.custom_fields.Basic&&this.metadata.custom_fields.Basic.Source){return true}return false},isGeoDataset:function(){return(this.metadata&&this.metadata.geo)},isBlobby:function(){return(this.type=="blob")},isHref:function(){return(this.type=="href")},isTabular:function(){return(this.viewType=="tabular")},isExportable:function(){if(this.newBackend){return this.displayName==="dataset"||this.displayName==="working copy"}else{return true}},isAPI:function(){return(this.type=="api")},isPublished:function(){return this.publicationStage=="published"},isUnpublished:function(){return this.publicationStage=="unpublished"},isSnapshot:function(){return this.publicationStage=="snapshotted"},forceEditable:function(){return $.parseParams("$$force_editable")=="true"},isImmutable:function(){if(this.forceEditable()){return false}return(this.isBlobby()||this.isGeoDataset())},renderWithArcGISServer:function(){return this.isArcGISDataset()},invalidMessage:function(){return this.message||$.t("controls.grid.required_cols_missing")},clean:function(){return f(this)},save:function(m,o,n){var s=this;if(!s.hasRight("update_view")){return false}var q=$.isBlank(s.visibleColumns)?null:_.pluck(s.visibleColumns,"id");var p=function(t){s._savedRowSet=s._activeRowSet;s._update(t,true,false,true);if(!$.isBlank(q)&&!_.isEqual(q,_.pluck(s.visibleColumns,"id"))){s.setVisibleColumns(q)}if(_.isFunction(m)){m(s)}s.trigger("saved")};this.makeRequest({url:"/views/"+this.id+".json",type:"PUT",data:JSON.stringify(f(this,n)),error:o,success:p});return true},saveNew:function(m,n){var o=this;var p=function(s){s=new a(s);if(!$.isBlank(o.accessType)){s.setAccessType(o.accessType)}if(_.isFunction(m)){m(s)}};var q=b(this);if(o.isPublic()&&o.type=="form"){q.flags=q.flags||[];q.flags.push("dataPublicAdd")}this.makeRequest({url:"/views.json",type:"POST",data:JSON.stringify(q),error:n,success:p})},update:function(t,n,m){var q=this;if(!_.isEqual(t,q._cleanUnsaveable(t))){m=false}var p=m?f:b;var s=p(this);this._update(t,n,n);var o=p(this);if(!_.isEqual(s,o)){this._markTemporary(m)}},reload:function(o,m,n){var p=this;if(p.isBlobby()){p.trigger("blob_change");return}p._aggregatesStale=true;if(o){p.makeRequest({url:"/api/views/"+p.id+".json",type:"GET",success:function(q){p._update(q,true,true,true);p.trigger("reloaded")}})}else{p._update(p._origObj,true,true,true);p.trigger("reloaded")}},simpleSort:function(o,n){var s=this;var q=$.extend(true,{},s.metadata);var p=q.jsonQuery;var m=s.columnForIdentifier(o);if($.isBlank(m)){delete p.order}else{p.order=[{columnFieldName:m.fieldName,ascending:n===true}]}s.update({metadata:q},false,(p.order||[]).length<2)},showRenderType:function(m,q,p){var o=this;if(!p&&o.metadata.renderTypeConfig.visible[m]){return}var n=$.extend(true,{},o.metadata);n.renderTypeConfig.visible[m]=true;if(q&&q!=o.id){$.deepSet(n,q,"renderTypeConfig","active",m,"id")}o.update({metadata:n},false,true)},hideRenderType:function(m){var o=this;if(!o.metadata.renderTypeConfig.visible[m]){return}var n=$.extend(true,{},o.metadata);delete n.renderTypeConfig.visible[m];o.update({metadata:n},false,true)},toggleRenderType:function(m){if(this.metadata.renderTypeConfig.visible[m]){this.hideRenderType(m)}else{this.showRenderType(m)}},blobs:function(){var n=this;if(!$.isBlank(this._blobs)){return this._blobs}if(this.isBlobby()){var m={type:(this.blobMimeType||"").replace(/;.*/,""),size:this.blobFileSize,href:"/api/file_data/"+this.blobId+"?"+$.param({filename:this.blobFilename})};if(this.blobFilename!=this.name){m.name=this.blobFilename}this._blobs=[m]}else{if(this.isHref()){this._blobs=[];if($.subKeyDefined(this,"metadata.accessPoints")){_.each(this.metadata.accessPoints,function(p,o){if(!o.endsWith("Size")){n._blobs.push({href:p,type:o.toUpperCase(),size:n.metadata.accessPoints[o+"Size"]})}});this._blobs=_.sortBy(this._blobs,"type")}else{if($.subKeyDefined(this,"metadata.href")){this._blobs.push({href:this.metadata.href,type:"Link",size:"Unknown"})}}}}return this._blobs},userGrants:function(m,n){var o=this,p=function(){var s=_.reject(o.grants,function(t){return _.include(t.flags||[],"public")});if(_.isFunction(m)){m(s)}},q=function(s){o.grants=s||[];p();o._grantsFetched=true};if(!this._grantsFetched){o.makeRequest({url:"/api/views/"+o.id+"/grants.json",success:q,error:n});this._grantsFetched="fetching"}else{if(this._grantsFetched===true){p()}}},removeGrant:function(p,m,o){var q=this;var n=function(){q.grants=_.reject(q.grants||[],function(s){return(!$.isBlank(p.userId)&&p.userId==s.userId)||(!$.isBlank(p.userEmail)&&p.userEmail==s.userEmail)});if(_.isFunction(m)){m()}};q.makeRequest({url:"/api/views/"+q.id+"/grants/i",params:{method:"delete"},type:"PUT",data:JSON.stringify(p),success:n,error:o})},createGrant:function(p,m,o,q){var s=this;var n=function(t){s.grants=s.grants||[];s.grants.push(t);if(_.isFunction(m)){m()}};s.makeRequest({url:"/api/views/"+s.id+"/grants/",type:"POST",data:JSON.stringify(p),batch:q,success:n,error:o})},replaceGrant:function(s,p,m,o){var q=this;var n=function(){q.createGrant(p,m,o)};q.removeGrant(s,n,o)},makePublic:function(m,n){var o=this;var p=function(){o.trigger("permissions_changed");if(_.isFunction(m)){m.apply(o,arguments)}};if(!o.isPublic()){o.grants=o.grants||[];o.grants.push({type:(o.type=="form"?"contributor":"viewer"),flags:["public"]});o.makeRequest({url:"/views/"+o.id,type:"PUT",params:{method:"setPermission",value:(o.type=="form"?"public.add":"public.read")},success:p,error:n})}else{p()}},makePrivate:function(m,n){var o=this;var p=function(){o.trigger("permissions_changed");if(_.isFunction(m)){m.apply(o,arguments)}};if(o.isPublic()){o.grants=_.reject(o.grants,function(q){return _.include(q.flags||[],"public")&&q.inherited!==true});o.makeRequest({url:"/views/"+o.id+".json",type:"PUT",params:{method:"setPermission",value:"private"},success:p,error:n})}else{p()}},notifyUsers:function(m,n){this.makeRequest({url:"/api/views/"+this.id+".json",params:{method:"notifyUsers"},type:"POST",success:m,error:n})},addColumn:function(p,m,n,q){if(!$.isBlank((p||{}).parentId)){var o=this.columnForID(p.parentId);if($.isBlank(o)){throw"Column "+p.parentId+" not found"}o.addChildColumn(p,m,n);return true}},getTotalRows:function(m,n){this._activeRowSet.getTotalRows(m,n)},getClusters:function(w,A,y,n,u){var o=this;if(!o._clusters){o._clusters={}}if(!o._rowClusterParents){o._rowClusterParents={}}if(!($.subKeyDefined(A,"plot.locationId")&&(o.columnForIdentifier(A.plot.locationId)||{}).renderTypeName=="location")){u();return}var s={method:"clustered2"};_.each({xmin:"min_lon",xmax:"max_lon",ymin:"min_lat",ymax:"max_lat"},function(B,C){s[B]=w[C]});s.target_node_clusters=250;s.min_distance_between_clusters=y;if(!s.min_distance_between_clusters){s.min_distance_between_clusters=Math.min(w.xmax-w.xmin,w.ymax-w.ymin)/10;if(s.min_distance_between_clusters>5){s.min_distance_between_clusters=5}else{if(s.min_distance_between_clusters>1){s.min_distance_between_clusters=1}}}var m=function(B){B.parent=o._clusters[B.pathToRoot[0]];o._clusters[B.id]=B;_.each(B.points,function(C){o._rowClusterParents[C]=B});_.each(B.children,function(C){if(o._clusters[C]&&!o._clusters[C].parent){o._clusters[C].parent=o._clusters[o._clusters[C].pathToRoot[0]]}});_.each(B.polygon,function(C){if(C.lat==90){C.lat-=0.000001}else{if(C.lat==-90){C.lat+=0.000001}}if(C.lon==180){C.lon-=0.000001}else{if(C.lon==-180){C.lon+=0.000001}}});B.leafNode=(B.points||[]).length>0};var v=o.isDefault()||$.subKeyDefined(o,"query.filterCondition")||o.cleanFilters()||$.isPresent($.deepGetStringField(o,"metadata.jsonQuery.search"))||($.isPresent(A)&&!_.isEqual(A,o.displayFormat));var x;if(v){if($.subKeyDefined(o,"query.namedFilters.viewport")){var t=o.query.namedFilters.viewport;delete o.query.namedFilters.viewport;x=o.cleanCopy();o.query.namedFilters.viewport=t}else{x=o.cleanCopy()}if(!$.isBlank(A)){x.displayFormat=A}x=JSON.stringify(x)}if(s.max_lon<s.min_lon){var q=2;var p=[];var z=function(B){q--;p=p.concat(B);o.trigger("row_count_change");if(q==0){n(p)}};o.makeRequest({url:"/views/"+o.id+"/rows.json",params:$.extend({},s,{min_lon:-179.999999}),data:x,inline:v,success:function(B){_.each(B,m);z(B)},error:u});o.makeRequest({url:"/views/"+o.id+"/rows.json",params:$.extend({},s,{max_lon:179.999999}),data:x,inline:v,success:function(B){_.each(B,m);z(B)},error:u})}else{o.makeRequest({url:"/views/"+o.id+"/rows.json",params:s,data:x,inline:v,success:function(B){_.each(B,m);o.trigger("row_count_change");n(B)},error:u})}},getRows:function(p,n,m,o){this._activeRowSet.getRows(p,n,m,o)},getAllRows:function(m,n){this._activeRowSet.getAllRows(m,n)},getRowsByIds:function(o,m,n){this._activeRowSet.getRows(o,null,m,n)},loadedRows:function(){return this._activeRowSet.loadedRows()},invalidateMeta:function(){this._activeRowSet.invalidateMeta()},invalidateRows:function(){this._activeRowSet.invalidate()},createRow:function(s,v,t,n,u){var o=this;var q;if(!$.isBlank(t)){q=this.columnForID(t)}var p;if(!$.isBlank(v)){p=this.rowForID(v)}s=s||{data:{}};var x={data:{},metadata:$.extend({},s.metadata),invalid:{},error:{},changed:{}};_.each(!$.isBlank(q)?q.childColumns:o.columns,function(y){if(!$.isBlank(s.data[y.lookup])){x.data[y.lookup]=s.data[y.lookup]}});x.id="saving"+_.uniqueId();delete x.data.uuid;_.each(!$.isBlank(q)?q.realChildColumns:o.realColumns,function(y){x.changed[y.lookup]=true});if($.isBlank(p)){o._addRow(x,s.index)}else{p.data[q.lookup]=p.data[q.lookup]||[];if(!$.isBlank(s.index)){p.data[q.lookup].splice(s.index,0,x)}else{p.data[q.lookup].push(x)}o._updateRow(p);o.trigger("row_change",[[p],true])}var w=x.id;if(!$.isBlank(p)){w+=":"+p.id+":"+q.id}o._pendingRowEdits[w]=[];var m={row:x,rowData:o._rowData(x,_.pluck(_.reject(!$.isBlank(q)?q.realChildColumns:o.realColumns,function(y){return y.dataTypeName=="nested_table"}),"id"),q),parentRow:p,parentColumn:q,success:n,error:u};if($.isBlank(o._pendingRowCreates)){o._serverCreateRow(m);o._pendingRowCreates=[]}else{o._pendingRowCreates.push(m)}return x.id},setRowValue:function(v,q,m,n,u,t){var s;var p;if(!$.isBlank(t)){s=this.columnForID(t);p=s.childColumnForID(m)}else{p=this.columnForID(m)}if($.isBlank(p)){throw"Column "+m+" not found"}if(p.isMeta){throw"Cannot modify metadata on rows: "+m}var w;if(!$.isBlank(u)){var o=this.rowForID(u);w=this._activeRowSet.childRowForID(q,o,s)}else{w=this.rowForID(q)}if($.isBlank(w)){throw"Row "+q+" not found while setting value "+v}w.data[p.lookup]=v;delete w.error[p.lookup];w.changed[p.lookup]=true;w.invalid[p.lookup]=n||false;this._activeRowSet.updateRow(o||w);this.trigger("row_change",[[o||w]])},saveRow:function(s,x,u,o,w,v){var q=this;var t;if(!$.isBlank(u)){t=this.columnForID(u)}var p;var A;if(!$.isBlank(x)){p=this.rowForID(x);A=this._activeRowSet.childRowForID(s,p,t)}else{A=this.rowForID(s)}if($.isBlank(A)){throw"Row "+s+" not found while saving"}var m=_.keys(A.changed);var y=q._rowData(A,m,t);var n={row:A,rowData:y,columnsSaving:m,parentRow:p,parentColumn:t,success:o,error:w};var z=A.id;if(!$.isBlank(p)){z+=":"+p.id+":"+t.id}if(!$.isBlank(q._pendingRowEdits[z])){q._pendingRowEdits[z].push(n);return}q._pendingRowEdits[z]=[];q._serverSaveRow(n,v)},removeRows:function(o,q,n,m,p){var t=this;o=$.makeArray(o);var u;if(!$.isBlank(n)){u=this.columnForID(n)}var s;if(!$.isBlank(q)){s=this.rowForID(q)}_.each(o,function(y){var w;if($.isBlank(s)){var x=t.rowForID(y);if($.isBlank(x)){return}w=t._useSODA2?x.id:x.metadata.uuid;t._removeRow(x)}else{s.data[u.lookup]=_.reject(s.data[u.lookup],function(z){if(z.id==y){w=t._useSODA2?z.id:z.metadata.uuid;return true}return false});t._updateRow(s)}var v=y;if(!$.isBlank(s)){v+=":"+s.id+":"+u.id}if(!$.isBlank(t._pendingRowEdits[v])){t._pendingRowDeletes[v]={rowId:w,parRowId:q,parColId:n};return}t._serverRemoveRow(w,q,n,true)});if(!$.isBlank(s)){t.trigger("row_change",[[s],true])}else{t.trigger("row_count_change")}t._aggregatesStale=true;_.each(!$.isBlank(u)?u.realChildColumns:t.realColumns,function(v){v.invalidateData()});ServerModel.sendBatch({success:m,error:p})},markRow:function(n,m,o){_.each(this._availableRowSets,function(p){p.markRow(n,m,o)})},highlightRows:function(w,q,o,t){var m=this;w=$.makeArray(w);q=q||"default";m.highlightTypes=m.highlightTypes||{};m.highlightsColumn=m.highlightsColumn||{};if(!t){if(!$.isBlank(m.highlightTypes[q])){var v={};_.each(w,function(x){v[x.id]=true});m.unhighlightRows(_.reject(m.highlightTypes[q],function(y,x){return v[x]&&($.isBlank(o)&&$.isBlank(m.highlightsColumn[x])||(o||{}).id==m.highlightsColumn[x])}),q)}else{m.highlightTypes[q]={}}}m.highlights=m.highlights||{};var s=[];for(var p=0;p<w.length;p++){var u=w[p];m.highlightTypes[q][u.id]=u;if(!m.highlights[u.id]){m.highlights[u.id]=true;if(!$.isBlank(o)){m.highlightsColumn[u.id]=o.id}var n=m.rowForID(u.id);if(!$.isBlank(n)){m.markRow("highlight",true,n);if(!$.isBlank(o)){m.markRow("highlightColumn",o.id,n)}}s.push(n||u)}}if(s.length>0){m.trigger("row_change",[s])}},unhighlightRows:function(s,o){var q=this;s=$.makeArray(s);o=o||"default";q.highlightTypes=q.highlightTypes||{};q.highlights=q.highlights||{};q.highlightsColumn=q.highlightsColumn||{};var p=[];for(var n=0;n<s.length;n++){var t=s[n];if(!$.isBlank(q.highlightTypes[o])){delete q.highlightTypes[o][t.id]}if(_.any(q.highlightTypes,function(u){return !$.isBlank(u[t.id])})){continue}if(q.highlights[t.id]){delete q.highlights[t.id];delete q.highlightsColumn[t.id];var m=q.rowForID(t.id);if(!$.isBlank(m)){q.markRow("highlight",false,m);q.markRow("highlightColumn",null,m)}p.push(m||t)}}if(p.length>0){q.trigger("row_change",[p])}},rowToSODA2:function(n){var m={":index":n.index};_.each(this.columns,function(o){m[o.fieldName]=n.data[o.lookup];if(o.renderTypeName=="location"&&$.subKeyDefined(m[o.fieldName],"human_address")&&_.isString(m[o.fieldName].human_address)){m[o.fieldName].human_address=JSON.parse(m[o.fieldName].human_address)}if(o.renderTypeName=="drop_down_list"&&!$.isBlank(m[o.fieldName])){m[o.fieldName]=o.renderType.renderer(m[o.fieldName],o,true)}});_.each(this.columns,function(o){if(o.isMeta&&_.isUndefined(m[o.name])){m[o.name]=m[o.fieldName]}});return m},findColumnForServerName:function(n,t){var s=this;n=s._useSODA2?n:({sid:"id",id:"uuid"}[n]||n);var u=s._useSODA2?$.isBlank(t)?s.columnForFieldName(n):t.childColumnForFieldName(n):$.isBlank(t)?s.columnForID(n):t.childColumnForID(n);if($.isBlank(u)){if(s._useSODA2&&s.isGrouped()){var p=n.indexOf("__");var o=n.slice(p+2);var q=n.slice(0,p);u=$.isBlank(t)?s.columnForIdentifier(q):t.childColumnForIdentifier(q);if($.isBlank(u)||u.format.group_function!=blist.datatypes.groupFunctionFromSoda2(o)){p=n.indexOf("_");var m=n.slice(0,p);n=n.slice(p+1);u=$.isBlank(t)?s.columnForIdentifier(n):t.childColumnForIdentifier(n);if($.isBlank(u)||u.format.grouping_aggregate!=blist.datatypes.aggregateFromSoda2(m)){return null}}}else{return null}}return u},getAggregates:function(q,n){var o=this;var p=function(s){_.each(s,function(t){var u=o.columnForIdentifier(t.columnIdent);if($.isBlank(u)){_.each(o.columnsForType("nested_table",true),function(v){u=u||v.childColumnForIdentifier(t.columnIdent)})}if(!$.isBlank(u)){u.aggregates[t.name]=$.isBlank(t.value)?null:parseFloat(t.value)}});o._aggregatesStale=false;o.trigger("column_totals_changed");if(_.isFunction(q)){q()}};if(o._aggregatesStale){_.each(o.realColumns,function(s){s.aggregates={}})}var m=o._aggregatesStale||_.any(n||{},function(u,s){var t=o.columnForID(s);if($.isBlank(t)){return true}return _.any($.makeArray(u),function(v){return $.isBlank(t.aggregates[v])})})||$.isBlank(n)&&_.any(o.visibleColumns,function(s){return $.subKeyDefined(s.format.aggregate)&&$.isBlank(s.aggregates[s.format.aggregate])});if(m){o._activeRowSet.getAggregates(p,n)}else{if(_.isFunction(q)){q()}}},aggregatesChanged:function(m){if(!m){this._aggregatesStale=true}this.trigger("column_totals_changed")},updateRating:function(o,m,n){this.makeRequest({url:"/views/"+this.id+"/ratings.json",type:"POST",data:JSON.stringify(o),success:m,error:n})},remove:function(m,n){var p=this;var o=function(){p.trigger("removed");if(_.isFunction(m)){m()}};p.makeRequest({url:"/api/views/"+p.id+".json",type:"DELETE",success:o,error:n})},registerOpening:function(m){var n={method:"opening"};if($.isPresent(m)){n.referrer=m}if(this._useSODA2&&$.parseParams().$$store){n["$$store"]=$.parseParams().$$store}this.makeRequest({url:"/views/"+this.id+".json",params:n,type:"POST"});a.saveRecentDataset(this)},downloadUrl:function(m){if(this.isGeoDataset()){return this.metadata.geo.owsUrl+"?method=export&format="+m}return"/api/views/"+this.id+"/rows."+m.toLowerCase()+"?accessType=DOWNLOAD"},_getCommentCacheKey:function(m){return $.isBlank(m.rowId)?this.id:_.compact([m.rowId,m.tableColumnId]).join("_")},getComments:function(q,o,m){var n=this;var p=n._getCommentCacheKey({rowId:o,tableColumnId:m});if($.isBlank(n._commentCache[p])){n.makeRequest({url:"/views/"+n.id+"/comments.json",params:!$.isBlank(o)?{r:o}:null,type:"GET",pageCache:true,success:function(s){n._commentCache[p]=n._commentCache[p]||[];_.each(s,function(u){n._commentByID[u.id]=u;var t=n._getCommentCacheKey(u);n._commentCache[t]=n._commentCache[t]||[];n._commentCache[t].push(u)});q(n._commentCache[p])}})}else{q(n._commentCache[p])}},getCommentLocations:function(n){var m=this;if($.isBlank(m._commentLocations)){m.makeRequest({url:"/views/"+m.id+"/comments.json",params:{method:"getCellsWithComments"},type:"GET",pageCache:true,success:function(o){m._commentLocations={};var p={};_.each(o,function(s){var t=m.columnForTCID(s.tablecolumnid);if($.isBlank(t)){return}m._commentLocations[s.rowid]=m._commentLocations[s.rowid]||{};m._commentLocations[s.rowid][s.tablecolumnid]=true;var q=m.rowForID(s.rowid);if(!$.isBlank(q)){q.annotations=q.annotations||{};q.annotations[t.lookup]="comments";m._updateRow(q);p[s.rowid]=q}});m.trigger("row_change",[_.values(p)]);if(_.isFunction(n)){n(m._commentLocations)}}})}else{if(_.isFunction(n)){n(m._commentLocations)}}},addComment:function(s,n,o){var p=this;var q=p._getCommentCacheKey(s);var m=function(u){if($.isBlank(u.rowId)){p.numberOfComments++}if(!$.isBlank(p._commentCache[q])){p._commentCache[q].unshift(u)}p._commentByID[u.id]=u;if(!$.isBlank(p._commentLocations)&&!$.isBlank(u.rowId)){p._commentLocations[u.rowId]=p._commentLocations[u.rowId]||{};p._commentLocations[u.rowId][u.tableColumnId]=true;var t=p.rowForID(u.rowId);var v=p.columnForTCID(u.tableColumnId);if(!$.isBlank(t)&&!$.isBlank(v)){t.annotations=t.annotations||{};t.annotations[v.lookup]="comments";p._updateRow(t);p.trigger("row_change",[[t]])}}p.trigger("new_comment",[u,s.parent]);if(_.isFunction(n)){n(u)}};p.makeRequest({url:"/views/"+p.id+"/comments.json",type:"POST",data:JSON.stringify(s),success:m,error:o})},removeComment:function(p,m,o){var q=this;var n=q._commentByID[p];if($.isBlank(n)){return}q.makeRequest({url:"/views/"+this.id+"/comments/"+p+".json",type:"DELETE",success:m,error:o})},flagComment:function(p,m,o){var q=this;var n=q._commentByID[p];if(!$.isBlank(n)){n.flags=n.flags||[];if(!_.include(n.flags,"flag")){n.flags.push("flag")}}q.makeRequest({url:"/views/"+this.id+"/comments/"+p+".json",type:"PUT",data:JSON.stringify({flags:["flag"]}),success:m,error:o})},rateComment:function(s,q,m,o){var t=this;var n=t._commentByID[s];if(!$.isBlank(n)){if((n.currentUserRating||{}).thumbUp!==q){var p=q?"up":"down";n[p+"Ratings"]++;if(!$.isBlank(n.currentUserRating)){n[(q?"down":"up")+"Ratings"]--}n.currentUserRating=n.currentUserRating||{};n.currentUserRating.thumbUp=q}}t.makeRequest({url:"/views/"+t.id+"/comments/"+s+"/ratings.json",params:{thumbsUp:q},type:"POST",success:m,error:o})},getRelatedViewCount:function(o){var n=this;var m;if($.isBlank(n._relatedViews)&&$.isBlank(n._relViewCount)){n._loadRelatedViews(function(p){o(p)},true)}else{if(!$.isBlank(n._relViewCount)){m=n._relViewCount}else{m=n._relatedViews.length}}o(m)},getParentDataset:function(n){var m=this;if(($.isBlank(m._parent)||$.isBlank(m._parent.columns))&&$.isBlank(m.noParentAvailable)){m.makeRequest({url:"/views/"+this.id+".json",params:{method:"getDefaultView"},success:function(o){if(o.id==m.id){m._parent=m}else{m._parent=new a(o);if(!$.isBlank(m.accessType)){m._parent.setAccessType(m.accessType)}}n(m._parent)},error:function(o){if(JSON.parse(o.responseText).code=="permission_denied"){m.noParentAvailable=true}n()}})}else{n(m._parent)}},getParentView:function(n){var m=this;if(($.isBlank(m._modifyingView)||$.isBlank(m._modifyingView.columns))&&$.isBlank(m.noModifyingViewAvailable)){if(!_.isUndefined(m.modifyingViewUid)){a.createFromViewId(m.modifyingViewUid,function(o){m._modifyingView=o;if(!$.isBlank(m.accessType)){m._modifyingView.setAccessType(m.accessType)}n(m._modifyingView)},function(o){if(JSON.parse(o.responseText).code=="permission_denied"){m.noModifyingViewAvailable=true}n()})}else{m.getParentDataset(n)}}else{n(m._modifyingView)}},getRelatedViews:function(n){var m=this;if($.isBlank(m._relatedViews)){m._loadRelatedViews(function(){n(m._relatedViews)})}else{n(m._relatedViews)}},getViewForDisplay:function(o,p){var m=this._childViewsForType(o);if(!m){p(this);return}var n=$.deepGet(true,this,"metadata","renderTypeConfig","active",o);if(!n.id){n.id=m[0]}this._getChildView(n.id,p)},getQueryBase:function(p){var n=this;if(!$.isBlank(n._queryBase)){if(_.isFunction(p)){p()}return}var o=function(){if(!$.isBlank(n._queryBase)&&n._queryBase.id==n.id){n._queryBase.reload(true)}};n.bind("saved",o,n);n.bind("columns_changed",function(q){if(q=="added"||q=="fullSet"||q=="removed"){o()}},n);var m=function(){a.createFromViewId(n.id,function(q){n._queryBase=q;if(_.isFunction(p)){p()}})};if(n.hasRight("update_view")&&!n.isDefault()){n.getParentView(function(q){if(!$.isBlank(q)){n._queryBase=q;if(_.isFunction(p)){p()}}else{m()}})}else{m()}},getChildOptionsForType:function(o,q){var p=this;var n=p._childViewsForType(o);if(!n){q([p])}else{var m=[];_.each(n,function(s){p._getChildView(s,function(t){m.push(t)},true)});ServerModel.sendBatch(function(){q(m)})}},redirectTo:function(n){var m="";if(!$.isBlank(n)){m="?"+$.toParam(n)}window.location=this.url+m},_cachedLinkedColumnOptions:{},getLinkedColumnOptions:function(p,t,o,n){var s=this;var m=p&&p["format.linkedKey"]?p["format.linkedKey"]:p;if($.isBlank(m)||isNaN(m)){return[]}var q=s.columnForID(m).format.linkedDataset;if($.isBlank(q)||!q.match(blist.util.patterns.UID)){return[]}if($.isBlank(s._cachedLinkedColumnOptions[q])){s.makeRequest({url:"/api/views/"+q+".json",pageCache:true,type:"GET",error:function(u){alert(JSON.parse(u.responseText).message)},success:function(w){var v=new a(w);if(!$.isBlank(s.accessType)){v.setAccessType(s.accessType)}s._cachedLinkedColumnOptions[q]=[];var x=s._cachedLinkedColumnOptions[q];var u;_.each(v.columns||[],function(y){if(y.canBeLinkSource()){u={value:String(y.fieldName),text:y.name,dataType:y.dataTypeName};x.push(u)}});if(s._cachedLinkedColumnOptions[q].length<=0){alert("Dataset "+q+" does not have any columns.")}else{o.data("linkedFieldValues","_reset");_.each(o.data("linkedGroup"),function(y){$(y).trigger("change")});_.defer(function(){o.val(n)})}}});return[]}s._cachedLinkedColumnOptions[m]=s._cachedLinkedColumnOptions[q];return s._cachedLinkedColumnOptions[q]},getLinkSourceDataType:function(t,x,u){var o=t&&t.format?t.format.linkedKey:u;var s=blist.dataset;var v=s.columnForID(o);if(v==undefined){return null}var m=v.format.linkedDataset;var w=s._cachedLinkedColumnOptions[m];if(w==null){return null}for(var q=w.length-1;q>=0;q--){if(w[q].value==x){var p=w[q].dataType;return{value:p,text:blist.datatypes[p].title}}}return null},hasDatasetLinkColumn:function(){var m=this;if(m&&m.parentId){return false}return _.any(m.columns,function(n){return(n.dataTypeName=="dataset_link")})},supportsSnapshotting:function(){return false},takeSnapshot:function(){var m=blist.snapshot.name;setTimeout(function(){socrataScreenshot.defineRegion(m,0,0,window.innerWidth,window.innerHeight);socrataScreenshot.snap(m);socrataScreenshot.done()},1000)},getFullSnapshotUrl:function(m){m=this._getThumbNameOrDefault(m);if($.isBlank(this._getCroppedThumbnailMeta(m))){return null}return this.getSnapshotNamed(m)},getSnapshotNamed:function(m){return"/api/views/"+this.id+"/snapshots/"+escape(m)},getCroppedSnapshotUrl:function(m){m=this._getThumbNameOrDefault(m);var n=this._getCroppedThumbnailMeta(m);if($.isBlank(n)){return null}return this.getSnapshotNamed(n.filename)},requestSnapshot:function(m,n){this._updateSnapshot("snapshot",m,n)},cropSnapshot:function(m,n){this._updateSnapshot("cropExisting",m,n)},makeUnpublishedCopy:function(m,o,n){var p=this;if(p.isDefault()){p.makeRequest({url:"/api/views/"+p.id+"/publication.json",params:{method:"copy"},type:"POST",pending:function(){p.copyPending=true;if(_.isFunction(o)){o()}},error:n,success:function(q){delete p.copyPending;p._unpublishedView=new a(q);if(_.isFunction(m)){m(p._unpublishedView)}}})}else{p.getParentDataset(function(q){p._startRequest();q.makeUnpublishedCopy(function(){p._finishRequest();if(_.isFunction(m)){m.apply(p,arguments)}},o,n)})}},publish:function(m,n){var o=this;o.makeRequest({url:"/api/views/"+o.id+"/publication.json",type:"POST",error:n,success:function(q){var p=new a(q);if(_.isFunction(m)){m(p)}}})},getPublishedDataset:function(n){var m=this;if($.isBlank(m._publishedViews)){m._loadPublicationViews(function(){n(_.detect(m._publishedViews,function(o){return o.isDefault()}))})}else{n(_.detect(m._publishedViews,function(o){return o.isDefault()}))}},getUnpublishedDataset:function(n){var m=this;if($.isBlank(m._publishedViews)){m._loadPublicationViews(function(){n(m._unpublishedView)})}else{n(m._unpublishedView)}},getPredeployApiView:function(m,n){var o=this;o.makeRequest({url:"/api/views/"+o.id+"/publication.json",params:{method:"getOrMakePredeployApiView"},cache:false,type:"GET",success:function(p){m(new a(p))},error:n})},getPublishingAvailable:function(m){var n=this;if(n.columnsForType("location").length<1){m(true);return}n.makeRequest({url:"/api/geocoding/"+n.id+".json",params:{method:"pending"},success:function(o){m(o.view<1,$.t("controls.grid.geocodes_pending"))}})},getSnapshotDatasets:function(n){var m=this;if($.isBlank(m._snapshotViews)){m._loadPublicationViews(function(){n(_.select(m._snapshotViews,function(o){return o.isDefault()}))})}else{n(_.select(m._snapshotViews,function(o){return o.isDefault()}))}},getOperationStatuses:function(n){var m=this;m.makeRequest({url:"/views/"+m.id,params:{method:"operationStatuses"},success:n})},cleanFilters:function(p){var o=this;var n;if(!$.isBlank((o.query||{}).filterCondition)){n=$.extend(true,{},o.query.filterCondition)}if(!$.isBlank((o.query||{}).namedFilters)){var m=[];_.each(o.query.namedFilters,function(q){if(_.isEmpty(q)||p&&q.temporary){return}if(!$.isBlank(q.displayTypes)&&!_.include(q.displayTypes,o.displayType)){return}q=$.extend(true,{},q);delete q.temporary;delete q.displayTypes;m.push(q)});if(m.length>0){if($.isBlank(n)&&m.length==1){n=_.first(m)}else{if($.isBlank(n)){n={children:[],type:"operator",value:"AND"}}else{if(n.type!="operator"||n.value!="AND"){n={type:"operator",value:"AND",children:[n]}}}n.children=(n.children||[]).concat(m)}}}return n},cleanJsonFilters:function(p){var o=this;var n={};_.each(["where","having"],function(q){if($.subKeyDefined(o,"metadata.jsonQuery."+q)){n[q]=$.extend(true,{},o.metadata.jsonQuery[q])}});if($.subKeyDefined(o,"metadata.jsonQuery.namedFilters")){var m={where:[],having:[]};_.each(o.metadata.jsonQuery.namedFilters,function(q){if(p&&q.temporary){return}if(!$.isBlank(q.displayTypes)&&!_.include(q.displayTypes,o.displayType)){return}q=$.extend(true,{},q);delete q.temporary;delete q.displayTypes;m.where.push(q.where);m.having.push(q.having)});_.each(["where","having"],function(q){m[q]=_.compact(m[q]);if(m[q].length>0){if(_.isEmpty(n[q])&&m[q].length==1){n[q]=_.first(m[q])}else{if(_.isEmpty(n[q])){n[q]={children:[],operator:"AND"}}else{if(n[q].operator!="AND"){n[q]={operator:"AND",children:[n[q]]}}}n[q].children=(n[q].children||[]).concat(m[q])}}})}return n},cleanCopy:function(m){var n=this._super(m);if(!$.isBlank(n.query)){n.query.filterCondition=this.cleanFilters();delete n.query.namedFilters}if($.subKeyDefined(n,"metadata.jsonQuery")){$.extend(n.metadata.jsonQuery,this.cleanJsonFilters());delete n.metadata.jsonQuery.namedFilters}return n},changeOwner:function(o,m,n){var p=this;p.makeRequest({url:"/views/"+p.id+"?method=plagiarize&userId="+o,type:"PUT",success:m,error:n})},getShareTypes:function(){var m=["Contributor","Owner"];if(this.type!="form"){m.unshift("Viewer")}return m},preferredImage:function(o){var p=this;if($.isBlank(o)){o="thumb"}var n;if(!$.isBlank(p.iconUrl)){return"/assets/"+escape(p.iconUrl)+"?s=thumb"}else{if(n=$.deepGet(p,"metadata","thumbnail","page","filename")){var m="";if(p.isFederated()){m+="//"+this.domainCName}m+="/api/views/"+p.id+"/snapshots/page?size=thumb";return m}}return null},preferredImageType:function(){var m=this;if(!$.isBlank(m.iconUrl)){return"customImage"}else{if($.subKeyDefined(m,"metadata.thumbnail.page.filename")){return"thumbnail"}}return""},_checkValidity:function(){return $.isBlank(this.message)},_markTemporary:function(m){var n=this.minorChange;this.minorChange=this.minorChange&&(m||false);if(!this.temporary||n!==this.minorChange){this.temporary=true;this.trigger("set_temporary");if((blist.debug||{}).temporary&&(console||{}).trace){console.groupCollapsed("markingTemporary");console.trace();console.groupEnd()}}},_clearTemporary:function(){if(this.temporary){this.temporary=false;this.minorChange=true;this.trigger("clear_temporary")}},_adjustProperties:function(){var q=this;q.originalViewId=q.id;var n=false;if(!_.isUndefined(blist.feature_flags.useSoda2)){if(blist.feature_flags.useSoda2==="always"){n=true}else{if(blist.feature_flags.useSoda2==="never"){n=false}else{if(blist.feature_flags.useSoda2==="read-only"){n=!!blist.currentUser}}}}if(q.newBackend||blist.configuration.useSoda2||n){q._useSODA2=true}else{q._useSODA2=false}var p=$.urlParam(window.location.href,"soda");if(p==="1"){q._useSODA2=false}if(p==="2"){q._useSODA2=true}q.type=h(q);if(q.isUnpublished()){q.styleClass="Unpublished"}else{if(q.type=="blist"&&q.isSnapshot()){q.styleClass="Snapshotted"}else{q.styleClass=q.type.capitalize()}}if($.isBlank(q.displayType)){q.displayType={tabular:"table",blobby:"blob",href:"href"}[q.viewType||"tabular"]}q.displayName=k(q);q.searchString=q.searchString||undefined;if(!$.isBlank(q.message)&&q.type=="filter"){delete q.message}if(!q._addedProperties){var o=[q.type];if($.subKeyDefined(q,"metadata.availableDisplayTypes")){o=_.without(q.metadata.availableDisplayTypes,q.type);o.push(q.type)}_.each(o,function(s){a.addProperties(q,a.modules[s]||{},$.extend({},q))});q._addedProperties=true}q.displayFormat=q.displayFormat||{};q.metadata=q.metadata||{};if(_.isFunction(q._convertLegacy)){q._convertLegacy()}if(!$.subKeyDefined(q,"metadata.availableDisplayTypes")){var m;if(_.include(["blob","href","form","api"],q.type)){m=[q.type]}else{m=["table","fatrow","page"];if(!$.isBlank(q.displayType)&&!_.include(["blist","filter","grouped"],q.type)){m.unshift(q.displayType)}}q.metadata.availableDisplayTypes=m}if(!$.subKeyDefined(q,"metadata.renderTypeConfig.visible")){q.metadata=$.extend(true,{renderTypeConfig:{visible:{}}},q.metadata);q.metadata.renderTypeConfig.visible[q.displayType]=true}if($.subKeyDefined(q,"metadata.renderTypeConfig.active")&&!_.any(q.metadata.renderTypeConfig.active,function(s){return s.id=="self"})){q.metadata.renderTypeConfig.active[_.first(_.keys(q.metadata.renderTypeConfig.visible))]={id:"self"}}q.url=q._generateUrl();q.fullUrl=q._generateUrl(true);q.shortUrl=q._generateShortUrl(true);q.apiUrl=q._generateApiUrl();q.domainUrl=q._generateBaseUrl(q.domainCName)},_activateRowSet:function(n){var o=this;if(n==o._activeRowSet){return}if(!$.isBlank(o._activeRowSet)){o._activeRowSet.deactivate();_.each(["row_change","row_count_change","metadata_update"],function(p){o._activeRowSet.unbind(p,null,o)})}o._activeRowSet=n;o._availableRowSets=o._availableRowSets||{};var m=o._activeRowSet.getKey();if(o._availableRowSets[m]!=o._activeRowSet){o._availableRowSets[m]=o._activeRowSet}if(!$.isBlank(o._activeRowSet)){_.each(["row_change","row_count_change"],function(p){o._activeRowSet.bind(p,function(){o.trigger(p,arguments)},o)});o._activeRowSet.bind("metadata_update",function(){o._update.apply(o,arguments)});o._activeRowSet.activate()}},_getChildView:function(n,q,o){if(!this.childViews){throw"No such child view"}this._childViews||(this._childViews={});if(!this._childViews[n]){var m=this;var p=function(s){m._childViews[n]=s;if(s!=m){s.unbind(null,null,m);s.bind("displaytype_change",function(){m.trigger("displaytype_change")},m)}q(s)};if(n=="self"){p(m)}else{a.lookupFromViewId(n,p,undefined,o)}}else{q(this._childViews[n])}},_childViewsForType:function(m){if(m=="map"){return false}if(!_.include(["table","fatrow","page"],m)){return false}return this.childViews},_update:function(n,q,x,p){var y=this;n.id=y.id;n.flags=_.without(n.flags||[],"unsaved");if(_.include(y.flags||[],"default")&&!_.include(n.flags||[],"default")){n.flags=n.flags||[];n.flags.push("default")}var o=y._getQueryGrouping();var C=$.extend(true,{},y.displayFormat);var E=y.displayType;var u=$.extend(true,{},y.metadata.renderTypeConfig);var A=y.metadata.conditionalFormatting;if(q){_.each(y._validKeys,function(G,F){if(F!="columns"){delete y[F]}})}_.each(n,function(G,F){if(F!="columns"&&y._validKeys[F]){y[F]=G}});y._adjustProperties();if(!$.isBlank(n.columns)){y.updateColumns(n.columns,q,x,p)}y._syncQueries(o.oldJsonQuery,o.oldQuery,o.oldGroupings,o.oldGroupAggs);var m;if(!_.isEqual(u.visible,y.metadata.renderTypeConfig.visible)||!_.isEqual(u.active,y.metadata.renderTypeConfig.active)){_.each(y.metadata.renderTypeConfig.visible,function(F,G){if(F&&!_.include(y.metadata.availableDisplayTypes,G)){y.metadata.availableDisplayTypes.unshift(G)}});if(_.isEmpty(y.metadata.renderTypeConfig.visible)){y.metadata.renderTypeConfig.visible[y.displayType]=true}y.displayType=_.detect(y.metadata.availableDisplayTypes,function(F){return y.metadata.renderTypeConfig.visible[F]});m=true}else{if(E!=y.displayType){if(!$.isBlank(y.displayType)&&!_.include(y.metadata.availableDisplayTypes,y.displayType)){y.metadata.availableDisplayTypes.unshift(y.displayType)}y.metadata.renderTypeConfig.visible={};y.metadata.renderTypeConfig.visible[y.displayType]=true;m=true}}var w=!_.isEqual(u.visible,y.metadata.renderTypeConfig.visible)&&_.any(y.query.namedFilters||[],function(F){return _.any(F.displayTypes||[],function(G){return u.visible[G]||y.metadata.renderTypeConfig.visible[G]})});var t=y.cleanJsonFilters();var z=$.extend({},y.metadata.jsonQuery,{where:t.where,having:t.having,namedFilters:null});var D=RowSet.getQueryKey(z);if(w||($.subKeyDefined(y,"_activeRowSet._key")&&y._activeRowSet._key!=D)){y.aggregatesChanged();var s=w||y._activeRowSet._key!=D;if(s){if(!$.isBlank(y._availableRowSets[D])){y._activateRowSet(y._availableRowSets[D])}else{var B=_.detect(_.sortBy(y._availableRowSets,function(F,G){return -(F._isComplete?1000000:1)*G.length}),function(F){return F.canDerive(z)});y._activateRowSet(new RowSet(y,z,{orderBys:(y.query||{}).orderBys,filterCondition:y.cleanFilters(),groupBys:(y.query||{}).groupBys,groupFuncs:y._getGroupedFunctions()},B))}}else{y._invalidateAll(s)}y.trigger("query_change")}else{if(!_.isEqual(A,y.metadata.conditionalFormatting)){if(!$.isBlank(y._availableRowSets)&&!$.isBlank(y._activeRowSet)){_.each(y._availableRowSets,function(F){F.formattingChanged()});y.trigger("row_change",[_.values(y._activeRowSet._rows)])}y.trigger("conditionalformatting_change")}}if(m){y.trigger("displaytype_change")}if(!_.isEqual(C,y.displayFormat)){y.trigger("displayformat_change")}if(p){y._clearTemporary();y._origObj=y.cleanCopy()}else{if(_.isEqual(y._origObj,y.cleanCopy())){y._clearTemporary()}}var v=y.valid;y.valid=y._checkValidity();if(!v&&y.valid){y.trigger("valid")}},_syncQueries:function(m,q,n,s){var t=this;t.query=t.query||{};t.metadata.jsonQuery=t.metadata.jsonQuery||{};if(!_.isUndefined(m)&&!_.isEqual($.deepCompact(m),$.deepCompact(t.metadata.jsonQuery))||!_.isEmpty(t.metadata.jsonQuery)&&_.isEmpty(t.query)){t.query.filterCondition=blist.filter.generateSODA1(t.metadata.jsonQuery.where,t.metadata.jsonQuery.having,t.metadata.defaultFilters);t.query.namedFilters=t.query.namedFilters||{};_.each(t.metadata.jsonQuery.namedFilters,function(u,v){t.query.namedFilters[v]=$.extend(blist.filter.generateSODA1(u.where,u.having),{temporary:u.temporary,displayTypes:u.displayTypes})});t.query.orderBys=_.compact(_.map(t.metadata.jsonQuery.order,function(u){var v=t.columnForIdentifier(u.columnFieldName);if($.isBlank(v)){return null}return{expression:{columnId:v.id,type:"column"},ascending:u.ascending}}));t.query.groupBys=_.compact(_.map(t.metadata.jsonQuery.group,function(u){var v=t.columnForIdentifier(u.columnFieldName);if($.isBlank(v)){return null}v.format.group_function=blist.datatypes.groupFunctionFromSoda2(u.groupFunction);return{columnId:v.id,type:"column"}}));t.searchString=t.metadata.jsonQuery.search;if(!_.isEmpty(t.metadata.jsonQuery.group)){t.metadata.jsonQuery.select=t.metadata.jsonQuery.select||[];_.each(t.metadata.jsonQuery.group.slice(0).reverse(),function(u){if(!_.any(t.metadata.jsonQuery.select,function(v){return v.columnFieldName==u.columnFieldName})){t.metadata.jsonQuery.select.unshift({columnFieldName:u.columnFieldName})}})}_.each(t.metadata.jsonQuery.select,function(u){var v=t.columnForIdentifier(u.columnFieldName);if(!$.isBlank(v)&&!$.isBlank(u.aggregate)){v.format.grouping_aggregate=blist.datatypes.aggregateFromSoda2(u.aggregate)}})}else{if(!_.isUndefined(q)&&!_.isEqual($.deepCompact(q),$.deepCompact(t.query))||_.isEmpty(t.metadata.jsonQuery)&&!_.isEmpty(t.query)){t.metadata.jsonQuery.group=a.translateGroupBys(t.query.groupBys,t,t._getGroupedFunctions());var p=a.translateFilterCondition(t.query.filterCondition,t);t.metadata.jsonQuery.where=p.where;t.metadata.jsonQuery.having=p.having;var o=$.deepCompact(p.defaults);if($.isPresent(o)&&!$.isEmptyObject(o)){t.metadata.defaultFilters=p.defaults}t.metadata.jsonQuery.namedFilters=t.metadata.jsonQuery.namedFilters||{};_.each(t.query.namedFilters,function(v,w){var u=a.translateFilterCondition(v,t);t.metadata.jsonQuery.namedFilters[w]=$.extend({},{where:u.where,having:u.having,temporary:v.temporary,displayTypes:v.displayTypes})});t.metadata.jsonQuery.order=_.compact(_.map(t.query.orderBys,function(u){var v=t.columnForIdentifier(u.expression.columnId);if($.isBlank(v)){return null}return{columnFieldName:v.fieldName,ascending:u.ascending}}))}t.metadata.jsonQuery.search=t.searchString;if(!_.isEmpty(t.metadata.jsonQuery.group)){t.metadata.jsonQuery.select=_.compact(_.map(t.metadata.jsonQuery.group,function(u){return{columnFieldName:u.columnFieldName}}).concat(_.map(t.realColumns,function(u){return $.subKeyDefined(u,"format.grouping_aggregate")?{columnFieldName:u.fieldName,aggregate:blist.datatypes.soda2Aggregate(u.format.grouping_aggregate)}:null})))}else{delete t.metadata.jsonQuery.select}}_.each(["namedFilters","filterCondition","orderBys","groupBys"],function(u){if(_.isEmpty(t.query[u])){delete t.query[u]}});_.each(["namedFilters","group","where","having","search","order","select"],function(u){if(_.isEmpty(t.metadata.jsonQuery[u])){delete t.metadata.jsonQuery[u]}});t._updateGroupings(n,s);_.each(t.realColumns||[],function(u){delete u.sortAscending});_.each(t.metadata.jsonQuery.order||[],function(u){var v=t.columnForIdentifier(u.columnFieldName);if(!$.isBlank(v)){v.sortAscending=u.ascending}})},_getQueryGrouping:function(){var n=this;var m={};m.oldGroupings=(n.query||{}).groupBys;m.oldGroupAggs={};if((m.oldGroupings||[]).length>0){_.each(n.realColumns,function(o){if($.isPresent(o.format.grouping_aggregate)){m.oldGroupAggs[o.id]=o.format.grouping_aggregate}})}m.oldQuery=n.query||{};m.oldJsonQuery=$.extend(true,{},n.metadata.jsonQuery);return m},_updateGroupings:function(n,s){var t=this;if($.isBlank((t.query||{}).groupBys)&&$.isBlank(n)){return}var u=$.isBlank(n);if(u){t._origColOrder=_.pluck(t.visibleColumns,"id")}var m=false;var o={};_.each(t.realColumns,function(v){if(v.format.drill_down){o[v.id]=true}delete v.format.drill_down});var q=[];_.each(t.query.groupBys||[],function(w){var v=t.columnForID(w.columnId);if($.isBlank(v)){return}if($.isBlank(v.format.grouping_aggregate)){if(!o[v.id]){v.width+=30;m=true}v.format.drill_down="true"}if(v.hidden&&!_.any(n||[],function(x){return x.columnId==v.id})){v.update({flags:_.without(v.flags,"hidden")});m=true}q.push(v.id)});var p={};_(t.realColumns).chain().select(function(v){return !$.isBlank(v.format.grouping_aggregate)}).each(function(v){if(v.hidden&&!$.isBlank(s)&&!s[v.id]){v.update({flags:_.without(v.flags,"hidden")})}p[v.id]=v.format.grouping_aggregate;q.push(v.id)});if($.isBlank(s)){s=p}if(_.isEmpty(t.query.groupBys)){if(!$.isBlank(t._origColOrder)){t.setVisibleColumns(t._origColOrder,null,true)}}else{_.each(t.realColumns,function(x){var v=_.indexOf(q,x.id);if(v<0&&!x.hidden){var w=x.flags||[];w.push("hidden");x.update({flags:w});m=true}if(u){if(v<0){v=x.position+q.length}x.position=v+1}});t.updateColumns()}if(m){t.trigger("columns_changed")}if(!_.isEqual(s,p)){t._invalidateAll(false,true)}},_getGroupedFunctions:function(){var m={};_.each(this.realColumns,function(n){if(!$.isBlank(n.format.group_function)){m[n.fieldName]=n.format.group_function}});return m},_adjustVisibleColumns:function(n){var m=this;if(m.isGrouped()){n=_.select(n,function(o){var p=m.columnForID(o);return !$.isBlank(p.format.grouping_aggregate)||_.any(m.query.groupBys,function(q){return q.columnId==p.id})})}return n},makeRequest:function(m){m.headers=$.extend(m.headers,{"X-Socrata-Federation":"Honey Badger"});if(m.inline){m.url="/views/INLINE/rows.json";m.type="POST";m.data=m.data||JSON.stringify(this.cleanCopy())}delete m.inline;if(this.isAnonymous()){m.anonymous=true}this._super(m)},_updateLinkedColumns:function(q,t,p){var s=this;if(q.dataTypeName=="dataset_link"){for(var u=s.columns.length-1;u>=0;u--){var o=s.columns[u];if(!o.isLinked()){continue}var m=o.underscoreName(s);t.data[o.lookup]=p[m]}}},_rowData:function(s,m,q){var p=this;var o={};_.each(m,function(t){o[t]=s.data[t]});var n=(p.metaColumnForName("meta")||{}).lookup||p._useSODA2?":meta":"meta";o[n]=s.metadata.meta;_.each(s.invalid,function(t,u){if(t){var v=!$.isBlank(q)?q.childColumnForID(u):p.columnForID(u);o[n]=o[n]||{};o[n].invalidCells=o[n].invalidCells||{};o[n].invalidCells[v.fieldName]=o[u];o[u]=null}});if(!$.isBlank(o[n])){o[n]=JSON.stringify(o[n])}if(p._useSODA2){o[":id"]=s.id}return o},_addRow:function(n,m){var o=this;_.each(o._availableRowSets,function(p){p.addRow(n,p==o._activeRowSet?m:null)})},_updateRow:function(n,m){_.each(this._availableRowSets,function(o){o.updateRow(n,m)})},_removeRow:function(m){_.each(this._availableRowSets,function(n){n.removeRow(m)})},_invalidateAll:function(p,n){var o=this;delete o._availableRowSets;var m=o.cleanJsonFilters();o._activateRowSet(new RowSet(o,$.extend({},o.metadata.jsonQuery,{where:m.where,having:m.having,namedFilters:null}),{orderBys:(o.query||{}).orderBys,filterCondition:o.cleanFilters(),groupBys:(o.query||{}).groupBys,groupFuncs:o._getGroupedFunctions()}))},_captureSodaServerHeaders:function(p){if(p&&_.isFunction(p.getResponseHeader)){var m=p.getResponseHeader("X-SODA2-Data-Out-Of-Date");var n=p.getResponseHeader("X-SODA2-Truth-Last-Modified");var o=p.getResponseHeader("Last-Modified");if(this.newBackend){if(m==="true"&&n&&o){this._dataOutOfDate=m;this._truthLastModified=n;this._lastModified=o;this.trigger("dataset_last_modified",[{age:moment(blist.dataset._lastModified).from(blist.dataset._truthLastModified,true)}])}else{if(m==="false"&&n&&o){this._lastModified=o;this.trigger("dataset_last_modified",[{lastModified:moment(blist.dataset._lastModified).format(blist.configuration.shortDateFormat)}])}}}}},_serverCreateRow:function(s,o){var u=this;var m=function(w){var y=s.row.id;if(!u._useSODA2){_.each(w,function(C,B){if(B.startsWith("_")){var D=B.slice(1);var E=!$.isBlank(s.parentColumn)?s.parentColumn.childColumnForID(D):u.columnForID(D);var A=$.isBlank(E)?D:E.lookup;s.row.data[A]=C;s.row.metadata[A]=C}});s.row.id=s.row.metadata.id}else{s.row.id=s.row.metadata.id=s.row.data[":id"]=w[":id"]}if(s.row.underlying){s.row.noMatch=true;s.row.underlying=null}var x=y;var z=s.row.id;if(!$.isBlank(s.parentRow)){x+=":"+s.parentRow.id+":"+s.parentColumn.id;z+=":"+s.parentRow.id+":"+s.parentColumn.id}u._pendingRowEdits[z]=u._pendingRowEdits[x];delete u._pendingRowEdits[x];u._pendingRowDeletes[z]=u._pendingRowDeletes[x];delete u._pendingRowDeletes[x];if(u._useSODA2){_.each(u._pendingRowEdits[z],function(A){A.rowData[":id"]=s.row.id});_.each(u._pendingRowDeletes[z],function(A){A.rowId=s.row.id})}if($.isBlank(s.parentRow)){var v=function(A){_.each(_.keys(A),function(C){var B=C.replace(":"+x+":",":"+z+":");if(B!=C){A[B]=A[C];delete A[C]}})};v(u._pendingRowEdits);v(u._pendingRowDeletes)}_.each(!$.isBlank(s.parentColumn)?s.parentColumn.realChildColumns:u.realColumns,function(A){delete s.row.changed[A.lookup]});if($.isBlank(s.parentRow)){u._updateRow(s.row,y)}else{u._updateRow(s.parentRow)}u.trigger("row_change",[[{id:y},s.parentRow||s.row]]);u._processPending(s.row.id,(s.parentRow||{}).id,(s.parentColumn||{}).id);u.aggregatesChanged();if(_.isFunction(s.success)){s.success(s.row)}};var t=function(){_.each(!$.isBlank(s.parentColumn)?s.parentColumn.realChildColumns:u.realColumns,function(v){s.row.error[v.lookup]=true});u._updateRow(s.parentRow||s.row);u.trigger("row_change",[[s.parentRow||s.row]]);if(_.isFunction(s.error)){s.error()}};var q=function(){if((u._pendingRowCreates||[]).length>0){while(u._pendingRowCreates.length>0){u._serverCreateRow(u._pendingRowCreates.shift(),true)}ServerModel.sendBatch()}else{delete u._pendingRowCreates}};var n=u._useSODA2?"/api/id/"+u.id:"/views/"+u.id+"/rows";if(!$.isBlank(s.parentRow)){n+="/"+s.parentRow.id+"/columns/"+s.parentColumn.id+"/subrows"}n+=".json";var p=s.rowData;if(u._useSODA2){n+="?$$version=2.0";p=$.extend(true,{},p);delete p[":id"]}if(u._useSODA2){p=$.makeArray(p)}u.makeRequest({url:n,isSODA:u._useSODA2,type:"POST",data:JSON.stringify(p),batch:o,success:m,error:t,complete:q})},_serverSaveRow:function(q,o){var u=this;var m=function(v){_.each(q.columnsSaving,function(w){delete q.row.changed[w]});_.each(q.columnsSaving,function(w){var x=!$.isBlank(q.parentColumn)?q.parentColumn.childColumnForIdentifier(w):u.columnForIdentifier(w);u._updateLinkedColumns(x,q.row,v)});if(!v._underlying){q.row.noMatch=null}u._updateRow(q.parentRow||q.row);u.trigger("row_change",[[q.parentRow||q.row]]);u.aggregatesChanged();if(_.isFunction(q.success)){q.success(q.row)}};var t=function(){_.each(q.columnsSaving,function(v){q.row.error[v]=true});u._updateRow(q.parentRow||q.row);u.trigger("row_change",[[q.parentRow||q.row]]);if(_.isFunction(q.error)){q.error()}};var p=function(){u._processPending(q.row.id,(q.parentRow||{}).id,(q.parentColumn||{}).id)};var n=u._useSODA2?"/api/id/"+u.id:"/views/"+u.id+"/rows";if(!$.isBlank(q.parentRow)){n+="/"+q.parentRow.id+"/columns/"+q.parentColumn.id+"/subrows"}n+=(u._useSODA2?"":"/"+q.row.metadata.uuid)+".json";var s=u._useSODA2?[q.rowData]:q.rowData;u.makeRequest({url:n,type:u._useSODA2?"POST":"PUT",data:JSON.stringify(s),isSODA:u._useSODA2,batch:o,success:m,error:t,complete:p});u._aggregatesStale=true;_.each(q.columnsSaving,function(v){(!$.isBlank(q.parentColumn)?q.parentColumn.childColumnForIdentifier(v):u.columnForIdentifier(v)).invalidateData()})},_serverRemoveRow:function(t,o,m,q){var s=this;var n=function(){s.aggregatesChanged()};var p=s._useSODA2?"/api/id/"+s.id:"/views/"+s.id+"/rows/";if(!$.isBlank(o)){p+=o+"/columns/"+m+"/subrows/"}if(!s._useSODA2){p+=t+".json"}s.makeRequest({batch:q,url:p,type:s._useSODA2?"POST":"DELETE",isSODA:s._useSODA2,data:JSON.stringify({":deleted":true,":id":t}),success:n})},_processPending:function(s,o,m){var q=this;var p=s;if(!$.isBlank(o)){p+=":"+o+":"+m}if(q._pendingRowEdits[p]&&q._pendingRowEdits[p].length>0){while(q._pendingRowEdits[p].length>0){q._serverSaveRow(q._pendingRowEdits[p].shift(),true)}ServerModel.sendBatch()}else{delete q._pendingRowEdits[p];if(q._pendingRowDeletes[p]){var n=q._pendingRowDeletes[p];q._serverRemoveRow(n.rowId,n.parRowId,n.parColId);delete q._pendingRowDeletes[p]}}},_generateUrl:function(m){var o=this;var n="";if(m||!$.isBlank(o.domainCName)){n=o._generateBaseUrl(o.domainCName)}var p;if(o.displayType==="api-predeploy"){p=["api_foundry/forge",o.id]}else{if(o.displayType==="api"){p=["developers/docs",o.resourceName]}else{if(_.isUndefined(o.name)){p=["d",o.id]}else{p=[$.urlSafe(o.category||"dataset"),$.urlSafe(o.name),o.id]}}}return n+$.path("/"+p.join("/"))},_generateShortUrl:function(m){var o=this;var n="";if(m||!$.isBlank(o.domainCName)){n=o._generateBaseUrl(o.domainCName,true)}return n+$.path("/d/"+o.id)},_generateApiUrl:function(){return this._generateBaseUrl()+"/api/views/"+this.id},_viewRemoved:function(m){var n=this;if(!$.isBlank(n._relatedViews)){n._relatedViews=_.without(n._relatedViews,m)}if(!$.isBlank(n._relViewCount)){n._relViewCount--}if(!$.isBlank(n._parent)&&n._parent.id==m.id){delete n._parent}},_loadRelatedViews:function(q,p){var o=this;var n=function(s){s=_.map(s,function(w){if(w.id==o.id){w=o}if(w instanceof a){return w}var u=new a(w);u.bind("removed",function(){o._viewRemoved(this)});if(!$.isBlank(o.accessType)){u.setAccessType(o.accessType)}return u});var t=_.detect(s,function(u){return _.include(u.flags||[],"default")});if(!$.isBlank(t)){o._parent=t;s=_.without(s,t)}o._relatedViews=s;if(_.isFunction(q)){q()}};var m=function(s){o._relViewCount=Math.max(0,s-1);if(_.isFunction(q)){q(o._relViewCount)}};this.makeRequest({url:"/views.json",pageCache:true,type:"GET",data:{method:p?"getCountForTableId":"getByTableId",tableId:this.tableId},success:p?m:n})},_loadPublicationViews:function(o){var n=this;var m=function(p){p=_.map(p,function(s){if(s instanceof a){return s}var q=new a(s);if(!$.isBlank(n.accessType)){q.setAccessType(n.accessType)}return q});n._publishedViews=_.select(p,function(q){return q.isPublished()});n._snapshotViews=_.select(p,function(q){return q.isSnapshot()});n._unpublishedView=_.detect(p,function(q){return q.isUnpublished()});if(_.isFunction(o)){o()}};n.makeRequest({url:"/api/views/"+n.id+".json",pageCache:true,type:"GET",params:{method:"getPublicationGroup"},success:m})},_setupDefaultSnapshotting:function(m){this.bind("request_finish",function(){var n=this;if(!$.isBlank(n._snapshotTimer)){clearTimeout(n._snapshotTimer)}n._snapshotTimer=setTimeout(function(){_.defer(n.takeSnapshot)},(m||1000))})},_getThumbNameOrDefault:function(m){return m||"page"},_getCroppedThumbnailMeta:function(m){return((this.metadata||{}).thumbnail||{})[m]},_updateSnapshot:function(p,m,o){var n=this;n.makeRequest({success:function(q){n._updateThumbnailCallback(q,o)},error:o,type:"POST",url:"/views/"+n.id+"/snapshots?method="+p+"&name="+n._getThumbNameOrDefault(m)})},_updateThumbnailCallback:function(m,n){if((m.metadata||{}).thumbnail){this.metadata.thumbnail=m.metadata.thumbnail}n(m)},_cleanUnsaveable:function(n){var m=this;var o=n;if(m.isPublished()&&m.isDefault()){o=$.extend(true,{},n);delete o.columns;if(!$.isBlank(o.query)&&_.isEmpty(o.query)){}else{if($.subKeyDefined(o,"query.orderBys")){o.query={orderBys:o.query.orderBys}}else{delete o.query}}}return o},_validKeys:{attribution:true,attributionLink:true,category:true,columns:true,description:true,disabledFeatureFlags:true,displayFormat:true,displayType:true,flags:true,iconUrl:true,id:true,licenseId:true,message:true,metadata:true,moderationStatus:true,name:true,originalViewId:true,privateMetadata:true,publicationAppendEnabled:true,query:true,queryString:true,resourceName:true,rowIdentifierColumnId:true,searchString:true,tags:true,termsAndConditions:true}});a.modules={};var l={};a.getLinkedDatasetOptions=function(m,n,p,o,s){var q=m;if($.isBlank(q)||!q.match(blist.util.patterns.UID)){return[]}if(l[q]==null){$.Tache.Get({url:"/api/views/"+q+".json",error:function(t){alert(JSON.parse(t.responseText).message)},success:function(v){var u=new a(v);l[q]=[];var w=l[q];var t;var x=v&&v.metadata&&v.metadata.rdfSubject?v.metadata.rdfSubject:undefined;_.each(u.columns||[],function(y){if(y.canBeDatasetLink()){t={value:String(y.fieldName),text:y.name};if(s&&t.value===x){t.selected=true}w.push(t)}});if(l[q].length<=0){alert($.t("controls.grid.no_columns",{uid:q}))}else{p.data("linkedFieldValues","_reset");_.each(p.data("linkedGroup"),function(y){$(y).trigger("change")});_.defer(function(){p.val(o)})}}});return[]}return l[q]};a.getLinkedDatasetOptionsDefault=function(m,n,p,o){return a.getLinkedDatasetOptions(m,n,p,o,true)};a.getLinkedDatasetOptionsNoDefault=function(m,n,p,o){return a.getLinkedDatasetOptions(m,n,p,o,false)};a.createFromMapLayerUrl=function(o,m,n){$.ajax({url:"/api/layers.json?method=createMapLayerDataset&url="+escape(o),type:"POST",contentType:"application/json",dataType:"json",success:function(p){if(_.isFunction(m)){m(new a(p))}},error:n})};a.lookupFromResourceName=function(o,m,n,p,q){a._create(false,o,m,n,p,q,true)};a.createFromResourceName=function(o,m,n,p,q){a._create(true,o,m,n,p,q,true)};a.lookupFromViewId=function(q,m,n,o,p){a._create(false,q,m,n,o,p)};a.createFromViewId=function(q,m,n,o,p){a._create(true,q,m,n,o,p)};a.getRecentDatasets=function(n,m,p){if(typeof localStorage==="undefined"){m([])}var t=j();var o=t["anon-mous"]||[];if(!$.isBlank(blist.currentUserId)){o=o.concat(t[blist.currentUserId]||[])}var s=_.pluck(d(o),"id");if(n===true){var q=[];ServerModel.startBatch();_.each(s,function(u){a.createFromViewId(u,function(v){q[s.indexOf(u)]=v},null,true)});ServerModel.sendBatch(function(){m(_.compact(q))},p)}else{m(s)}};a.saveRecentDataset=function(o){if(typeof localStorage==="undefined"){return}var p=j();var n=blist.currentUserId||"anon-mous";var m=p[n]||[];m.push({id:o.id,at:(new Date()).getTime()});m=d(m);p[n]=m;localStorage.setItem("socrataRecentDS",JSON.stringify(p))};var j=function(){return JSON.parse(localStorage.getItem("socrataRecentDS")||"{}")};var d=function(n){var m=_.sortBy(n,function(p){return p.at*-1});var o=_.uniq(m,true,function(p){return p.id});return o.slice(0,10)};a._create=function(t,m,n,q,p,s,v){var u=t?blist.viewCache[m]:(blist.sharedDatasetCache[m]||blist.viewCache[m]);s=!!s;if(!_.isUndefined(u)){if((u===false)&&_.isFunction(q)){q({responseText:JSON.stringify({code:"permission_denied",message:$.t("controls.grid.permission_denied")})})}else{if((u!==false)&&_.isFunction(n)){var o;if(u instanceof a){if(t||u.isAnonymous()!=s){o=u.clone()}else{o=u}}else{o=new a(u)}if(s){o.isAnonymous(s)}n(o)}}}else{$.socrataServer.makeRequest({url:v?"/api/views.json":"/api/views/"+m+".json",headers:{"X-Socrata-Federation":"Honey Badger"},params:v?{method:"getByResourceName",name:m}:{},success:function(w,x,z){if(_.isUndefined(blist.viewCache[w.id])){blist.viewCache[w.id]=w}if(_.isUndefined(blist.sharedDatasetCache[w.id])){blist.sharedDatasetCache[w.id]=new a(w)}if(!$.isBlank(w.resourceName)&&_.isUndefined(blist.viewCache[w.resourceName])){blist.viewCache[w.resourceName]=blist.viewCache[w.id]}if(!$.isBlank(w.resourceName)&&_.isUndefined(blist.sharedDatasetCache[w.resourceName])){blist.sharedDatasetCache[w.resourceName]=blist.sharedDatasetCache[w.id]}if(_.isFunction(n)){var y=null;if(t||blist.sharedDatasetCache[w.id].isAnonymous()!=s){y=new a(w)}else{y=blist.sharedDatasetCache[w.id]}if(s){y.isAnonymous(s)}n(y)}},batch:p,anonymous:s,pageCache:!p,error:q})}};a.search=function(p,m,n,o){$.socrataServer.makeRequest({pageCache:true,url:"/api/search/views.json",params:p,anonymous:o,success:function(q){if(_.isFunction(m)){m({count:q.count,views:_.map(q.results,function(s){var t=new a(s.view);t.rowResults=s.rows;t.rowResultCount=s.totalRows;if(o){t.isAnonymous(o)}return t})})}},error:n})};a.translateFilterCondition=function(o,n,v){if($.isBlank(v)){v=true}o=$.extend(true,{},o);if(n.isGrouped()){var w=o,u,t;if(!$.isBlank(o)&&o.type=="operator"&&_.isArray(o.children)&&o.children.length>0){var q=_.compact(_.map(n.query.groupBys,function(x){return n.columnForIdentifier(x.columnId)}).concat(_.select(n.realColumns,function(x){return $.subKeyDefined(x,"format.grouping_aggregate")})));var s=function(x){if(x.type=="column"){return _.any(q,function(y){return y.fieldName==x.columnFieldName||y.id==x.columnId})}else{if(!_.isEmpty(x.children)){return _.all(x.children,function(y){return s(y)})}else{return true}}};o=blist.filter.collapseChildren(o);if(o.value=="AND"){var m=_.groupBy(o.children,function(x){if(_.isEmpty(x.children)){return"defaults"}else{if(s(x)){return"having"}else{return"where"}}});if(!_.isEmpty(m.having)){t={type:"operator",value:"AND",children:m.having};o.children=_.difference(o.children,m.having)}if(!_.isEmpty(m.defaults)){u={type:"operator",value:"AND",children:m.defaults};o.children=_.difference(o.children,m.defaults)}}else{if(s(o)){t=o;w=null}}}return{where:g(w,n,v,false),having:g(t,n,v,true),defaults:g(u,n,false,false)}}else{var p=_.isEmpty(o)?null:_.select(o,function(x){return _.isEmpty(x.children)});return{where:g(o,n,v,false),defaults:g(p,n,false,false)}}};function g(o,t,n,p){if($.isBlank(o)||n&&(o.type!="operator"||!_.isArray(o.children)||o.children.length==0)){return null}var s={operator:o.value};if(!$.isBlank(o.metadata)){s.metadata=o.metadata}if(s.operator=="AND"||s.operator=="OR"){s.children=_.compact(_.map(o.children,function(v){var u=g(v,t,n,p);return u}));if(n){if(s.children.length==0){return null}else{if(s.children.length==1){var q=s.children[0];q.metadata=$.extend(s.metadata,q.metadata);s=q}}}}else{var m;_.each(o.children,function(w){if(w.type=="column"){if(!$.isBlank(t)){m=t.columnForIdentifier(w.columnFieldName||w.columnId)}if(!$.isBlank(w.columnFieldName)){s.columnFieldName=w.columnFieldName}else{if(!$.isBlank(m)){s.columnFieldName=m.fieldName}}if(p&&$.subKeyDefined(m,"format.grouping_aggregate")&&t._useSODA2){s.columnFieldName=blist.datatypes.soda2Aggregate(m.format.grouping_aggregate)+"_"+s.columnFieldName}if(!$.isBlank(w.value)&&(w.value=="url"||w.value!=(m||{}).dataTypeName)){s.subColumn=w.value}}else{if(w.type=="literal"){var u=w.value;if($.isBlank(s.value)){s.value=u}else{s.value=$.makeArray(s.value);s.value.push(u)}}}})}return s}a.translateGroupBys=function(o,n,m){if(_.isEmpty(o)){return null}return _.sortBy(_.compact(_.map(o,function(p){var q=n.columnForIdentifier(p.columnId);if($.isBlank(q)){return null}return{columnFieldName:q.fieldName,groupFunction:blist.datatypes.soda2GroupFunction(($.isBlank(m)?q.format.group_function:m[q.fieldName]),q)}})),"columnFieldName")};a.aggregateForColumn=function(n,m){return(_.detect(m.select,function(o){return o.aggregate&&o.columnFieldName==n})||{}).aggregate};a.translateColumnToQueryBase=function(p,o){var m=_.isString(p);if(m){p=o.columnForIdentifier(p)}if($.isBlank(p)){return null}var n=o._queryBase.columnForIdentifier(p.fieldName)||o._queryBase.columnForIdentifier(p.tableColumnId);if($.isBlank(n)){return null}return m?n.fieldName:n};a.translateFilterColumnsToBase=function(n,o){var m=$.extend({},n);if(!_.isEmpty(m.children)){m.children=_.compact(_.map(m.children,function(p){return a.translateFilterColumnsToBase(p,o)}));if(_.isEmpty(m.children)){return null}}if(!$.isBlank(m.columnFieldName)){m.columnFieldName=a.translateColumnToQueryBase(m.columnFieldName,o);if($.isBlank(m.columnFieldName)){return null}}return m};var c=["chart","annotatedtimeline","imagesparkline","areachart","barchart","columnchart","linechart","piechart"];var e=["map","geomap","intensitymap"];function h(n){var m=n.displayType||"table";if(n.viewType=="blobby"){m="blob"}else{if(n.viewType=="href"){m="href"}else{if(n.displayType=="api"){m="api"}else{if(_.include(["table","fatrow","page"],m)&&_.include(n.flags||[],"default")){m="blist"}else{if(_.include(c,m)){m="chart"}else{if(_.include(e,m)){m="map"}else{if(m=="calendar"){}else{if(!$.isBlank(n.query)&&!$.isBlank(n.query.groupBys)&&n.query.groupBys.length>0||(n.message||"").indexOf("roll up")>=0){m="grouped"}else{if(_.include(["table","fatrow","page"],m)&&!_.include(n.flags||[],"default")){m="filter"}}}}}}}}}return m}function k(m){var n=m.type;switch(m.type){case"blist":n=m.isPublished()?$.t("core.view_types.dataset"):$.t("core.view_types.working_copy");break;default:n=$.t("core.view_types."+m.type)}return n}function f(p,m){var o=p.cleanCopy(m);o=p._cleanUnsaveable(o);if(!$.isBlank(o.query)){o.query.filterCondition=p.cleanFilters(true)}if($.subKeyDefined(o,"metadata.jsonQuery")){var n=p.cleanJsonFilters(true);$.extend(o.metadata.jsonQuery,n);o.metadata.jsonQuery.where=n.where;o.metadata.jsonQuery.having=n.having}return o}function b(o){var n=o.cleanCopy();if(!_.isUndefined(n.metadata)){delete n.metadata.facets;delete n.metadata.filterCondition}delete n.resourceName;delete n.rowIdentifierColumnId;if(!$.isBlank(n.query)){n.query.filterCondition=o.cleanFilters(true)}if($.subKeyDefined(n,"metadata.jsonQuery")){var m=o.cleanJsonFilters(true);$.extend(n.metadata.jsonQuery,m);n.metadata.jsonQuery.where=m.where;n.metadata.jsonQuery.having=m.having}return n}if(blist.inBrowser){this.Dataset=a}else{module.exports=a}})();(function(){Dataset.modules.grouped=Dataset.modules.filter=Dataset.modules.blist=Dataset.modules.table={supportsSnapshotting:function(){return true},_setupSnapshotting:function(){var b=this,a=500;if(_.any(b.columns,function(c){return _.include(["checkbox","percent","stars","flag","photo"],c.dataTypeName)})){a=1500}this._setupDefaultSnapshotting(a)}}})();(function(){Dataset.modules.calendar={supportsSnapshotting:function(){return true},_setupSnapshotting:function(){this._setupDefaultSnapshotting(0)},_checkValidity:function(){if($.isBlank(this.displayFormat.startDateTableId)||$.isBlank(this.displayFormat.titleTableId)){return false}var b=this.columnForTCID(this.displayFormat.startDateTableId);var a=this.columnForTCID(this.displayFormat.titleTableId);return !$.isBlank(b)&&!$.isBlank(a)},_convertLegacy:function(){var a=this;_.each(["startDate","endDate","title","description"],function(d){if($.isBlank(a.displayFormat[d+"TableId"])&&!$.isBlank(a.displayFormat[d+"Id"])){var b=a.columnForID(a.displayFormat[d+"Id"]);if(!$.isBlank(b)){a.displayFormat[d+"TableId"]=b.tableColumnId}delete a.displayFormat[d+"Id"]}});if(!$.isBlank(a.displayFormat.descriptionTableId)){a.displayFormat.descriptionColumns=[{tableColumnId:a.displayFormat.descriptionTableId}];delete a.displayFormat.descriptionTableId}}}})();(function(){var b={imagesparkline:"line",annotatedtimeline:"timeline",areachart:"area",barchart:"bar",columnchart:"column",linechart:"line",piechart:"pie"};Dataset.chart={};Dataset.chart.textualTypes=["text","html","email","url","drop_down_list","number","percent","money"];Dataset.chart.numericTypes=["number","percent","money"];Dataset.chart.dateTypes=["calendar_date","date"];Dataset.chart.textAndDateTypes=Dataset.chart.textualTypes.concat(Dataset.chart.dateTypes);var a=function(e,d){var c=$.extend(true,{},d);c.fixedColumns=_.reject(d.fixedColumns,function(f){var g=e.columnForIdentifier(f);if($.isBlank(g)){return true}return !_.include(Dataset.chart.textualTypes,g.renderTypeName)});c.valueColumns=_.reject(d.valueColumns,function(f){var g=e.columnForIdentifier(f.fieldName||f.tableColumnId);if($.isBlank(g)){return true}return !_.include(Dataset.chart.numericTypes,g.renderTypeName)});return c};Dataset.chart.types={area:{value:"area",text:$.t("core.chart_types.area"),requiredColumns:[Dataset.chart.textualTypes,Dataset.chart.numericTypes],displayLimit:{labels:50,points:300}},bar:{value:"bar",text:$.t("core.chart_types.bar"),requiredColumns:[Dataset.chart.textAndDateTypes,Dataset.chart.numericTypes],displayLimit:{points:40}},bubble:{value:"bubble",text:$.t("core.chart_types.bubble"),requiredColumns:[Dataset.chart.numericTypes],displayLimit:{labels:50,points:300},translateFormat:a},column:{value:"column",text:$.t("core.chart_types.column"),requiredColumns:[Dataset.chart.textAndDateTypes,Dataset.chart.numericTypes],displayLimit:{labels:50,points:100}},donut:{value:"donut",text:$.t("core.chart_types.donut"),requiredColumns:[Dataset.chart.textualTypes,Dataset.chart.numericTypes],displayLimit:{points:30},renderOther:true},line:{value:"line",text:$.t("core.chart_types.line"),requiredColumns:[Dataset.chart.numericTypes],displayLimit:{labels:50,points:300},translateFormat:a},pie:{value:"pie",text:$.t("core.chart_types.pie"),requiredColumns:[Dataset.chart.textualTypes,Dataset.chart.numericTypes],displayLimit:{points:30},renderOther:true},timeline:{value:"timeline",text:$.t("core.chart_types.timeline"),requiredColumns:[Dataset.chart.dateTypes,Dataset.chart.numericTypes],displayLimit:{labels:50,points:300}},treemap:{value:"treemap",text:$.t("core.chart_types.treemap"),requiredColumns:[Dataset.chart.textualTypes,Dataset.chart.numericTypes],displayLimit:{points:100},renderOther:true}};Dataset.chart.types.stackedcolumn=$.extend({},Dataset.chart.types.column,{value:"stackedcolumn",text:$.t("core.chart_types.stackedcolumn")});Dataset.chart.types.stackedbar=$.extend({},Dataset.chart.types.column,{value:"stackedbar",text:$.t("core.chart_types.stackedbar")});Dataset.chart.hasRequiredColumns=function(e,d,c){e=e.slice();d=_.sortBy(d,function(f){return f.length});return _.all(d,function(g){var f=_.detect(e,function(h){return _.include(g,h.renderTypeName)&&(c||!h.hidden)});if($.isBlank(f)){return false}e=_.without(e,f);return true})};Dataset.chart.isValid=function(d,c,g){if($.isBlank(d)){return false}var e=[];_.each(c.fixedColumns||[],function(h){e.push(d.columnForIdentifier(h))});_.each(c.valueColumns||[],function(h){e.push(d.columnForIdentifier(h.fieldName||h.tableColumnId))});var f=Dataset.chart.types[g];if($.isBlank(f)){return false}return Dataset.chart.hasRequiredColumns(_.compact(e),f.requiredColumns)};Dataset.modules.chart={supportsSnapshotting:function(){return _.include(["area","bar","column","donut","line","pie","timeline","treemap"],this.displayFormat.chartType)},_setupSnapshotting:function(){if(_.include(["treemap"],this.displayFormat.chartType)){this._setupDefaultSnapshotting(2000)}},_checkValidity:function(){if(!this._super()){return false}return Dataset.chart.isValid(this,this.displayFormat,this.displayFormat.chartType)},_convertLegacy:function(){var m=this;if(!$.isBlank(b[m.displayType])){var e=m.displayType;m.displayType="chart";m.displayFormat.chartType=b[e]}else{if(!$.isBlank(b[m.displayFormat.chartType])){m.displayFormat.chartType=b[m.displayFormat.chartType]}}if($.isBlank(m.displayFormat.dataColumns)&&$.isBlank(m.displayFormat.fixedColumns)&&$.isBlank(m.displayFormat.valueColumns)&&!$.isBlank(m.visibleColumns)){m.displayFormat.dataColumns=_.map(m.visibleColumns,function(n){return n.tableColumnId})}if(!$.isBlank(m.displayFormat.dataColumns)){if(!$.isBlank(m.displayFormat.fixedCount)){if(m.displayFormat.chartType=="pie"&&m.displayFormat.fixedCount>1){m.displayFormat.fixedCount--}m.displayFormat.fixedColumns=m.displayFormat.dataColumns.splice(0,m.displayFormat.fixedCount)}else{if($.isBlank(m.displayFormat.valueColumns)&&_.isArray(m.displayFormat.dataColumns)&&m.displayFormat.dataColumns.length>0){var j=m.columnForTCID(m.displayFormat.dataColumns[0]);if(!$.isBlank(j)&&!_.include(Dataset.chart.numericTypes,j.renderTypeName)){m.displayFormat.fixedColumns=m.displayFormat.dataColumns.splice(0,1)}}}var g=[];var d;var h=0;var l=m.displayFormat.dataColumns.slice();while(l.length>0){var f=l.shift();var k=m.columnForTCID(f);if($.isBlank(k)){continue}if(_.include(Dataset.chart.numericTypes,k.renderTypeName)){g.push(d);d={tableColumnId:f};if(!$.isBlank((m.displayFormat.colors||[])[h])){d.color=m.displayFormat.colors[h]}h++;continue}if(!$.isBlank(d)){d.supplementalColumns=d.supplementalColumns||[];d.supplementalColumns.push(f)}}if(!$.isBlank(d)){g.push(d)}m.displayFormat.valueColumns=_.compact(g)}delete m.displayFormat.dataColumns;if($.subKeyDefined(m.displayFormat,"yAxis.marker")){m.displayFormat.valueMarker=[{atValue:m.displayFormat.yAxis.marker,color:m.displayFormat.yAxis.markerColor}]}if(m.displayFormat.chartType=="treemap"&&m.displayFormat.baseColor){m.displayFormat.colors=[m.displayFormat.baseColor,"#042656","#19538b","#6a9feb","#bed6f7"]}if(((m.displayFormat.chartType=="bar")||(m.displayFormat.chartType=="column"))&&(m.displayFormat.stacking===true)){m.displayFormat.chartType="stacked"+m.displayFormat.chartType}}}})();(function(){Dataset.modules.form={supportsSnapshotting:function(){return true},_setupSnapshotting:function(){var a=this;_.defer(function(){a.takeSnapshot()})},_checkValidity:function(){this.visibleColumns=this.visibleColumns||[];return _.any(this.visibleColumns,function(a){return"nested_table"!=a.dataTypeName})}}})();(function(){Dataset.map={};Dataset.map.isValid=function(b,a){if($.isBlank(a)){return false}if(a.viewDefinitions){return true}if($.isBlank(b)){return false}if(b.isArcGISDataset()){return true}if(b.isGeoDataset()){return true}if($.isBlank(a.noLocations)&&($.isBlank(a.plot)||($.isBlank(a.plot.latitudeId)||$.isBlank(a.plot.longitudeId))&&$.isBlank(a.plot.locationId))||$.isBlank(a.type)||$.isBlank(a.plotStyle)){return false}var c=b.columnForIdentifier(a.plot.latitudeId);var d=b.columnForIdentifier(a.plot.longitudeId);var e=b.columnForIdentifier(a.plot.locationId);return !$.isBlank(e)||(!$.isBlank(c)&&!$.isBlank(d))||a.noLocations};Dataset.map.convertToVersion2=function(a,d){if(!a){return}if(!d){d=a.displayFormat}if($.isBlank(d.viewDefinitions)){d.viewDefinitions=[$.extend(true,{},d)];d.viewDefinitions[0].uid="self"}if(d.compositeMembers){_.each(d.compositeMembers,function(e){d.viewDefinitions.push({uid:e,plotStyle:"point",legacy:true})})}var c=d.plotStyle!="heatmap";if(d.type=="google"&&c){d.exclusiveLayers=true;d.bkgdLayers=Dataset.map.backgroundLayerSet.Google}else{if(d.type=="bing"&&c){d.exclusiveLayers=true;d.bkgdLayers=Dataset.map.backgroundLayerSet.Bing}else{if((d.plotStyle=="heatmap"&&d.forceBasemap)||c){d.bkgdLayers=_.map(d.layers,function(e){if(e.custom_url){return{custom_url:e.custom_url}}else{return{layerKey:(_.detect(Dataset.map.backgroundLayers,function(f){return e.url.indexOf((f.options||{}).url)>-1})||{}).key}}})}}}if(a.isArcGISDataset()){if(!d.layers){d.bkgdLayers=[{layerKey:"World Street Map (ESRI)",opacity:1}]}delete d.viewDefinitions[0].plotStyle;for(var b in d.viewDefinitions[0].plot){if(!_.include(["titleId","descriptionColumns"],b)){delete d.viewDefinitions[0].plot[b]}}}if(a.isGeoDataset()){d.exclusiveLayers=true;d.bkgdLayers=[{layerKey:"Google Roadmap",alias:$.t("core.map_layers.google_roadmap_alias"),opacity:1},{layerKey:"Bing Road",alias:$.t("core.map_layers.bing_roadmap_alias"),opacity:1},{layerKey:"World Street Map (ESRI)",alias:"ESRI",opacity:1}];delete d.viewDefinitions[0].plotStyle;delete d.viewDefinitions[0].plot}d.distinctLegend=true;a.update({displayFormat:d})};Dataset.map.backgroundLayers=[{key:"Google Roadmap",alias:$.t("core.map_layers.roadmap"),className:"Google",options:{type:"ROADMAP"}},{key:"Google Satellite",alias:$.t("core.map_layers.satellite"),className:"Google",zoomLevels:20,options:{type:"SATELLITE"}},{key:"Google Terrain",alias:$.t("core.map_layers.terrain"),className:"Google",zoomLevels:16,options:{type:"TERRAIN"}},{key:"Bing Road",alias:$.t("core.map_layers.roadmap"),className:"Bing",zoomLevels:20},{key:"Bing Aerial",alias:$.t("core.map_layers.aerial"),className:"Bing",options:{type:"Aerial"}},{key:"World Street Map (ESRI)",alias:$.t("core.map_layers.esri_world_street_map_alias"),className:"ESRI",zoomLevels:20,options:{url:"World_Street_Map"}},{key:"Satellite Imagery (ESRI)",alias:$.t("core.map_layers.satellite"),className:"ESRI",zoomLevels:20,options:{url:"World_Imagery"}},{key:"Detailed USA Topographic Map (ESRI)",alias:$.t("core.map_layers.esri_us_topo_alias"),className:"ESRI",zoomLevels:16,options:{url:"USA_Topo_Maps"}},{key:"Annotated World Topographic Map (ESRI)",alias:$.t("core.map_layers.esri_world_topo_alias"),zoomLevels:17,className:"ESRI",options:{url:"World_Topo_Map"}},{key:"Natural Earth Map (ESRI)",alias:$.t("core.map_layers.esri_natural_earth_alias"),className:"ESRI",zoomLevels:9,options:{url:"World_Physical_Map"}}];Dataset.map.backgroundLayer={custom:{name:"custom",className:"ESRI"}};Dataset.map.backgroundLayerSet={};Dataset.map.backgroundLayerSet.Google=[{layerKey:"Google Roadmap",alias:$.t("core.map_layers.roadmap"),opacity:1},{layerKey:"Google Satellite",alias:$.t("core.map_layers.satellite"),opacity:1},{layerKey:"Google Terrain",alias:$.t("core.map_layers.terrain"),opacity:1}];Dataset.map.backgroundLayerSet.Bing=[{layerKey:"Bing Road",alias:$.t("core.map_layers.roadmap"),opacity:1},{layerKey:"Bing Aerial",alias:$.t("core.map_layers.aerial"),opacity:1}];Dataset.modules.map={supportsSnapshotting:function(){return _.include(["bing","google","esri"],this.displayFormat.type)},_checkValidity:function(){if(!this._super()){return false}return Dataset.map.isValid(this,this.displayFormat)},_convertLegacy:function(){var a=this;if(a._convertedLegacy){return}a._convertedLegacy=true;if($.subKeyDefined(a,"displayFormat.viewDefinitions")){var c=function(m){var f=function(p){if($.isBlank(p)){return}if(p.type=="column"&&!$.isBlank(p.columnId)){var o=m.columnForID(p.columnId);if(!$.isBlank(o)){var q=a.columnForTCID(o.tableColumnId);if(!$.isBlank(q)){p.columnId=q.id}}}else{if(!_.isEmpty(p.children)){_.each(p.children,function(s){f(s)})}}};if(m.isArcGISDataset()||m.isGeoDataset()){return false}var g=m.id;var n=$.extend(true,{},a.displayFormat);var l=$.extend(true,{},a.metadata);var k={displayFormat:n,metadata:l};var h=_.any(n.viewDefinitions,function(o){if(o.uid==g){o.uid="self";return true}return false});if($.subKeyDefined(l,"renderTypeConfig.active")){_.each(l.renderTypeConfig.active,function(o,p){if(o.id==g){o.id="self"}})}if($.subKeyDefined(l,"conditionalFormatting."+g)){l.conditionalFormatting.self=l.conditionalFormatting[g];delete l.conditionalFormatting[g]}if($.subKeyDefined(l,"query."+g)){if(g!=a.id&&_.isEmpty(a.query.filterCondition)){var j=l.query[g];f(j.filterCondition);k.query=j}delete l.query[g]}a.update(k);return h};if(!_.any(a.displayFormat.viewDefinitions,function(f){return f.uid=="self"})&&!c(a)){a.getParentView(function(f){if(!c(f)&&!_.any(a.displayFormat.viewDefinitions,function(g){return g.uid=="self"})){Dataset.lookupFromViewId(a.displayFormat.viewDefinitions[0].uid,function(g){if(g.tableId==a.tableId){c(g)}})}})}return}a.displayFormat.plot=a.displayFormat.plot||{};if(_.include(["geomap","intensitymap"],a.displayType)){a.displayType="map";a.displayFormat.type="heatmap";var e=a.displayFormat.region||"";a.displayFormat.heatmap={type:e.toLowerCase().match(/^usa?$/)?"state":"countries"};_.each(["locationId","quantityId","descriptionId","redirectId"],function(g,f){if(f<(a.visibleColumns||[]).length){a.displayFormat.plot[g]=parseInt(a.visibleColumns[f].tableColumnId)}})}if($.isBlank(a.displayFormat.heatmap)&&!$.isBlank(a.displayFormat.heatmapType)){var b=a.displayFormat.heatmapType.split("_");config={type:b[1],region:b[0],colors:{low:a.displayFormat.lowcolor,high:a.displayFormat.highcolor}};a.displayFormat.heatmap=config;delete a.displayFormat.lowcolor;delete a.displayFormat.highcolor;delete a.displayFormat.heatmapType}var d=a.displayFormat.plot||a.displayFormat;_.each(["latitudeId","longitudeId","titleId","descriptionId"],function(f){if($.isBlank(a.displayFormat.plot[f])&&!$.isBlank(d[f])){a.displayFormat.plot[f]=d[f];delete d[f]}});_.each({ycol:"latitudeId",xcol:"longitudeId",titleCol:"titleId",bodyCol:"descriptionId"},function(g,f){if($.isBlank(a.displayFormat.plot[g])&&!$.isBlank(d[f])){a.displayFormat.plot[g]=a.columnForID(d[f]).tableColumnId;delete d[f]}});if(!$.isBlank(a.displayFormat.plot.descriptionId)){a.displayFormat.plot.descriptionColumns=[{tableColumnId:a.displayFormat.plot.descriptionId}];delete a.displayFormat.plot.descriptionId}if($.isBlank(a.displayFormat.plotStyle)){a.displayFormat.plotStyle=!$.isBlank(a.displayFormat.heatmap)?"heatmap":"point"}}}})();(function(){if(_.isUndefined(blist.viewCache)){blist.viewCache={}}if(_.isUndefined(blist.sharedDatasetCache)){blist.sharedDatasetCache={}}$.extend(blist.viewCache,{invalidate:function(a){var b=_.isString(a)?a:a.id;delete blist.viewCache[b]}});$.extend(blist.sharedDatasetCache,{invalidate:function(a){var b=_.isString(a)?a:a.id;delete blist.sharedDatasetCache[b]}})})();$(function(){blist.namespace.fetch("blist.styles");var d={};var c={};var a={};var e=function(j){var k="customStyles_"+j;var h=['<style type="text/css" id="',k,'">'];_.each(d[j]||[],function(l){h.push(l.rule);h.push(" {}\n")});h.push("</style>\n");$("head").append(h.join(""));var g=$("#"+k)[0];for(var f=0;f<document.styleSheets.length;f++){a[j]=document.styleSheets[f];if((a[j].ownerNode||a[j].owningElement)==g){break}a[j]=null}if($.isBlank(a[j])){throw"Unable to locate stylesheet"}c[j]={}};var b=function(f){if($.isBlank(a[f])){e(f)}var g=a[f].cssRules||a[f].rules;_.each(g,function(j,h){c[f][d[f][h].id]=j.style});d[f]={}};blist.styles.getStyle=function(f,g){if($.isBlank(c[f])&&!$.isBlank(d[f])){b(f)}return c[f][g]};blist.styles.addStyle=function(f,j,g){if($.isBlank(a[f])){d[f]=d[f]||[];if(_.any(d[f],function(k){return k.id==j})){return}d[f].push({id:j,rule:g});return}if(!$.isBlank(c[f][j])){return}var h=a[f].cssRules||a[f].rules;if($.browser.msie){a[f].addRule(g," ")}else{a[f].insertRule(g+"{}",h.length)}c[f][j]=h[h.length-1].style};blist.styles.resetSheet=function(f){if($.isBlank(a[f])){return}$("#customStyles_"+f).remove();a[f]=null;c[f]=null};blist.styles.getReferenceProperty=function(g,j){var h=$("#styleReference");if(h.length<1){$("body").append('<div id="styleReference"></div>');h=$("#styleReference")}var f=h.find("."+g);if(f.length<1){h.append('<div class="'+g+'"></div>');f=h.find("."+g)}return f.css(j)}});(function(b){b.templates=b.templates||{};var a=function(d,c){var e={};e["downloadType<-"+d]={".type a":"#{downloadType}",".type a@data-type":"#{downloadType}",".type a@href":function(f){if(c){return"#download"}return f.context.view.downloadUrl(f.item)},"@class+":function(f){return f.item.toLowerCase()+"Download"}};return e};b.templates.downloadsTable={downloadTypes:{normal:["CSV","JSON","PDF","RDF","RSS","XLS","XLSX","XML"],geo_attributes:["CSV","JSON"],nbe:["CSV","JSON"],geo:["KML","KMZ","Shapefile","Original"]},directive:{normal:{".downloadsTable .downloadsList tbody .item":a("downloadTypes")},nbe:{".downloadsTable .downloadsList tbody .item":a("downloadTypes")},geo:{".downloadsTable .downloadsList tbody .item":a("downloadTypes"),".layerDownloadsContent .downloadsList tbody .item":a("layerDownloadTypes",true)}},postRender:function(c){c.find("table.gridList").combinationList({headerContainerSelector:c.find(".gridListWrapper"),initialSort:[[0,0]],scrollableBody:false,selectable:false,sortGrouping:false,sortHeaders:{0:{sorter:"text"}}})}}})(jQuery);blist.namespace.fetch("blist.filter");(function(f){var b=function(m){return"UPPER("+m+")"};var d=function(m){return m};var j=function(p,o,m,n){if(!n){n=d}return n.call(this,p)+o+n.call(this,m)};var c=function(p,o,m,n){if(!n){n=d}return o+"("+n.call(this,p)+(m===undefined?"":(","+n.call(this,m)))+")"};var g=function(m){return blist.dataset.columnForFieldName(m).isText()};var h={EQUALS:{text:f.t("core.filters.informal.equals"),editorCount:1,soql:function(o,n,m){return j(o,"=",n,m&&g(o)?b:d)},opMatches:function(n,m){return _.isEqual(n,m)}},NOT_EQUALS:{text:f.t("core.filters.informal.not_equals"),editorCount:1,soql:function(o,n,m){return j(o,"!=",n,m&&g(o)?b:d)},opMatches:function(n,m){return !_.isEqual(n,m)}},STARTS_WITH:{text:f.t("core.filters.informal.starts_with"),editorCount:1,soql:function(o,n,m){return c(o,"starts_with",n,m?b:d)},opMatches:function(n,m){return(n||"").startsWith(m)}},CONTAINS:{text:f.t("core.filters.informal.contains"),editorCount:1,soql:function(n,m){return c(n,"contains",m)},opMatches:function(n,m){return(n||"").indexOf(m)>-1}},NOT_CONTAINS:{text:f.t("core.filters.informal.not_contains"),editorCount:1,soql:function(n,m){return c(n,"not contains",m)},opMatches:function(n,m){return(n||"").indexOf(m)<0}},LESS_THAN:{text:f.t("core.filters.informal.less_than"),editorCount:1,soql:function(n,m){return j(n,"<",m)},opMatches:function(n,m){return n<m}},LESS_THAN_OR_EQUALS:{text:f.t("core.filters.informal.less_than_or_equals"),editorCount:1,soql:function(n,m){return j(n,"<=",m)},opMatches:function(n,m){return n<=m}},GREATER_THAN:{text:f.t("core.filters.informal.greater_than"),editorCount:1,soql:function(n,m){return j(n,">",m)},opMatches:function(n,m){return n>m}},GREATER_THAN_OR_EQUALS:{text:f.t("core.filters.informal.greater_than_or_equals"),soql:function(n,m){return j(n,">=",m)},editorCount:1,opMatches:function(n,m){return n>=m}},BETWEEN:{text:f.t("core.filters.informal.between"),editorCount:2,soql:function(n,m){return j(n,">=",m[0],newBackend&&g(n)?b:d)+" AND "+j(n,"<=",m[1],newBackend&&g(n)?b:d)},opMatches:function(n,m,p){var o=_.flatten(_.compact([m,p]));if(!_.isArray(o)||o.length!=2){return false}return o[0]<=n&&n<=o[1]}},IS_BLANK:{text:f.t("core.filters.informal.is_blank"),editorCount:0,soql:function(n,m){return j(n," is ","null")},opMatches:function(m){return f.isBlank(m)}},IS_NOT_BLANK:{text:f.t("core.filters.informal.is_not_blank"),editorCount:0,soql:function(n,m){return j(n," is not ","null")},opMatches:function(m){return !f.isBlank(m)}}};var a=blist.filter.groups={textual:{orderedList:["EQUALS","NOT_EQUALS","STARTS_WITH","CONTAINS","NOT_CONTAINS","IS_BLANK","IS_NOT_BLANK"]},textObject:{orderedList:["EQUALS","NOT_EQUALS","CONTAINS","NOT_CONTAINS","IS_BLANK","IS_NOT_BLANK"]},numeric:{orderedList:["EQUALS","NOT_EQUALS","LESS_THAN","LESS_THAN_OR_EQUALS","GREATER_THAN","GREATER_THAN_OR_EQUALS","BETWEEN","IS_BLANK","IS_NOT_BLANK"]},date:{details:{LESS_THAN:{text:"is before"},GREATER_THAN:{text:"is after"}},orderedList:["EQUALS","NOT_EQUALS","LESS_THAN","GREATER_THAN","BETWEEN","IS_BLANK","IS_NOT_BLANK"]},comparable:{orderedList:["EQUALS","NOT_EQUALS","IS_BLANK","IS_NOT_BLANK"]},check:{details:{IS_BLANK:{text:"is not checked",soql:function(n,m){return"not "+n}},IS_NOT_BLANK:{text:"is checked",soql:function(n,m){return n}}},orderedList:["IS_BLANK","IS_NOT_BLANK"]},blob:{details:{IS_BLANK:{text:"is empty"},IS_NOT_BLANK:{text:"exists"}},orderedList:["IS_BLANK","IS_NOT_BLANK"]}};var e=function(n,m){n.name=m;n.matches=function(){var q=_.flatten(arguments);var s=function(t,u){return n.opMatches.apply(n,_.flatten([t,u]))};var o=q.shift();if(f.isPlainObject(o)){var p=n.name=="IS_NOT_BLANK"?"any":"all";return _[p](o,function(w,u){var t=q[0];t=f.isPlainObject(t)?t[u]:t;if(!f.isBlank(t)||n.name.endsWith("_BLANK")){return s(w,t)}return true})}else{return s(o,q)}}};_.each(h,function(n,m){e(n,m)});_.each(a,function(m){var n={};_.each(m.orderedList,function(o){n[o]=h[o]});m.details=f.extend(true,{},n,m.details)});var l={};blist.filter.matchesExpression=function(u,s){if(u===true||_.isEmpty(u)){return function(){return true}}if(!f.subKeyDefined(u,"operator")){return function(){return false}}if(f.isBlank(u._key)){u._key=blist.filter.getFilterKey(u)}var v=u._key+"::"+(s||{}).id;if(!f.isBlank(l[v])){return l[v]}function m(x){l[v]=x;return x}if(u._key=="customValues"&&_.isEmpty(u.children)){return m(function(){return true})}if(!f.isBlank(u.children)){var o=u.operator.toLowerCase()=="or"?"any":"all";var w=_.map(u.children,function(x){return blist.filter.matchesExpression(x,s)});return m(function(x){return _[o](w,function(y){return y(x)})})}if(!f.isBlank(s)&&(!f.isBlank(u.tableColumnId)||!f.isBlank(u.columnFieldName))){var n=s.columnForIdentifier(u.tableColumnId||u.columnFieldName);if(f.isBlank(n)){return m(function(){return false})}var q=n.renderType;var t=(u.subColumn||"").toLowerCase();if(f.subKeyDefined(q,"subColumns."+t)){q=q.subColumns[t]}return m(function(y){var x=y.data[n.lookup];if(f.isPlainObject(x)&&!f.isBlank(t)){x=x[t]}return q.matches(u.operator,n,x,u.value)})}else{var p=h[u.operator.toUpperCase()];if(f.isBlank(p)){return m(function(){return false})}return m(function(x){return p.matches(x,u.value)})}};blist.filter.getFilterKey=function(n){if(_.isEmpty(n)){return""}var o=n.operator.toUpperCase();if(o=="AND"||o=="OR"){if(blist.filter.isEmptyPlaceholderFilter(n)){return"customValues"}var m=_.compact(_.map(n.children,function(p){return blist.filter.getFilterKey(p)}));return m.length<2?(m[0]||""):"("+m.join("|"+o+"|")+")"}return"("+(n.columnFieldName||n.tableColumnId)+(!f.isBlank(n.subColumn)?"["+n.subColumn+"]":"")+"|"+o+"|"+n.value+")"};blist.filter.generateSOQLWhere=function(o,q){if(_.isEmpty(o)){return""}var u=o.operator.toUpperCase();if(u=="AND"||u=="OR"){var n=_.map(o.children,function(v){return blist.filter.generateSOQLWhere(v,q)});return n.length<2?(n[0]||""):"("+n.join(" "+u+" ")+")"}var t=q.columnForIdentifier(o.columnFieldName);var m=o.value;if(f.subKeyDefined(t,"renderType.soqlFilterValue")){if(_.isArray(m)){m=_.map(m,function(v){return t.renderType.soqlFilterValue(v)})}else{m=t.renderType.soqlFilterValue(m)}}else{if(_.isArray(m)){m=_.map(m,function(v){return _.isString(v)?"'"+v+"'":v})}else{if(_.isString(m)){m="'"+m+"'"}}}var s=o.columnFieldName;if(!f.isBlank(o.subColumn)){s+="."+o.subColumn}if(f.subKeyDefined(t,"renderType.soqlFieldWrapper")){s=t.renderType.soqlFieldWrapper(s,u)}var p=h[u].soql;if(f.subKeyDefined(t,"renderType.filterConditions.details."+u+".soql")){p=t.renderType.filterConditions.details[u].soql}return"("+p(s,m,q.newBackend)+")"};blist.filter.generateSODA1=function(){var n=_.filter(Array.prototype.slice.call(arguments),function(p){return !!p&&!_.isEmpty(p)});if(n.length>0){if(n.length==1){n=n[0]}else{n={operator:"AND",children:n}}}var m={};if(_.isEmpty(n)){return m}if(!n.operator){return{}}if(!f.isBlank(n.metadata)){m.metadata=n.metadata}else{m.metadata={unifiedVersion:2}}var o=n.operator.toUpperCase();m.type="operator";m.value=o;if(o=="AND"||o=="OR"){m.children=_.map(n.children,function(p){return blist.filter.generateSODA1(p)})}else{m.children=[{type:"column",columnFieldName:n.columnFieldName}];if(!_.isUndefined(n.value)){_.each(f.makeArray(n.value),function(p){m.children.push({type:"literal",value:p})})}if(!f.isBlank(n.subColumn)){m.children[0].value=n.subColumn}}return m};blist.filter.collapseChildren=function(n){n=f.extend({},n);if(f.isBlank(n.children)){return n}var p=function(q){var s=[];_.each(q,function(t){if(t.type=="operator"&&t.value=="AND"||!f.isBlank(t.operator)&&t.operator.toUpperCase()=="AND"){s=s.concat(t.children)}else{if((t.type=="operator"&&t.value=="OR"||!f.isBlank(t.operator)&&t.operator.toUpperCase()=="OR")&&_.isArray(t.children)&&t.children.length==1){s=s.concat(t.children)}else{s.push(t)}}});s=_.compact(s);return _.isEqual(q,s)?false:s};var m;var o=n.children;while(m=p(o)){o=m}n.children=o;return n};var k=function(n,m){if(f.isBlank(n)){return f.isBlank(m)}else{if(f.isBlank(m)){return false}}if(f.isBlank(n.children)){return f.isBlank(m.children)&&n.columnFieldName==m.columnFieldName&&n.operator==m.operator&&n.value==m.value&&n.subColumn==m.subColumn}else{if(f.isBlank(m.children)||n.operator!=m.operator||n.children.length!=m.children.length){return false}}return _.all(n.children,function(o){return _.any(m.children,function(p){return k(o,p)})})};blist.filter.subtractQueries=function(m,n){m=blist.filter.collapseChildren(m);n=blist.filter.collapseChildren(n);if(!f.isBlank(m.children)&&m.operator.toUpperCase()=="AND"){if(f.isBlank(n.children)){m.children=_.reject(m.children,function(o){return k(o,n)})}else{if(n.operator.toUpperCase()=="AND"){m.children=_.reject(m.children,function(o){return _.any(n.children,function(p){return k(o,p)})})}}return m}else{if(k(m,n)){return null}else{return m}}};blist.filter.isEmptyPlaceholderFilter=function(m){return _.isEmpty(m.children)&&m.metadata&&(m.metadata.includeAuto||m.metadata.customValues)}})(jQuery);blist.namespace.fetch("blist.datatypes");(function(E){var P=function(aa,Z,Y,V,X,W){var U=V?E.htmlStrip(aa):(E.isBlank(aa)?"":aa);return W?U:E.htmlEscape(U)};var R=function(X,V,W,U){if(E.isBlank(X)){return""}if(W||U){return E.htmlStrip(X)}return'<span class="blist-html">'+X+"</span>"};var z={"0":true,"1":true,"2":true,"3":true,"4":true,"5":true,"6":true,"7":true,"8":true,"9":true};var H=function(ab,V,Y,W,ad,aa,ae,af,ac){if(E.isBlank(ab)){return""}ac=ac||{};var X=ab.toString();if(_.isString(af)&&(af!=="")){ab="";var U=ac.decimalSeparator||".";while(X.length&&af.length){if(X.charAt(0)==="."){ab+=U;X=X.slice(1)}if(af.charAt(0)==="#"){ab+=X.charAt(0);X=X.slice(1)}else{ab+=af.charAt(0)}af=af.slice(1)}if(af.indexOf("#")===-1){ab+=af}ab+=X}else{if(!_.isNumber(ab)){if(_.isString(ab)){ab=ab.replace(/[^0-9\.\+\-]/g,"")}ab=parseFloat(ab);if(_.isNaN(ab)){return X}}if(Y=="scientific"){if(V!==undefined){ab=ab.toExponential(V)}else{ab=ab.toExponential()}}else{if(V!==undefined){ab=ab.toFixed(V)}}if(aa===true||aa==="true"){ab=blist.util.toHumaneNumber(ab,2)}ab=ab.toString();var Z=ab.indexOf(".");if(!E.isBlank(ac.decimalSeparator)&&Z>-1){ab=ab.substring(0,Z)+ac.decimalSeparator+ab.substring(Z+1)}if(ae!==true&&ae!="true"){if(Z==-1){Z=ab.length}Z-=3;while(Z>0&&z[ab.charAt(Z-1)]){ab=ab.substring(0,Z)+(ac.groupSeparator||",")+ab.substring(Z);Z-=3}}}if(W){ab=W+ab}if(ad){ab+=ad}return ab};var F=function(V,U){return H(V,U.format.precision,U.format.precisionStyle,null,null,false,U.format.noCommas,U.format.mask,{groupSeparator:U.format.groupSeparator,decimalSeparator:U.format.decimalSeparator})};var f=function(V,U){if(_.isString(V)){V=V.replace(/[^0-9\.\-\+]/g,"")}return H(V,(U.format.precision||2),U.format.precisionStyle,blist.datatypes.money.currencies[U.format.currency||"USD"],null,U.format.humane,false,null,{groupSeparator:U.format.groupSeparator,decimalSeparator:U.format.decimalSeparator})};var c=function(aa,W,Y,U){if(Y||U){return H(aa,W.format.precision,W.format.precisionStyle,null,"%",false,W.format.noCommas,null,{groupSeparator:W.format.groupSeparator,decimalSeparator:W.format.decimalSeparator})}var X;var Z;switch(W.format.view){case"percent_bar":X=false;Z=true;break;case"percent_text":X=true;Z=false;break;default:X=Z=true;break}var V=['<span class="blist-percent">'];if(Z&&!!aa){var ac;var ab=aa;if(aa>0){ac="blist-percent-bar-pos"}else{ac="blist-percent-bar-neg";ab*=-1}if(ab>100){ab=100}V.push('<span class="blist-cell ',ac,'" style="width: ',ab,'%"></span>')}if(X){V.push('<span class="blist-cell blist-percent-num">',H(aa,W.format.precision,W.format.precisionStyle,null,"%",false,W.format.noCommas,null,{groupSeparator:W.format.groupSeparator,decimalSeparator:W.format.decimalSeparator}),"</span>")}V.push("</span>");return V.join("")};var m="m/d/Y h:i:s A O";var S=function(ac,Y){if(ac==null){return""}var aa;if(_.isNumber(ac)){aa=new Date(ac*1000)}else{if(!E.isBlank(Y)){aa=Date.parseExact(ac,Y)}else{aa=Date.parse(ac)}}if(!aa){return""}var X=aa.getHours();if(X>11){X-=12;var V=" PM"}else{V=" AM"}if(!X){X=12}if(X<10){X="0"+X}var W=aa.getMinutes();if(W<10){W="0"+W}var U=aa.getSeconds();if(U<10){U="0"+U}var ab=aa.getDate();if(ab<10){ab="0"+ab}var Z=aa.getMonth()+1;if(Z<10){Z="0"+Z}return Z+"/"+ab+"/"+aa.getFullYear()+" "+X+":"+W+":"+U+V+" "+aa.getUTCOffset()};var o=function(W,V){if(E.isBlank(W)){return""}var U=V.renderType||blist.datatypes.date;var X=U.formats[V.format.view]||U.formats.date_time;if(X==m){return S(W,U.stringParse)}var Y;if(_.isNumber(W)){Y=new Date(W*1000)}else{W=W.replace(/\.\d{3}Z?/,"");if(!E.isBlank(U.stringParse)){Y=Date.parseExact(W,U.stringParse)}else{Y=Date.parse(W)}}return Y?Y.format(X):""};var K=function(Z,X,W,Y){if(!Z){return""}var V;var U;if(Z instanceof Array){V=Z[0];U=Z[1]||V}else{if(Z instanceof Object){V=Z.url;U=Z.description||V}else{U=V=Z+""}}if(V&&V!=""&&!V.match(/^([a-z]+):/i)){if(!E.isBlank(Y)){V=Y+V}else{if(V.indexOf("/")!=0){V="http://"+V}}}if(!X){U=E.htmlEscape(U)}if(W){return V||U||""}return"<a target='blist-viewer' rel='external' href='"+E.htmlEscape(V)+"'>"+U+"</a>"};var L=function(X,V,W,U){return W||U?X:K(X&&["mailto:"+X,X])};var C=function(ab,V,W,U){var ac=ab;if(!ab){return""}var X;var Z;if(_.isArray(ab)){X=ab[0]||"";Z=ab[1]}else{if(E.isPlainObject(ab)){X=ab.phone_number||"";Z=ab.phone_type}else{X=ab+""}}var aa=X+"";if(aa.match(/^\d{10}$/)){aa="("+aa.substring(0,3)+") "+aa.substring(3,6)+"-"+aa.substring(6,10)}else{if(aa.match(/^\d{7}$/)){aa=aa.substring(0,3)+"-"+aa.substring(3,7)}}var Y=Z?Z.toLowerCase():"unknown";if(W){if(Z){aa+=" ("+Y+")"}return aa}aa=(U&&!Z?"":'<span class="blist-phone-icon blist-phone-icon-'+Y+'">'+Y+"</span>&nbsp;")+E.htmlEscape(aa);return U?aa:K(["tel:"+X.replace(/[\-()\s]/g,""),aa],true)};var k=function(Y,X,W,V){var U=Y;if(V){U=E.keyValueToObject("description",Y.description||U[1]);if(E.isBlank(U.description)){U.url=Y.url||U[0]}}return K(Y,false,W||V,(X.format||{}).baseUrl)};var d=function(X,W,V,U){if(V){return X?"&#10003;":""}return['<span class="blist-cell blist-checkbox blist-checkbox-',(X?"on":"off"),'"',(!U?(' title="'+(X?"True":"False")):""),'">',(X?"True":"False"),"</span>"].join("")};STAR_WIDTH=16;var N=function(ad,Y,aa,V,U){if(E.isBlank(ad)||ad<=0){return""}var X=[];if(aa){for(var Z=0;Z<ad;Z++){X.push("*")}return X.join("")}var ab=parseFloat(Y.format.range);if(ab<=0||isNaN(ab)){ab=5}ab*=STAR_WIDTH;if(V){X.push('<div class="blist-tstars-wrapper">')}var ac=Math.min(ab,Math.round(ad*STAR_WIDTH));var W=ab-ac;X.push('<span class="blist-tstars-render-wrapper" style="width:',ab,'px">');if((U||{permissions:{}}).permissions.canEdit){X.push('<span class="blist-star-0"></span>')}X.push('<span class="blist-tstars" style="width: ',ab,'px"><span class="blist-cell blist-tstar-on" style="width: ',ac,'px"></span><span class="blist-cell blist-tstar-off" style="width: ',W,"px; background-position-x: ",-(ac%STAR_WIDTH),'px"></span></span></span>');if(V){X.push(ad,"</div>")}return X.join("")};var q=function(ab,Z,Y,X){if(E.isBlank(ab)){return""}var W=ab;var V=Z.format.view;if(this.name!="location"){V="address_coords";W=E.keyValueToObject(this.name,W)}if(E.isBlank(V)){V="address_coords"}var aa=[];if(!E.isBlank(W.human_address)&&V.startsWith("address")){var U=_.isString(W.human_address)?JSON.parse(W.human_address):W.human_address;if(!E.isBlank(U.address)&&U.address!==""){aa.push(U.address)}aa.push(_.compact([_.compact([U.city,U.state]).join(", "),U.zip]).join(" "))}if(V.endsWith("coords")&&(!E.isBlank(W.latitude)||!E.isBlank(W.longitude))){aa.push("("+(W.latitude||"")+(Y?"":"&deg;")+", "+(W.longitude||"")+(Y?"":"&deg;")+")")}return aa.join(Y||X?" \n":"<br />")};var B=function(Y,X){if(E.isBlank(Y)){return""}var Z=[];if(!E.isBlank(Y.geometry)){var W="60";var U="150";var V=E.addAppToken(X.baseUrl()+Y.row_id+"?column="+X.id+"&width="+W+"&height="+U);if(E.browser.msie){Z.push('<v:vmlframe src="',V,'&type=vml#shape01" ','style="width:',W,"px; height:",U,'px;"/>')}else{Z.push('<embed src="',V,'" width="',W,'" height="',U,'"></embed>')}}return Z.join("")};var y=function(ab,aa,Z,V,Y){if(E.isBlank(ab)){return""}var W=aa.baseUrl()+ab;if(Z){return W}var X=escape(W);if(!E.isBlank(aa.format.size)){X+="?size="+aa.format.size}var U='<img src="'+E.htmlEscape(X)+'"></img>';if((Y||{permissions:{}}).permissions.canEdit){return U}return K({url:ab,description:U},true,false,aa.baseUrl())};var b=function(aa,Z,Y){var W,V,X;if(!aa){return""}else{if(_.isArray(aa)){W=aa[2];V=aa[1];X=aa[3]}else{if(E.isPlainObject(aa)){if(aa.id){W=aa.id;V=aa.filename;X=aa.size}else{W=aa.file_id+"?";var U=[];if(aa.filename){U.push("filename="+escape(aa.filename))}if(aa.content_type){U.push("content_type="+escape(aa.content_type))}W+=U.join("&");V=aa.filename;X=aa.size}}else{W=aa+""}}}if(!W){return""}if(Y){return V||""}var ab=K([(Z.baseUrl()||"")+W,V||"Document"]);if(!E.isBlank(X)){X=Math.round(X/1024);if(X==0){X=1}ab+='&nbsp;<span class="blist-document-size">('+X+"k)</span>"}return ab};var Q=function(ab,X,Z){if(!_.isString(ab)||E.isBlank(ab)){return""}var W;var V=X.dropDownList||this.dropDownList;if(V){var U=ab.toLowerCase();for(var Y=0;Y<V.values.length;Y++){var ac=V.values[Y];if((ac.id||"").toLowerCase()==U){W=ac;break}}}if(E.isBlank(W)){return Z?ab:'<div class="blist-dataset-link-dangling">'+ab+"</div>"}var aa=X.format.view||(this.format||{}).view||"icon_text";var ad=[];if(!Z){ad.push('<span class="blist-dropdownlist-wrapper blist-'+(this.cls||this.name)+'">');if(!E.isBlank(W.icon)&&aa.startsWith("icon")){ad.push('<img class="blist-table-option-icon" src="',W.icon,'" title="',E.htmlStrip(W.description||""),'" />')}}if(Z||aa.endsWith("text")){ad.push(E.htmlStrip(W.description||""))}if(!Z){ad.push("</span>")}return ad.join("")};var w=function(U){return E.htmlEscape(U?JSON.stringify(U):"")};var j=function(V,U){return"?"};var D=function(U){return U?1:0};var g=[{text:E.t("core.aggregates.average"),value:"avg",calculate:function(U){var W=0;var V=_.reduce(U,function(Y,X){if(E.isBlank(X)){return Y}W++;return Y+parseFloat(X)},0);return V/(W||1)}},{text:E.t("core.aggregates.count"),value:"count",calculate:function(U){return _.reduce(U,function(W,V){return W+(E.isBlank(V)?0:1)},0)}},{text:E.t("core.aggregates.sum"),value:"sum",calculate:function(U){return _.reduce(U,function(W,V){return W+(E.isBlank(V)?0:parseFloat(V))},0)}},{text:E.t("core.aggregates.maximum"),value:"max",calculate:function(U){return _.reduce(U,function(W,V){return E.isBlank(W)?V:(E.isBlank(V)?W:Math.max(W,parseFloat(V)))},null)}},{text:E.t("core.aggregates.minimum"),value:"min",calculate:function(U){return _.reduce(U,function(W,V){return E.isBlank(W)?V:(E.isBlank(V)?W:Math.min(W,parseFloat(V)))},null)}}];blist.datatypes.soda2Aggregate=function(U){return{average:"avg",minimum:"min",maximum:"max"}[U]||U};blist.datatypes.aggregateFromSoda2=function(U){return{avg:"average",min:"minimum",max:"maximum"}[U]||U};var t=_.select(g,function(U){return"count"==U.value});var h={text:E.t("core.alignment.left"),value:"left"};var u={text:E.t("core.alignment.center"),value:"center"};var T={text:E.t("core.alignment.right"),value:"right"};var a=[h,u,T];var M=[T,h,u];var I=["money","number","percent","stars"];var e="h:i A";var J=e+" O";var G="h:i:s A";var s=G+" O";var v={date_time:"m/d/Y",date:"m/d/Y",date_dmy_time:"d/m/Y",date_dmy:"d/m/Y",date_ymd_time:"Y/m/d",date_ymd:"Y/m/d",date_monthdy_time:"F d, Y",date_monthdy:"F d, Y",date_shortmonthdy:"M d, Y",date_monthdy_shorttime:"F d, Y",date_dmonthy:"d F Y",date_shortmonthdy_shorttime:"M d, Y",date_ymonthd_time:"Y F d",date_ymonthd:"Y F d",date_my:"m/Y",date_ym:"Y/m",date_shortmonthy:"M Y",date_yshortmonth:"Y M",date_monthy:"F Y",date_ymonth:"Y F",date_y:"Y"};var n={};var O={};_.each(v,function(V,U){n[U]=V;O[U]=V;if(U.endsWith("_time")){n[U]+=" "+G;O[U]+=" "+s}else{if(U.endsWith("_shorttime")){n[U]+=" "+e;O[U]+=" "+J}}});var A=[{value:"date_time",text:"month/day/year hour:minute"},{value:"date",text:"month/day/year"},{value:"date_dmy_time",text:"day/month/year hour:minute"},{value:"date_dmy",text:"day/month/year"},{value:"date_ymd_time",text:"year/month/day hour:minute"},{value:"date_ymd",text:"year/month/day"},{value:"date_monthdy_shorttime",text:"month day, year hour:minute"},{value:"date_monthdy",text:"month day, year"},{value:"date_shortmonthdy",text:"month day, year"},{value:"date_monthdy_time",text:"month day, year hour:minute"},{value:"date_dmonthy",text:"day month year"},{value:"date_shortmonthdy_shorttime",text:"month day, year hour:minute"},{value:"date_ymonthd",text:"year month day"},{value:"date_ymonthd_time",text:"year month day hour:minute"},{value:"date_my",text:"month/year",isMonth:true},{value:"date_ym",text:"year/month",isMonth:true},{value:"date_shortmonthy",text:"month year",isMonth:true},{value:"date_yshortmonth",text:"year month",isMonth:true},{value:"date_monthy",text:"month year",isMonth:true},{value:"date_ymonth",text:"year month",isMonth:true},{value:"date_y",text:"year",isYear:true}];var x=function(W,V){var U=_.isString(W)||E.isBlank(W)?W:W.format.group_function;return _.select(A,function(X){switch(U){case"date_ymd":return !X.value.endsWith("time")&&(!V||!X.isMonth&&!X.isYear);case"date_ym":return X.isMonth||!V&&X.isYear;case"date_y":return X.isYear;default:return !V||X.value.endsWith("time")}})};var l=function(U){return[{text:E.t("core.group_function.date_day"),value:U+"_trunc_ymd"},{text:E.t("core.group_function.date_month"),value:U+"_trunc_ym"},{text:E.t("core.group_function.date_year"),value:U+"_trunc_y"}]};blist.datatypes.soda2GroupFunction=function(W,U){if(E.isBlank(W)){return W}var V="";if(W.startsWith("date_")){V+=(U.renderTypeName=="date"?"datez":"date")}V+="_trunc_"+W.slice(W.indexOf("_")+1);return V};blist.datatypes.groupFunctionFromSoda2=function(U){if(E.isBlank(U)){return U}return U.replace("datez_","date_").replace("_trunc_","_")};blist.datatypes.interfaceTypes={checkbox:{renderer:d},date:{renderer:o},document:{renderer:b},email:{renderer:L},geospatial:{renderer:B},html:{renderer:R},location:{renderer:q},lookupList:{renderer:Q},money:{renderer:f},number:{renderer:F},object:{renderer:w},percent:{renderer:c},phone:{renderer:C},photo:{renderer:y},stars:{renderer:N},text:{renderer:P},url:{renderer:k},point:{renderer:w},multiline:{renderer:j},multipolygon:{renderer:j}};E.extend(blist.datatypes,{invalid:{interfaceType:blist.datatypes.interfaceTypes.text},text:{title:"Plain Text",interfaceType:blist.datatypes.interfaceTypes.text,aggregates:t,alignment:a,convertableTypes:["html","calendar_date","date","phone","email","url","checkbox","flag","dataset_link"].concat(I),createable:true,deleteable:true,filterConditions:blist.filter.groups.textual,inlineType:true,matchValue:function(U){if(_.isString(U)){U=U.toLowerCase()}return U},priority:1,rollUpAggregates:t,sortable:true},html:{title:"Formatted Text",interfaceType:blist.datatypes.interfaceTypes.html,aggregates:t,convertableTypes:["text","calendar_date","date","phone","email","url","checkbox","flag","dataset_link"].concat(I),createable:true,deleteable:true,filterConditions:E.extend(true,{details:{EQUALS:{interfaceType:blist.datatypes.interfaceTypes.text},NOT_EQUALS:{interfaceType:blist.datatypes.interfaceTypes.text},STARTS_WITH:{interfaceType:blist.datatypes.interfaceTypes.text},CONTAINS:{interfaceType:blist.datatypes.interfaceTypes.text},NOT_CONTAINS:{interfaceType:blist.datatypes.interfaceTypes.text}}},blist.filter.groups.textual),priority:2,rollUpAggregates:t,sortable:true},number:{title:"Number",interfaceType:blist.datatypes.interfaceTypes.number,aggregates:g,alignment:M,cls:"number",convertableTypes:_.without(I,"number").concat("text").concat("dataset_link"),createable:true,deleteable:true,filterConditions:blist.filter.groups.numeric,inlineType:true,matchValue:function(U){U=parseFloat(U);return _.isNaN(U)?null:U},precisionStyle:[{text:E.t("core.precision_style.standard"),value:"standard"},{text:E.t("core.precision_style.scientific"),value:"scientific"}],priority:3,rollUpAggregates:g,sortable:true},money:{title:"Money",interfaceType:blist.datatypes.interfaceTypes.money,aggregates:g,alignment:M,cls:"money",convertableTypes:_.without(I,"money").concat("text"),createable:true,currencies:{USD:"$",GBP:"",EUR:"",JPY:"",AFN:"",ALL:"Lek",ANG:"",ARS:"$",AUD:"$",AWG:"",AZN:"",BAM:"KM",BBD:"$",BGN:"",BMD:"$",BND:"$",BOB:"$b",BRL:"R$",BSD:"$",BWP:"P",BYR:"p.",BZD:"BZ$",CAD:"$",CHF:"CHF",CLP:"$",CNY:"",COP:"$",CRC:"",CUP:"",CZK:"K",DKK:"kr",DOP:"RD$",EEK:"kr",EGP:"",FJD:"$",FKP:"",GGP:"",GHC:"",GIP:"",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HUF:"Ft",INR:"Rp",ILS:"",IMP:"",IRR:"",ISK:"kr",JEP:"",JMD:"J$",KGS:"",KHR:"",KPW:"",KRW:"",KYD:"$",KZT:"",LAK:"",LBP:"",LKR:"",LRD:"$",LTL:"Lt",LVL:"Ls",MKD:"",MNT:"",MUR:"",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"",NIO:"C$",NOK:"kr",NPR:"",NZD:"$",OMR:"",PAB:"B/.",PEN:"S/.",PHP:"Php",PKR:"",PLN:"z",PYG:"Gs",QAR:"",RON:"lei",RSD:".",RUB:"",SAR:"",SBD:"$",SCR:"",SEK:"kr",SGD:"$",SHP:"",SOS:"S",SRD:"$",SVC:"$",SYP:"",THB:"",TRL:"",TRY:"TL",TTD:"TT$",TVD:"$",TWD:"NT$",UAH:"",UYU:"$U",UZS:"",VEF:"Bs",VND:"",XCD:"$",YER:"",ZAR:"R",ZWD:"Z$"},deleteable:true,filterConditions:blist.filter.groups.numeric,soqlFilterValue:function(U){return"to_usd("+U+")"},inlineType:true,matchValue:function(U){U=parseFloat(U);return _.isNaN(U)?null:U},priority:4,rollUpAggregates:g,sortable:true},percent:{title:"Percent",interfaceType:blist.datatypes.interfaceTypes.percent,aggregates:g,alignment:M,cls:"percent",convertableTypes:_.without(I,"percent").concat("text"),createable:true,deleteable:true,filterConditions:blist.filter.groups.numeric,matchValue:function(U){U=parseFloat(U);return _.isNaN(U)?null:U},priority:5,rollUpAggregates:g,sortable:true,viewTypes:[{value:"percent_bar_and_text",text:"Bar &amp; Text"},{value:"percent_bar",text:"Bar Only"},{value:"percent_text",text:"Text Only"}]},date:{title:"Date & Time (with timezone)",interfaceType:blist.datatypes.interfaceTypes.date,aggregates:t,alignment:a,cls:"date",convertableTypes:["text","calendar_date"],createable:true,deleteable:true,filterConditions:blist.filter.groups.date,filterValue:function(U){var V=U;if(_.isNumber(U)){V=new Date(U*1000)}else{V=Date.parse(U)}return E.isBlank(V)?"":V.format("m/d/Y h:i:s A")},formats:O,fromSoQLValue:function(U,V){var W=U;if(_.isString(U)){W=new Date(W);if(!E.isBlank(W)){W=W.getTime()/1000}}return W},inlineType:true,matchValue:function(U){var V=U;if(_.isString(U)){V=Date.parse(U);if(!E.isBlank(V)){V=V.getTime()/1000}}return V},priority:7,rollUpAggregates:t,groupFunctions:l("datez"),soqlFilterValue:function(U){var V=U;if(_.isString(U)){V=Date.parse(U)}else{if(_.isNumber(U)){V=new Date(U*1000)}}if(_.isDate(V)){V="'"+V.toISOString().replace(/\.\d{3}/,"")+"'"}return V},sortable:true,viewTypes:x},calendar_date:{title:"Date & Time",interfaceType:blist.datatypes.interfaceTypes.date,aggregates:t,alignment:a,cls:"date",convertableTypes:["text","date"],createable:true,deleteable:true,filterConditions:blist.filter.groups.date,filterValue:function(U){return U},formats:n,inlineType:true,priority:6,rollUpAggregates:t,groupFunctions:l("date"),sortable:true,stringParse:"yyyy-MM-ddTHH:mm:ss",stringFormat:"yyyy-MM-ddTHH:mm:ss",viewTypes:x},email:{title:"Email",interfaceType:blist.datatypes.interfaceTypes.email,aggregates:t,alignment:a,convertableTypes:["text"],createable:true,deleteable:true,filterConditions:E.extend(true,{details:{STARTS_WITH:{interfaceType:blist.datatypes.interfaceTypes.text},CONTAINS:{interfaceType:blist.datatypes.interfaceTypes.text},NOT_CONTAINS:{interfaceType:blist.datatypes.interfaceTypes.text}}},blist.filter.groups.textual),inlineType:true,priority:10,rollUpAggregates:t,sortable:true},phone:{title:"Phone",interfaceType:blist.datatypes.interfaceTypes.phone,aggregates:t,alignment:a,cls:"phone",convertableTypes:["text"],createable:true,defaultFilterSubColumn:"phone_type",deleteable:true,priority:14,sortable:true,subColumns:{phone_number:{title:"Number",interfaceType:blist.datatypes.interfaceTypes.text,filterConditions:blist.filter.groups.textual},phone_type:{title:"Type",interfaceType:blist.datatypes.interfaceTypes.lookupList,dropDownList:{values:[{id:"Cell",description:"Cell",icon:"/stylesheets/images/content/table/phones/cell.png"},{id:"Home",description:"Home",icon:"/stylesheets/images/content/table/phones/home.png"},{id:"Work",description:"Work",icon:"/stylesheets/images/content/table/phones/work.png"},{id:"Fax",description:"Fax",icon:"/stylesheets/images/content/table/phones/fax.png"},{id:"Other",description:"Other",icon:"/stylesheets/images/content/table/phones/other.png"}]},filterConditions:blist.filter.groups.comparable}}},url:{title:"Website URL",interfaceType:blist.datatypes.interfaceTypes.url,aggregates:t,alignment:a,convertableTypes:["text","dataset_link"],createable:true,defaultFilterSubColumn:"description",deleteable:true,inlineType:true,priority:9,rollUpAggregates:t,sortable:true,subColumns:{url:{title:"URL",interfaceType:blist.datatypes.interfaceTypes.url,cls:"url_sub",filterConditions:E.extend(true,{details:{STARTS_WITH:{interfaceType:blist.datatypes.interfaceTypes.text},CONTAINS:{interfaceType:blist.datatypes.interfaceTypes.text},NOT_CONTAINS:{interfaceType:blist.datatypes.interfaceTypes.text}}},blist.filter.groups.textual)},description:{title:"Description",interfaceType:blist.datatypes.interfaceTypes.text,filterConditions:blist.filter.groups.textual}}},checkbox:{title:"Checkbox",interfaceType:blist.datatypes.interfaceTypes.checkbox,aggregates:t,alignment:[u,h,T],convertableTypes:["text"],createable:true,deleteable:true,filterConditions:blist.filter.groups.check,filterValue:D,isInlineEdit:true,priority:11,rollUpAggregates:t,sortable:true},flag:{title:"Flag",interfaceType:blist.datatypes.interfaceTypes.lookupList,aggregates:t,alignment:a,convertableTypes:["text"],createable:true,deleteable:true,dropDownList:{values:[{id:"red",description:"Red",icon:"/stylesheets/images/content/table/flags/red.png"},{id:"blue",description:"Blue",icon:"/stylesheets/images/content/table/flags/blue.png"},{id:"green",description:"Green",icon:"/stylesheets/images/content/table/flags/green.png"},{id:"yellow",description:"Yellow",icon:"/stylesheets/images/content/table/flags/yellow.png"},{id:"orange",description:"Orange",icon:"/stylesheets/images/content/table/flags/orange.png"},{id:"purple",description:"Purple",icon:"/stylesheets/images/content/table/flags/purple.png"}]},filterConditions:blist.filter.groups.comparable,format:{view:"icon"},priority:12,rollUpAggregates:t,sortable:true},stars:{title:"Star",interfaceType:blist.datatypes.interfaceTypes.stars,aggregates:_.reject(g,function(U){return U.value=="sum"}),alignment:a,cls:"stars",convertableTypes:_.without(I,"stars").concat("text"),createable:true,deleteable:true,filterConditions:blist.filter.groups.numeric,isInlineEdit:true,priority:13,rollUpAggregates:_.reject(g,function(U){return U.value=="sum"}),soqlFieldWrapper:function(U,V){return V.endsWith("BLANK")?U:"to_number("+U+")"},sortable:true},location:{title:"Location",interfaceType:blist.datatypes.interfaceTypes.location,alignment:a,createable:true,defaultFilterSubColumn:"human_address",deleteable:true,priority:8,disableNBEFilter:true,matchValue:function(U){if(_.isString((U||{}).human_address)){U=E.extend({},U,{human_address:E.deepCompact(JSON.parse(U.human_address))});_.each(_.keys(U.human_address),function(V){U.human_address[V]=U.human_address[V].toLowerCase()})}return U},subColumns:{human_address:{title:"Address",interfaceType:blist.datatypes.interfaceTypes.location,matchValue:function(U){if(_.isString(U)){U=E.deepCompact(JSON.parse(U));_.each(_.keys(U),function(V){U[V]=(U[V]||"").toLowerCase()||null})}return U},filterConditions:blist.filter.groups.textObject},latitude:{title:"Latitude",interfaceType:blist.datatypes.interfaceTypes.number,filterConditions:blist.filter.groups.numeric,matchValue:function(U){U=parseFloat(U);return _.isNaN(U)?null:U}},longitude:{title:"Longitude",interfaceType:blist.datatypes.interfaceTypes.number,filterConditions:blist.filter.groups.numeric,matchValue:function(U){U=parseFloat(U);return _.isNaN(U)?null:U}}},viewTypes:[{value:"address_coords",text:"Address &amp; Coordinates"},{value:"coords",text:"Coordinates Only"},{value:"address",text:"Address Only"}]},geospatial:{title:"Geospatial",interfaceType:blist.datatypes.interfaceTypes.geospatial,alignment:a,createable:false,deleteable:false,priority:20},document:{title:"Document",interfaceType:blist.datatypes.interfaceTypes.document,aggregates:t,createable:true,deleteable:true,filterConditions:blist.filter.groups.blob,inlineType:true,priority:17},document_obsolete:{title:"Document (old)",interfaceType:blist.datatypes.interfaceTypes.document,aggregates:t,deleteable:true,filterConditions:blist.filter.groups.blob,inlineType:true,soda1Only:true},photo:{title:"Photo (Image)",interfaceType:blist.datatypes.interfaceTypes.photo,aggregates:t,cls:"photo",createable:true,deleteable:true,filterConditions:blist.filter.groups.blob,priority:16},photo_obsolete:{title:"Photo (Image, old)",interfaceType:blist.datatypes.interfaceTypes.photo,aggregates:t,cls:"photo",deleteable:true,filterConditions:blist.filter.groups.blob,soda1Only:true},drop_down_list:{title:"Multiple Choice",interfaceType:blist.datatypes.interfaceTypes.lookupList,aggregates:t,alignment:a,createable:true,deleteable:true,filterConditions:blist.filter.groups.comparable,matchValue:function(U,V){if(V.view._useSODA2){return U}_.any(V.dropDownList.values,function(W,X){if(W.id==U){U=X;return true}return false});return U},fromSoQLValue:function(U,V){_.any(V.dropDownList.values,function(W,X){if(W.id==U||W.description==U){U=W.id;return true}return false});return U},priority:15,rollUpAggregates:t,sortable:true},dataset_link:{title:"Dataset Link",interfaceType:blist.datatypes.interfaceTypes.lookupList,aggregates:t,alignment:a,convertableTypes:["text"],createable:true,deleteable:true,filterConditions:E.extend(true,{details:{STARTS_WITH:{interfaceType:blist.datatypes.interfaceTypes.text},CONTAINS:{interfaceType:blist.datatypes.interfaceTypes.text},NOT_CONTAINS:{interfaceType:blist.datatypes.interfaceTypes.text}}},blist.filter.groups.textual),matchValue:function(U,V){if(!E.isBlank(V.dropDownList)){_.any(V.dropDownList.values,function(W){if(W.id==U){U=W.description;return true}return false})}return U},priority:19,rollUpAggregates:t,sortable:true},picklist:{title:"Multiple Choice",interfaceType:blist.datatypes.interfaceTypes.lookupList,deleteable:true,filterConditions:blist.filter.groups.numeric,sortable:true},object:{title:"Object",interfaceType:blist.datatypes.interfaceTypes.object,alignment:a,createable:false,deleteable:false,priority:20},list:{title:"List",interfaceType:blist.datatypes.interfaceTypes.object,createable:false,deleteable:false,alignment:a,priority:21},point:{title:"Point",interfaceType:blist.datatypes.interfaceTypes.point,alignment:a,createable:false,deleteable:false,priority:22},multiline:{title:"Multi-Line",interfaceType:blist.datatypes.interfaceTypes.multiline,alignment:a,createable:false,deleteable:false,priority:23},multipolygon:{title:"Multi-Polygon",interfaceType:blist.datatypes.interfaceTypes.multipolygon,alignment:a,createable:false,deleteable:false,priority:24},nested_table:{title:"Nested Table",createable:false,deleteable:true,excludeInNestedTable:true,priority:18,soda1Only:true}});var p=function(V,U){V.name=V.name||U;V.renderer=function(){if(E.subKeyDefined(V,"interfaceType.renderer")){return V.interfaceType.renderer.apply(V,arguments)}return""};V.matches=function(Y,W){Y=Y.toUpperCase();if(!E.subKeyDefined(V,"filterConditions.details."+Y)){return false}var X=_.map(_.flatten(_.toArray(arguments).slice(2)),function(Z){if(_.isFunction(V.matchValue)){Z=V.matchValue(Z,W)}return Z});return V.filterConditions.details[Y].matches.apply(V,X)}};_.each(blist.datatypes,function(V,U){p(V,U);_.each(V.subColumns||{},function(X,W){p(X,W)})})})(jQuery);(function(a){a(function(){a.fn.socrataJqm=function(){this.jqm({trigger:false,modal:true,onShow:function(o){o.w.find("iframe").each(function(){var p=a(this),q=p.data("urltoload");if(!a.isBlank(q)){p.attr("src",q);p.removeData("urltoload").removeAttr("data-urltoload")}});a(".menu").trigger("menu-close");if(!_.isUndefined(blist.events)){a(document).trigger(blist.events.MODAL_SHOWN)}o.w.fadeIn("slow");o.o.fadeIn("slow")},onHide:function(o){o.w.fadeOut("slow");o.o.fadeOut("slow",function(){if(!_.isUndefined(blist.events)){a(document).trigger(blist.events.MODAL_HIDDEN)}})}})};a(".modalDialog, #modals > *").socrataJqm();a.live("a.jqmClose","click",function(o){o.preventDefault();a(this).closest(".modalDialog").jqmHide()});var l=a(".socrataModal");var h=a(".socrataModal .socrataModalWrapper");var f=a("body");var j=500;var m=[];var k=function(o){window.setTimeout(o,j)};l.hide();var g="hidden";var d=function(){if((g!=="hiding")&&(g!=="hidden")){return}l.show();f.css("overflow-y","hidden");g="showing";_.defer(function(){h.lockScroll(true);l.addClass("shown");k(function(){if(g==="hiding"){return}h.css("overflow-y","scroll");g="shown"})})};var b=function(){if((g!=="showing")&&(g!=="shown")){return}l.removeClass("shown");g="hiding";h.css("overflow-y","visible");f.css("overflow-y","visible");h.lockScroll(false);k(function(){if(g==="showing"){return}l.hide();g="hidden"})};var e=function(p){if((g!=="showing")&&(g!=="shown")){d()}var o=h.children(":last-child");if(o.length>0){var q=h.scrollTop();m.push(q);o.css("top",(parseFloat(o.css("top"))||0)-q);o.addClass("pushed");k(function(){o.hide()})}p.addClass("modalContents");h.append(p);_.defer(function(){p.addClass("shown");p.find(":input:first").focus().filter(":text, textarea").caretToEnd()})};var c=function(q){var p=h.children(":last-child");p.removeClass("shown");k(function(){p.remove()});var o=p.prev();if(q===true){p.prevAll().remove();m=[];b()}else{if(o.length>0){o.show();_.defer(function(){o.removeClass("pushed");k(function(){var s=m.pop();h.scrollTop(s);o.css("top",parseFloat(o.css("top"))+s)})})}else{b()}}};var n=function(){return h.children(".locked").length>0};a.fn.showModal=function(){var o=a(this);e(o);return o};a.showModal=function(o){return a("#newModals > #"+o).clone().showModal()};a.popModal=c;a(document).on("keyup",function(o){if(a(o.target).is(":not(:input)")&&(o.keyCode===27)&&!n()){c()}});h.on("click",function(o){if(o.target===this&&!n()){c(true)}});h.on("click",".jqmClose",function(o){o.preventDefault();c()});h.on("click",":radio, :checkbox",function(){a(this).focus()});h.on("keyup",function(o){if(o.keyCode===13){h.trigger("submit",o)}})})})(jQuery);(function(){var k=function(o){if(d(o)||(o===null)){return""}else{if(f(o)){var m=[];for(var p=0;p<o.length;p++){m.push(k(o[p]))}return m.join("")}else{if(a(o)||h(o)){return o.toString()}}}var q=o._,m=["<",q];if(d(q)){if(o.i===true){return k(o.t)}else{if(o.i===false){return k(o.e)}}return""}for(var l in o){if((l=="_")||(l=="contents")){continue}var n=e(o[l],l);if(l=="className"){l="class"}if(a(n)&&(n!=="")){m.push(" "+l+'="'+b(n)+'"')}}if((q=="input")||(q=="meta")||(q=="link")||(q=="img")){m.push("/>")}else{m.push(">"+k(o.contents)+"</"+q+">")}return m.join("")};var e=function(p,m){if(d(p)||(p===null)){return""}else{if(f(p)){var l=[];for(var o=0;o<p.length;o++){l.push(e(p[o]))}return l.join(" ")}else{if(a(p)||h(p)){return p.toString()}}}if((p===true)&&(m=="checked"||m=="selected"||m=="disabled"||m=="readonly"||m=="multiple"||m=="ismap"||m=="defer"||m=="declare"||m=="noresize"||m=="nowrap"||m=="noshade"||m=="compact")){return m}if(p===false){return""}if(p.i===true){return e(p.t)}else{if(p.i===false){return e(p.e)}}if(m=="style"){var l=[];for(var n in p){l.push(c(n)+":"+e(p[n]))}return l.join(";")}if(typeof p.toString=="function"){return p.toString()}};var b=function(l){return l.replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?!(?:[a-z0-9]{1,6}|#x?[a-f0-9]{1,4});)/ig,"&amp;")};var c=function(l){return l.replace(/[A-Z]/g,function(m){return"-"+m.toLowerCase()})};var d=function(l){return l===void 0};var h=function(l){return !!(l===0||(l&&l.toExponential&&l.toFixed))};var a=function(l){return !!(l===""||(l&&l.charCodeAt&&l.substr))};var f=Array.isArray||function(l){return Object.prototype.toString.call(l)==="[object Array]"};var g=this;if((typeof module!=="undefined")&&module.exports){module.exports={tag:k}}else{g.awesomemarkup=k}var j=g.jQuery;if(!d(j)){j.tag2=function(l,m){if(m===false){return k(l)}else{return j(k(l))}}}})();(function(c){c.fn.isSocrataTip=function(){return !c.isBlank(c(this[0]).data("socrataTip"))};c.fn.socrataTip=function(d){var f=c(this);if(f.length<2){var e=f.data("socrataTip");if(!e){e=new b(d,f[0])}return e}else{f.each(function(){var h=c(this);var g=h.data("socrataTip");if(!g){new b(d,h[0])}});return f}};var b=function(d,e){if(typeof d=="string"){d={message:d}}this.settings=c.extend({},b.defaults,d);this.currentDom=e;this.init()};c.extend(b,{defaults:{closeOnClick:true,content:null,killTitle:false,fill:"#fefbef",isSolo:false,message:null,onShowCallback:null,overlap:0,parent:"body",positions:null,shownCallback:null,showSpike:true,shrinkToFit:true,stroke:"#999999",trigger:"hover",width:"200px"},prototype:{init:function(){var e=this;var j=e.$dom();if(!j.exists()){return}j.data("socrataTip",e);if(c.isBlank(e.settings.message)&&c.isBlank(e.settings.content)){return}var k=e.settings.positions;if(_.isNull(k)){k=["bottom","top"]}else{if(k=="auto"){k=["most"]}}var h=e.settings.content;if(c.isBlank(h)){h=c.tag({tagName:"p",contents:e.settings.message},true)}var f=function(l){e._tipBox=l;c(l).data("socrataTip-$element",j);if(_.isFunction(e.settings.shownCallback)){e.settings.shownCallback(l)}};var d={wrapperzIndex:10000,boxzIndex:10001,textzIndex:10002};var g={content:_.isFunction(h)?null:h,contentSelector:_.isFunction(h)?h:null,fill:e.settings.fill,strokeStyle:e.settings.stroke,cornerRadius:3,spikeGirth:15,spikeLength:e.settings.showSpike?12:0,shadow:true,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.3)",noShadowOpts:{strokeWidth:2},clickAnywhereToClose:e.settings.closeOnClick,closeWhenOthersOpen:e.settings.isSolo,onShowCallback:e.settings.onShowCallback,postShow:f,shrinkToFit:e.settings.shrinkToFit,trigger:e.settings.trigger,positions:k,explicitPosition:e.settings.explicitPosition,overlap:e.settings.overlap,offsetParent:e.settings.parent,killTitle:e.settings.killTitle,width:e.settings.width,showTip:function(l){if(!e._disabled){e._visible=true;c(l).fadeIn(300)}},hideTip:function(l,m){e._visible=false;if(e._isDestroy){c(l).hide();_.defer(m)}else{c(l).fadeOut(300,m)}}};if(e.settings.onModal){c.extend(g,d)}j.bt(g);e._opts=j[0]._opts},$dom:function(){if(!this._$dom){this._$dom=c(this.currentDom)}return this._$dom},show:function(){if(!this._visible){this.$dom().btOn()}},hide:function(){if(this._visible){this.$dom().btOff()}},refreshSize:function(){var d=this;var e=d._opts.hideTip;d._opts.hideTip=function(f,g){d._visible=false;c(f).hide();_.defer(function(){g();_.defer(function(){d.show();d._opts.hideTip=e})})};d.hide()},quickHide:function(){a(this).css("visibility","hidden")},quickShow:function(){a(this).css("visibility","visible")},disable:function(){this._disabled=true},enable:function(){this._disabled=false},destroy:function(){this._isDestroy=true;this.hide();this.disable();this.$dom().btDestroy();this.$dom().removeData("socrataTip")},adjustPosition:function(e){var d=this;if(d._disabled||!d._visible){return}var f=a(d);if(!c.isBlank(e.top)){f.css("top",f.position().top+e.top)}if(!c.isBlank(e.left)){f.css("left",f.position().left+e.left)}},getTipPosition:function(){var d=this;if(!d._visible){return null}var e=a(d).find(".bt-content");var f=null;if(parseInt(e.css("margin-bottom"))>0){f="top"}else{if(parseInt(e.css("margin-top"))>0){f="bottom"}else{if(parseInt(e.css("margin-right"))>0){f="left"}else{if(parseInt(e.css("margin-left"))>0){f="right"}}}}return f}}});var a=function(d){return c(d._tipBox)};c.fn.socrataAlert=function(d){if(typeof d=="string"){d={message:d}}var e=c.extend({},c.fn.socrataAlert.defaults,d);return this.each(function(){var g=c(this);var h=c.meta?c.extend({},e,g.data()):e;if(_.isNull(h.message)){return}if(h.overlay){h.overlap=g.width()/2;h.positions=["left","right"];h.showSpike=false;delete h.overlay}var f=h.hideTime;delete h.hideTime;if(g.isSocrataTip()){g.socrataTip().destroy()}g.socrataTip(h);if(!c.isBlank(f)){setTimeout(function(){g.socrataTip().hide()},f)}})};c.fn.socrataAlert.defaults={hideTime:5000,message:null,overlay:false,trigger:"now"};c.fn.socrataTitleTip=function(){return this.each(function(){var d=c(this);d.socrataTip({message:d.attr("title").clean(),shrinkToFit:false,killTitle:true})})}})(jQuery);var textPromptNS=blist.namespace.fetch("blist.widgets.textPrompt");(function(a){a.fn.blistTextPrompt=function(){this.example(function(){return a(this).attr("title")});return this};a.fn.example.defaults.className="prompt"})(jQuery);$(function(){$(".textPrompt").blistTextPrompt();if(!$.isBlank($.validator)){var a=$.validator.methods.required;$.validator.methods.required=function(c,b,d){if((b.nodeName.toLowerCase()=="textarea"||(b.nodeName.toLowerCase()=="input"&&b.type.toLowerCase()=="text"))&&$(b).hasClass("prompt")){return false}return a.apply(this,[c,b,d])}}});(function(a){a.fn.extend({valueManager:function(b){if(b===undefined){return this.data("value-manager")}this.data("value-manager",b);return this},name:function(){var b;var c=this.data("value-manager");if(c&&c.name){b=(typeof c.name=="function"?c.name():c.name)}if(b==null){b=this.attr("name")||this.attr("id")}return b||undefined},value:function(c){if(c===undefined){var b=c;this.each(function(){var d=a(this);var e=d.data("value-manager");if(c===undefined){if(e&&e.get){b=e.get(c)}else{if(this.tagName=="TEXTAREA"){b=d.val();if(b===""){b=null}}else{if(this.tagName=="INPUT"||this.tagName=="SELECT"){if(d.attr("type")=="checkbox"||d.attr("type")=="radio"){b=d.attr("checked")?true:false}else{b=this.value;if(b===""){b=null}}}}}if(b!==undefined){return false}}});return b}this.each(function(){var d=a(this);var e=d.data("value-manager");if(e&&e.set){e.set(c)}else{if(this.tagName=="TEXTAREA"){d.val(c==null?"":c)}else{if(this.tagName=="INPUT"||this.tagName=="SELECT"){if(d.attr("type")=="checkbox"||d.attr("type")=="radio"){d.attr("checked",c?true:false)}else{this.value=c==null?"":c}}}}});return this},values:function(c,d){if(c===undefined){c={};if(d==undefined){d=true}}this.each(function(){var f=false;var g=a(this);if(g.data("value-manager")){f=true}else{switch(this.tagName){case"INPUT":case"SELECT":case"TEXTAREA":f=true;break}}if(f){var e=g.name();if(e){if(d){c[e]=g.value()}else{g.value(c[e])}}}});var b=a(this).children();if(b.length){b.values(c,d)}return c},valuesRead:function(b){},valuesWrite:function(b){}})})(jQuery);(function(f){f.fn.dropdownMenu=function(h){var j=f.extend({},f.fn.dropdownMenu.defaults,h);return this.each(function(){var m=f(this);var l=f.meta?f.extend({},j,m.data()):f.extend({},m.data("config-dropdownMenu"),j);m.data("config-dropdownMenu",l);var k=l.triggerButton||m.closest(l.menuContainerSelector).find(l.triggerButtonSelector);m.data("triggerButton",k);k.unbind("click.dropdownMenu.menu_trigger");k.bind("click.dropdownMenu.menu_trigger",function(o){o.preventDefault();if(l.openTest===undefined||l.openTest(o,m)){o.stopPropagation();if(!m.hasClass(l.menuOpenClass)){b(m)}else{a(m)}}});m.unbind("close.dropdownMenu");m.bind("close.dropdownMenu",function(o){a(m)});if(l.linkCallback!==undefined){m.find("a").unbind("click.dropdownMenu.menu_callback").bind("click.dropdownMenu.menu_callback",function(o){l.linkCallback(o,m,k)})}var n=m.find(l.submenuSelector);if(n.length>0){n.unbind("click.dropdownMenu.menu_subclick").bind("click.dropdownMenu.menu_subclick",function(o){if(f(o.currentTarget).children("a").find("*").andSelf().index(o.target)>=0){o.stopPropagation()}}).unbind("mouseover.dropdownMenu.menu_subactivate").bind("mouseover.dropdownMenu.menu_subactivate",function(o){e(o,m)});m.find("li").unbind("mouseover.dropdownMenu.menu_subclose").bind("mouseover.dropdownMenu.menu_subclose",function(o){g(o,m)})}m.find(l.menuSelector).andSelf().filter(l.optionMenuSelector).children("li").unbind("click.dropdownMenu.menu_optclick").bind("click.dropdownMenu.menu_optclick",function(o){f(this).closest(l.menuSelector).children("li").removeClass(l.selectedItemClass);f(this).closest("li").addClass(l.selectedItemClass)});if(m.is(l.multilevelMenuSelector)){m.find(l.topLevelLinkSelector).unbind("click.dropdownMenu.menu_multilevel").bind("click.dropdownMenu.menu_multilevel",function(o){o.stopPropagation()}).unbind("mouseover.dropdownMenu.menu_multilevel").bind("mouseover.dropdownMenu.menu_multilevel",function(o){d(o,m)})}if(l.menuBar!==undefined){k.unbind("mouseover.dropdownMenu.menu_menubar").bind("mouseover.dropdownMenu.menu_menubar",function(p){var o=l.menuBar.find("."+l.menuOpenClass+":not(#"+m.attr("id")+")");if(o.length>0){o.each(function(){a(f(this))});b(m)}})}})};function b(k){var m=f(document).height();var j=k.data("config-dropdownMenu");f(j.menuSelector+":visible").each(function(){a(f(this))});k.addClass(j.menuOpenClass);if(j.openCallback!=null){j.openCallback(k)}var h=k.data("triggerButton");h.addClass(j.triggerOpenClass);f(document).bind("click."+k.attr("id"),function(n){c(n,k)});if(j.closeOnKeyup){f(document).one("keyup",function(n){a(k)})}if(j.matchTriggerWidth){k.width(h.outerWidth(false))}if(j.forcePosition){k.css("left",h.position().left);k.css("top",h.position().top+h.outerHeight(true))}if(j.pullToTop){j._origPosition=k.position();var l=k.offset();l.top+=k.offsetParent().scrollTop();k.css(l).appendTo("body")}if(j.closeOnResize){f(window).one("resize",function(){a(k)})}if(j._origWidth){k.css("width",j._origWidth)}if(k.offset().left+k.outerWidth(true)>f(window).width()){if(h.offset().left+h.outerWidth(true)-k.outerWidth(true)<0){j._origWidth=k.css("width");k.css("width",f(window).width()-k.offset().left-5)}else{k.css("left",k.position().left-(k.outerWidth(true)-h.outerWidth(true)))}}if(k.offset().top+k.outerHeight(false)>m){if(h.offset().top-k.outerHeight(true)>0){k.css("top",k.position().top-(k.outerHeight(true)+h.outerHeight(true)))}}}function a(k){var j=k.data("config-dropdownMenu");if(!j){return}var h=k.data("triggerButton");if(j.pullToTop&&h[0].parentNode){k.css(j._origPosition).insertAfter(h)}k.removeClass(j.menuOpenClass);g(null,k);h.removeClass(j.triggerOpenClass);f(document).unbind("click."+k.attr("id"))}function g(k,j){var h=j.data("config-dropdownMenu");j.find("."+h.menuOpenClass).each(function(){if(!k||(f(this).find("*").index(k.currentTarget)<0&&f(this).parents("*").index(k.currentTarget)<0)){f(this).removeClass(h.menuOpenClass)}})}function c(k,j){var h=f(k.target);if(h.parents("*").index(j[0])<0||h.is("a:not(.noClose)")||h.parents("a:not(.noClose)").length>0){a(j)}}function d(k,j){var h=j.data("config-dropdownMenu");g(null,j);j.find("."+h.activeClass).removeClass(h.activeClass);f(k.currentTarget).closest("li").addClass(h.activeClass)}function e(k,j){var h=j.data("config-dropdownMenu");var l=f(k.currentTarget).children(h.menuSelector);l.addClass(h.menuOpenClass);l.css("top",Math.min(0,f(window).height()+f(window).scrollTop()-(l.offsetParent().offset().top+l.outerHeight(true))));l.css("left","");if(f(window).width()<l.offset().left+l.outerWidth(true)){l.css("left",-l.outerWidth(true)+5)}}f.fn.dropdownMenu.defaults={activeClass:"active",closeOnKeyup:false,forcePosition:false,matchTriggerWidth:false,menuContainerSelector:"li",menuOpenClass:"shown",menuSelector:"ul.menu",multilevelMenuSelector:".multilevelMenu",openCallback:function(h){},optionMenuSelector:".optionMenu",pullToTop:false,selectedItemClass:"checked",submenuSelector:".submenu",topLevelLinkSelector:"dt a",triggerButtonSelector:"a.dropdownLink",triggerOpenClass:"clicked"}})(jQuery);(function(c){c.fn.menu=function(e){var g=c.extend({},c.fn.menu.defaults,e);if(!_.isArray(g.contents[0])){g.contents=[g.contents]}var f=_.map(g.contents,function(k){var j=false;return _.compact(_.map(k,function(l){if(l.divider===true){j=true;return null}if(l.onlyIf===false){return null}else{if(j){l.className=(l.className||"")+" divider";j=false}}return l}))});var d={".@class+":"row.className","a .contents":"row.text","a@href":"row.href","a@rel":"row.rel","a@title":"row.title","a .subtext":"row.subtext"};_.each(g.additionalDataKeys,function(j){d["a@data-"+j]="row."+j});_.each(g.additionalJsonKeys,function(j){d["a@data-"+j]=function(l){return c.htmlEscape(JSON.stringify(l.item[j]))}});var h={"+a.menuButton":"menuButtonContents","a.menuButton@title":"menuButtonTitle","a.menuButton@class":"menuButtonClass",".menuDropdown>ul>li":{"column<-columns":{"ul>li":{"row<-column":d}}}};return this.each(function(){var j=c(this);j.empty().append(c.renderTemplate("menu",{menuButtonClass:g.menuButtonClass,menuButtonContents:g.menuButtonContents,menuButtonTitle:g.menuButtonTitle,columns:f},h));var k=j.children("a");var l=j.children("div");k.bind("click",function(m){m.preventDefault();if(l.is(":visible")){a(g,j,k,l)}else{b(g,j,k,l)}});j.bind("menu-close",function(m){if(l.is(":visible")){a(g,j,k,l)}})})};var b=function(d,e,j,k){if(_.isFunction(d.onOpen)){d.onOpen(e)}c(document).trigger("click.menu");var g=c.isBlank(d.parentContainer)?e.scrollParent():c(d.parentContainer);var h=g.offset()||{top:0,left:0};var n=g.height()+h.top;var f=g.width()+h.left;e.addClass("open");k.css("width","").css("right","").css("bottom","").css("top","").show();if((c.browser.msie)&&(c.browser.majorVersion<8)){var m=k.children("ul");var l=0;m.children().each(function(){l+=c(this).outerWidth(true)});m.width(l);k.width(m.outerWidth(true))}if(k.offset().left+k.outerWidth(true)>f){if(e.offset().left+j.outerWidth(true)-k.outerWidth(true)<0){k.css("width",c(window).width()-k.offset().left-10)}else{if(!d.noFlip){k.css("right",0)}}}if(k.offset().top+k.outerHeight(true)>n){if(e.offset().top-k.outerHeight(true)>0){k.css("bottom",e.innerHeight())}}else{k.css("top",j.outerHeight())}k.hide().fadeIn(200);c(document).unbind("click.menu");c(document).bind("click.menu",function(o){if(o.target==document||(e.has(o.target).length===0)||(k.find("a").has(o.target).length>0)||c(o.target).is(".menuDropdown a")){a(d,e,j,k)}})};var a=function(g,d,e,f){if(_.isFunction(g.onClose)){g.onClose(d)}c(document).unbind("click.menu");d.removeClass("open");if(d.is(":visible")){f.fadeOut(200)}else{f.hide()}};c.fn.menu.defaults={additionalDataKeys:[],additionalJsonKeys:[],contents:[],menuButtonClass:"menuButton",menuButtonContents:"Menu",menuButtonTitle:"Menu",onOpen:function(d){},onClose:function(d){},parentContainer:null}})(jQuery);jQuery.metrics={queue:[],pageLoadBucketNames:["awesome","good","ok","poor","terrible"],pageLoadBuckets:[500,1000,2000,4000],domLoadBuckets:[500,1000,2000,4000],stopwatches:{},stopwatchFunction:(window.performance!==undefined&&_.isFunction(performance.now))?function(){return performance.now()}:function(){return new Date().getTime()},increment:function(b,c,a){if((b===undefined)||(c===undefined)){return false}if($.socrataServer===undefined){return false}$.metrics.queue.push({entity:b,metric:c,increment:a});if($.metrics.queue.length>=10){$.metrics.flush_metrics()}},measure:(window.performance!==undefined&&_.isFunction(performance.now))?function(a,b){$.metrics.increment(a,b,performance.now())}:function(){},stopwatch:function(a,b,c){if(!$.metrics.stopwatches[a+"/"+b]){$.metrics.stopwatches[a+"/"+b]={entity:a,metric:b,pulses:[],start:function(){this.pulses.push({type:"start",timestamp:$.metrics.stopwatchFunction()});this.flush();this.started=true},pulse:function(){if(!this.started){return}this.pulses.push({type:"pulse",timestamp:$.metrics.stopwatchFunction()});this.flush()},end:function(){this.done=true;this.pulse()},flush:_.debounce(function(){if(!this.done){return}var e=_.detect(this.pulses,function(f){return f.type=="start"}),d=_.detect(this.pulses.slice().reverse(),function(f){return f.type=="pulse"});if(e&&d){$.metrics.increment(a,b,d.timestamp-e.timestamp)}this.pulses=[];this.done=false},1000)}}if(c=="clear"){delete $.metrics.stopwatches[a+"/"+b]}else{$.metrics.stopwatches[a+"/"+b][c]()}},mark:function(a,b){$.metrics.increment(a,b,1)},flush_metrics:function(){if($.metrics.queue.length===0){return}var a=$.metrics.queue;$.metrics.queue=[];$.socrataServer.makeRequest({url:"/analytics/add",type:"POST",data:JSON.stringify({metrics:a}),anonymous:true,isSODA:true,headers:{"Content-Type":"application/text"},success:function(){},error:function(){}})},collect_page_timings:function(){$.metrics.mark("domain","js-page-view");$.metrics.mark("domain","browser-"+$.metrics.browser_name());$.metrics.mark("domain-intern","browser-"+$.metrics.browser_name());$.metrics.mark("domain","browser-"+$.metrics.browser_name()+"-"+$.browser.majorVersion);$.metrics.mark("domain-intern","browser-"+$.metrics.browser_name()+"-"+$.browser.majorVersion);if(window.performance!==undefined){var h=performance.timing.navigationStart;var g=performance.timing.domComplete;var a=performance.timing.responseStart;if(h>0&&g>0&&a>0){var e=new Date().getTimezoneOffset();var d=g-h;var j=g-performance.timing.domLoading;$.metrics.mark("domain-intern","js-page-load-samples");$.metrics.increment("domain-intern","js-page-load-time",d);$.metrics.increment("domain-intern","js-page-load-tz-"+e+"-time",d);$.metrics.increment("domain-intern","js-response-start-time",a-h);$.metrics.increment("domain-intern","js-response-read-time",performance.timing.responseEnd-a);$.metrics.increment("domain-intern","js-connect-time",performance.timing.connectEnd-performance.timing.connectStart);$.metrics.increment("domain-intern","js-connect-tz-"+e+"-time",performance.timing.connectEnd-performance.timing.connectStart);$.metrics.increment("domain-intern","js-dom-load-time",j);var f=$.metrics.determine_page_type();$.metrics.increment("domain-intern",f+"-js-dom-load-time",j);$.metrics.mark("domain-intern",f+"-js-dom-load-samples");$.metrics.increment("domain-intern",f+"-js-page-load-time",d);$.metrics.mark("domain-intern",f+"-js-page-load-samples");if(f=="dataslate"){var b=_.size($.dataContext.availableContexts),c=_.detect([1,2,4,8,16,32,64,128],function(k){return b<k});$.metrics.increment("domain-intern","js-dataslate-lte-"+c+"-contexts-page-load-time",d)}}}$.metrics.flush_metrics()},determine_page_type:function(){var b=window.location.pathname;if(!b||b=="/"){return"homepage"}if($.subKeyDefined(blist,"configuration.page")){return"dataslate"}if(blist.dataset){var a=_.compact(_.map({order:"sort",group:"grouped",where:"filter",having:"filter"},function(c,d){return !_.isEmpty($.deepGet(blist.dataset,"metadata","jsonQuery",d))?c:null}));if(a.length>1){return"dataset-complex"}else{if(a.length==1){return"dataset-"+a[0]}else{return"dataset"}}}else{if(b.match("^/admin")){return"admin"}else{if(b.match("^/profile")){return"profile"}else{if(b.match("^/browse")){return"browse"+(window.location.href.indexOf("q=")>-1?"-search":"")}else{if($.subKeyDefined(blist,"govstat")){return"govstat"}}}}}return"other"},browser_name:function(){return $.browser.msie?"ie":$.browser.mozilla?"firefox":$.browser.chrome?"chrome":$.browser.safari?"safari":"other"}};$(window).load(function(){_.defer($.metrics.collect_page_timings)});$(window).unload(function(){$.metrics.flush_metrics()});$(function(){$.live("a[rel$=external]","focus",function(q){this.target="_blank"});$.live("a[rel$=external]","mouseover",function(q){this.target="_blank"});blist.iframeHack={modifierKeys:[16,17,18,91,93],pressed:{}};$("body").on("keydown",function(q){if(_.include(blist.iframeHack.modifierKeys,q.which)){blist.iframeHack.pressed[q.which]=true}});$("body").on("keyup",function(q){if(_.include(blist.iframeHack.modifierKeys,q.which)){blist.iframeHack.pressed[q.which]=false}});blist.iframeHack.isModified=function(){return _.any(_.values(blist.iframeHack.pressed))};$.live("a[rel$=video]","click",function(q){q.preventDefault();window.open($(this).attr("href"),"","width=650,height=550,location=no,menubar=no,scrollbars=no,status=no,toolbar=no")});$.validator.addMethod("customUrl",function(s,q){if(this.optional(q)){return true}var t=/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;if(!/^(https?|ftp):\/\//i.test(s)){if(t.test("http://"+s)){$(q).val("http://"+s);return true}}else{return t.test(s)}return false});$.validator.addMethod("secureUrl",function(s,q){if(this.optional(q)){return true}return/^https/.test(s)});$.validator.addMethod("customHttpMaybeSUrl",function(t,q){var s=/^https?:\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;return this.optional(q)||s.test(t)});$.validator.addMethod("coordinateReferenceSystem",function(s,q){if(this.optional(q)){return true}return/^EPSG:\d+$/i.test(s)});var h={};_.each($.validator.messages,function(t,q){var s=$.tNull("core.validation."+q);if(s){h[q]=s}});_.each(["maxlength","minlength","rangelength","range","max","min"],function(q){h[q]=$.validator.format(h[q])});$.extend($.validator.messages,h);var l=$.cookies.get("logged_in");if(l&&l=="true"){$("#siteHeader").addClass("loggedIn").find(".siteUserNav").addClass("loggedInNav")}function d(){return $.browser.msie&&$.browser.majorVersion<9||$.browser.safari&&$.browser.majorVersion<6||$.browser.chrome&&$.browser.majorVersion<28||$.browser.mozilla&&$.browser.majorVersion<24}if(window==window.top&&!$.cookies.get("browser_ack")&&d()){$("#noticeContainer").append($.tag2({_:"div",id:"browserSupportMessage",className:"flash error",contents:[{_:"a",href:"#",className:"close",contents:{_:"span",className:"icon",contents:"close"}},{_:"div",contents:$.t("core.browser_support.message_html",{link_text:$.tag2({_:"a",target:"_blank",href:"http://support.socrata.com/entries/23245818-Socrata-Browser-Support",contents:$.t("core.browser_support.link_text")},false)})}]}));$("#browserSupportMessage a.close").click(function(q){q.preventDefault();$("#browserSupportMessage").fadeOut();$.cookies.set("browser_ack",true)})}blist.namespace.fetch("blist.configuration");if($.isPresent(blist.configuration.maintenance_message)&&window==window.top){var e=function(q){$(q).closest(".maintenanceNotice").fadeOut();o(q)};var o=function(s){var q=m();q.push($(s).closest(".maintenanceNotice").data("hash"));q=_.compact(_.uniq(q));$.cookies.set("maintenance_ack",JSON.stringify(q))};var p=function(s){var q=m();if(!$.isPresent(q)){return false}return _.detect(q,function(t){return t===s})};var m=function(){var s=$.cookies.get("maintenance_ack");var q=[];if($.isPresent(s)){q=JSON.parse(s)}if(!_.isArray(q)){q=[]}return q};_.each(blist.configuration.maintenance_message,function(s){var q=$(s);var u=q.data("hash");var t=JSON.parse(q.data("active"));if(t&&!p(u)){$("#noticeContainer").append(s)}});setTimeout(e,15000);$(".maintenanceNotice a.close").click(function(q){q.preventDefault();e(q.target)})}var j=$('meta[name="csrf-token"]').attr("content");if(!$.isBlank(j)){$.cookies.set("socrata-csrf-token",j,{secure:true})}blist.configuration.appToken="U29jcmF0YS0td2VraWNrYXNz0";$.ajaxSetup({beforeSend:function(q){q.setRequestHeader("X-App-Token",blist.configuration.appToken);q.setRequestHeader("X-CSRF-Token",j)}});blist.pageOpened=Math.round(new Date().getTime()/1000);$(".dateReplace").each(function(){var s=$(this);var q;switch(s.data("dateformat")){case"date_time":q="M d, Y g:ia";break;case"long_date":q="F d, Y";break;case"date":default:q="M d, Y";break}s.text(new Date(s.data("rawdatetime")*1000).format(q))});moment.lang(blist.locale);$(".dateLocalize").each(function(){var q=$(this);q.text(moment(q.data("rawdatetime")*1000).format("LLLL"))});var n=$(".maintenanceNotice .dateLocalize");if(moment(n.eq(0).data("rawdatetime")*1000).isSame(n.eq(1).data("rawdatetime")*1000,"day")){var c=n.eq(1);c.text(moment(c.data("rawdatetime")*1000).format("LT"))}blist.configuration.shortDateFormat="llll";blist.configuration.longDateFormat="LLLL";var g=[];var k=[];var f=false;var b=function(t,q){for(var s=0;s<t.length;s++){successCallback=t[s];if(_.isFunction(successCallback)){successCallback(q)}}};var a=function(){$.socrataServer.makeRequest({type:"GET",url:"/api/users/current.json",cache:false,headers:{"Cache-Control":"nocache"},success:function(q){f=true;q=new User(q);blist.currentUser=q;blist.currentUserId=q.id;var s=g.concat(k);b(s,q)},error:function(){f=true;b(k)}})};var l=$.cookies.get("logged_in");if(l&&l=="true"&&blist.currentUser===undefined){a()}else{f=true;b(k,blist.currentUser)}blist.configuration.onCurrentUser=function(q){if(blist.currentUser!==undefined){q(blist.currentUser)}else{g.push(q)}};blist.configuration.onCurrentUserComplete=function(q){if(f){q(blist.currentUser)}else{k.push(q)}};blist.configuration.onCurrentUser(function(q){$(".accountLink .text .currentUser").text(q.displayName);$(".accountLink").removeClass("hide");$(".accountLikeLink").removeClass("hide");$(".signOutLink").removeClass("hide");$(".signInLink").addClass("hide");$(".signUpLink").addClass("hide");if(q!==undefined&&q.rights&&q.rights.length>0){$(".adminLink").removeClass("hide")}$(".myGoalsLink").toggleClass("hide",_.isUndefined(q)||!q.hasRight("edit_goals"))});blist.configuration.onCurrentUserComplete(function(q){if(blist.configuration.govstat_links_cb!==undefined){blist.configuration.govstat_links_cb(q)}});blist.namespace.fetch("blist.nextgen");_.each(window.location.href.match(/\w+=nextgen/g),function(q){blist.nextgen[q.slice(0,q.indexOf("="))]=true})});$(function(){var a=function(){if(!blist.currentUserId){return}$("body").append($.tag2({_:"div",className:"modalDialog",id:"sessionTimeoutModal",contents:[{_:"h2",contents:$.t("core.dialogs.session_timeout.warning.title")},{_:"p",contents:$.t("core.dialogs.session_timeout.warning.body_html")},{_:"div",className:"buttonWrapper",contents:[{_:"a",id:"keepSessionButton",className:"button",contents:$.t("core.dialogs.session_timeout.warning.belay_button")}]}]}));var j=$("#sessionTimeoutModal");j.jqm();$("#keepSessionButton").click(function(n){n.preventDefault();j.jqmHide();c()});var b,f,k=60,d,m;function h(){$.socrataServer.makeRequest({url:"/logout/expire_if_idle",success:function(n){if(n.expired){blist.util.railsFlash($.t("core.dialogs.session_timeout.notice"));window.document.location="/login"}else{b=parseFloat(n.seconds);if(b>k){j.jqmHide();g()}else{e()}}},anonymous:true,error:function(n){setTimeout(h,10*1000)}})}h();function g(){if(f){clearTimeout(f)}if(m){clearTimeout(m)}f=setTimeout(h,(b-k)*1000)}function e(){d=b;if(m){clearInterval(m)}m=setInterval(l,1000);l();j.jqmShow()}function l(){$("#secondsRemaining").text(d);if(d<=0){if(m){clearInterval(m)}setTimeout(h,1000);return}if(d>0){d--}}function c(){$.socrataServer.makeRequest({url:"/login/extend",success:function(n){b=parseFloat(n.seconds);g();j.jqmHide()},anonymous:false,error:function(n){b=1000*20;g()}})}};if(blist.configuration.onCurrentUser){blist.configuration.onCurrentUser(a)}});